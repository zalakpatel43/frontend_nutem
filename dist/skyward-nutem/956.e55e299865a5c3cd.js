"use strict";(self.webpackChunkskyward_nutem=self.webpackChunkskyward_nutem||[]).push([[956],{8956:(Pt,v,l)=>{l.r(v),l.d(v,{LiquidPreparationModule:()=>Tt});var p=l(177),h=l(8498),m=l(4434),t=l(4438);let L=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-liquid-preparation"]],decls:1,vars:0,template:function(o,i){1&o&&t.nrm(0,"router-outlet")},dependencies:[h.n3]})}return a})();var j=l(1626);let b=(()=>{class a{constructor(e,o){this.http=e,this._baseService=o}getStartEndBatchCheckList(){return this.http.get(`${m.T6.StartEndBatchChecklist}`)}getTankMasterList(){return this.http.get(`${m.T6.GetAllTankMaster}`)}getMaterialMasterList(){return this.http.get(`${m.T6.GetAllMaterialMaster}`)}getProductInstructionDetailsList(){return this.http.get(`${m.T6.GetAllProductInstructionDetails}`)}getQCTSpecificationMasterList(){return this.http.get(`${m.T6.GetAllQCTSpecificationMaster}`)}getliquidPreparationList(){return this.http.get(`${m.T6.LiquidPreparationList}`)}addLiquidPreparation(e){return this.http.post(`${m.T6.LiquidPreparationAdd}`,e)}updateLiquidPreparation(e){return this.http.post(`${m.T6.LiquidPreparationEdit}`,e)}getByIdLiquidPreparation(e){return this.http.get(`${m.T6.LiquidPreparationGetById}?id=`+e)}DeleteLiquidPreparation(e){return this.http.get(`${m.T6.LiquidPreparationDelete}?id=`+e)}static#t=this.\u0275fac=function(o){return new(o||a)(t.KVO(j.Qq),t.KVO(m.dD))};static#e=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var S=l(5794),g=l(8834),E=l(9213),k=l(3380),D=l(220),A=l(6081);const q=()=>["../","add"],N=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),R=a=>["..","edit",a];function x(a,n){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const e=n.value;t.R7$(),t.JRh(t.i5U(2,1,e,"MM/dd/yyyy hh:mm a"))}}function B(a,n){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const e=n.value;t.R7$(),t.JRh(t.i5U(2,1,e,"MM/dd/yyyy hh:mm a"))}}function G(a,n){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=n.value;t.R7$(),t.JRh(e)}}function $(a,n){if(1&a&&(t.j41(0,"a",19)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&a){const e=t.XpG().row;t.Y8G("routerLink",t.eq3(1,R,e.id))}}function V(a,n){if(1&a){const e=t.RV6();t.DNE(0,$,3,3,"a",17),t.j41(1,"button",18),t.bIt("click",function(){const i=t.eBV(e).row,s=t.XpG();return t.Njj(s.removeliquidPreparation(i.id))}),t.j41(2,"mat-icon"),t.EFF(3,"close"),t.k0s()()}if(2&a){const e=t.XpG();t.Y8G("authPermission",e.page+"_"+e.permissions.edit)}}let T=(()=>{class a{constructor(e,o){this.liquidPreparationService=e,this.notificationService=o,this.liquidPreparationData=[],this.page=m.Wt.liquidPreparation,this.permissions=m.eZ,this.searchData={}}ngOnInit(){this.getliquidPreparationData()}getliquidPreparationData(){this.loading=!0,this.liquidPreparationService.getliquidPreparationList().subscribe(e=>{this.liquidPreparationData=e,console.log("liquidPreparationData list",this.liquidPreparationData),this.loading=!1},e=>{this.error=e,this.loading=!1})}removeliquidPreparation(e){confirm("Are you sure, you want to delete this Liquid Preparation?")&&this.liquidPreparationService.DeleteLiquidPreparation(e).subscribe(()=>{this.getliquidPreparationData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(e){this.searchData=Object.assign({},e),console.log("serach data",this.searchData)}isActiveRow(e){return{"text-danger":!e.isActive}}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(b),t.rXU(S.tw))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-list"]],decls:24,vars:16,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","color","primary",1,"app-button",3,"routerLink"],[1,"icon-plus"],[1,"row"],[1,"col-12"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","StartDate","prop","startDateTime"],["ngx-datatable-cell-template",""],["name","End Date","prop","endDateTime"],["name","Shift","prop","shiftName"],["name","Actions",3,"sortable"],["class","button-padding","color","primary",3,"routerLink",4,"authPermission"],["type","button",2,"border","none","background-color","white","color","red",3,"click"],["color","primary",1,"button-padding",3,"routerLink"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Liquid Preparation List"),t.k0s()(),t.j41(7,"div",6)(8,"a",7)(9,"span"),t.EFF(10,"Add New"),t.k0s(),t.nrm(11,"i",8),t.k0s()()(),t.j41(12,"div",9)(13,"div",10)(14,"ngx-datatable",11),t.nI1(15,"searchtable"),t.j41(16,"ngx-datatable-column",12),t.DNE(17,x,3,4,"ng-template",13),t.k0s(),t.j41(18,"ngx-datatable-column",14),t.DNE(19,B,3,4,"ng-template",13),t.k0s(),t.j41(20,"ngx-datatable-column",15),t.DNE(21,G,2,1,"ng-template",13),t.k0s(),t.j41(22,"ngx-datatable-column",16),t.DNE(23,V,4,1,"ng-template",13),t.k0s()()()()()()()),2&o&&(t.R7$(8),t.Y8G("routerLink",t.lJ4(14,q)),t.R7$(6),t.Y8G("rows",t.i5U(15,11,i.liquidPreparationData,i.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",i.loading)("scrollbarH",!0)("messages",t.lJ4(15,N)),t.R7$(8),t.Y8G("sortable",!1))},dependencies:[h.Wk,g.It,E.An,k.ge,k.ed,k.QI,D.B,p.vh,A.j]})}return a})();var d=l(9417),M=l(1528),I=l(2102),y=l(9631),Y=l(2798),C=l(6600),P=l(5951),_=l(6850),Q=l(7133),f=l(8910);function w(a,n){if(1&a){const e=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.cancel())}),t.EFF(1," View List "),t.k0s()}}function W(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.poNumber," ")}}function O(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.productName," ")}}function X(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.shiftName," ")}}function U(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.tankName," ")}}function H(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function J(a,n){if(1&a){const e=t.RV6();t.j41(0,"form",29,0)(2,"div",30)(3,"div",31)(4,"div",32)(5,"div",33)(6,"mat-form-field",34)(7,"input",35),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onStartDateChange())}),t.k0s(),t.j41(8,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.sdS(12);return t.Njj(i.open())}),t.j41(9,"mat-icon"),t.EFF(10,"calendar_today"),t.k0s()(),t.nrm(11,"ngx-mat-datetime-picker",37,1),t.k0s()(),t.j41(13,"div",33)(14,"mat-form-field",34)(15,"input",38),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onEndDateChange())}),t.k0s(),t.j41(16,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.sdS(20);return t.Njj(i.open())}),t.j41(17,"mat-icon"),t.EFF(18,"calendar_today"),t.k0s()(),t.nrm(19,"ngx-mat-datetime-picker",37,2),t.k0s()(),t.j41(21,"div",33)(22,"mat-form-field",39)(23,"mat-label"),t.EFF(24,"Production Order"),t.k0s(),t.j41(25,"mat-select",40),t.DNE(26,W,2,2,"mat-option",41),t.k0s(),t.nrm(27,"mat-validation-message",42),t.k0s()(),t.j41(28,"div",33)(29,"mat-form-field",39)(30,"mat-label"),t.EFF(31,"Product"),t.k0s(),t.j41(32,"mat-select",43),t.DNE(33,O,2,2,"mat-option",41),t.k0s(),t.nrm(34,"mat-validation-message",42),t.k0s()(),t.j41(35,"div",33)(36,"mat-form-field",39)(37,"mat-label"),t.EFF(38,"Shift"),t.k0s(),t.j41(39,"mat-select",44),t.DNE(40,X,2,2,"mat-option",41),t.k0s(),t.nrm(41,"mat-validation-message",42),t.k0s()(),t.j41(42,"div",33)(43,"mat-form-field",39)(44,"mat-label"),t.EFF(45,"Batch Lot Number"),t.k0s(),t.nrm(46,"input",45)(47,"mat-validation-message",42),t.k0s()(),t.j41(48,"div",33)(49,"mat-form-field",39)(50,"mat-label"),t.EFF(51,"Tank"),t.k0s(),t.j41(52,"mat-select",46),t.DNE(53,U,2,2,"mat-option",41),t.k0s(),t.nrm(54,"mat-validation-message",42),t.k0s()(),t.j41(55,"div",33)(56,"mat-form-field",39)(57,"mat-label"),t.EFF(58,"Compounder"),t.k0s(),t.j41(59,"mat-select",47),t.DNE(60,H,2,2,"mat-option",41),t.k0s(),t.nrm(61,"mat-validation-message",42),t.k0s()(),t.j41(62,"div",33)(63,"mat-form-field",39)(64,"mat-label"),t.EFF(65,"Standard Batch Weight"),t.k0s(),t.nrm(66,"input",48)(67,"mat-validation-message",42),t.k0s()()()()()()}if(2&a){const e=t.sdS(12),o=t.sdS(20),i=t.XpG();t.Y8G("formGroup",i.basicForm),t.R7$(7),t.Y8G("ngxMatDatetimePicker",e),t.R7$(8),t.Y8G("ngxMatDatetimePicker",o),t.R7$(10),t.Y8G("disabled",i.isEditMode),t.R7$(),t.Y8G("ngForOf",i.productionOrderList),t.R7$(),t.Y8G("control",i.basicForm.get("SAPProductionOrderId"))("message","Production Order")("formSubmitted",i.isBasicFormSubmitted),t.R7$(5),t.Y8G("disabled",i.isEditMode),t.R7$(),t.Y8G("ngForOf",i.productList),t.R7$(),t.Y8G("control",i.basicForm.controls.ProductId)("message","Product")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.shiftList),t.R7$(),t.Y8G("control",i.basicForm.controls.ShiftId)("message","Shift")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("control",i.basicForm.controls.BatchLotNumber)("message","Batch Lot Number")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.tankList),t.R7$(),t.Y8G("control",i.basicForm.controls.TankId)("message","Tank")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.usersList),t.R7$(),t.Y8G("control",i.basicForm.controls.CompounderUserId)("message","Compounder")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("control",i.basicForm.controls.StandardBatchWeight)("message","Standard Batch Weight")("formSubmitted",i.isBasicFormSubmitted)}}function z(a,n){1&a&&(t.j41(0,"mat-form-field",39)(1,"mat-label"),t.EFF(2,"Reason"),t.k0s(),t.nrm(3,"input",61),t.k0s())}function K(a,n){if(1&a){const e=t.RV6();t.j41(0,"div",52)(1,"div",32)(2,"div",53)(3,"mat-label"),t.EFF(4),t.k0s()(),t.j41(5,"div",54)(6,"mat-radio-group",55),t.bIt("change",function(i){const s=t.eBV(e).index,r=t.XpG(2);return t.Njj(r.onAnswerChange(i,s))}),t.j41(7,"mat-radio-button",56),t.EFF(8,"Yes"),t.k0s(),t.j41(9,"mat-radio-button",57),t.EFF(10,"No"),t.k0s(),t.j41(11,"mat-radio-button",58),t.EFF(12,"NA"),t.k0s()()(),t.j41(13,"div",59),t.DNE(14,z,4,0,"mat-form-field",60),t.k0s()()()}if(2&a){const e=n.$implicit;t.Y8G("formGroupName",n.index),t.R7$(4),t.JRh(e.get("question").value),t.R7$(10),t.Y8G("ngIf","NA"===e.get("answer").value)}}function Z(a,n){if(1&a&&(t.j41(0,"form",29,0)(2,"div",30)(3,"div",31)(4,"div",32)(5,"div",50),t.DNE(6,K,15,3,"div",51),t.k0s()()()()()),2&a){const e=t.XpG();t.Y8G("formGroup",e.StartCheckListForm),t.R7$(6),t.Y8G("ngForOf",e.questionsArray.controls)}}function tt(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.instruction," ")}}function et(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.materialName," ")}}function it(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function at(a,n){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"date"),t.k0s(),t.j41(16,"td")(17,"button",80),t.bIt("click",function(){const i=t.eBV(e),s=i.$implicit,r=i.index,u=t.XpG(2);return t.Njj(u.onEditDetail(s,r))}),t.nrm(18,"i",81),t.k0s(),t.j41(19,"button",82),t.bIt("click",function(){const i=t.eBV(e).index,s=t.XpG(2);return t.Njj(s.removeDetail(i))}),t.nrm(20,"i",83),t.k0s()()()}if(2&a){const e=n.$implicit;t.R7$(2),t.SpI(" ",e.InstructionName," "),t.R7$(2),t.SpI(" ",e.MaterialName," "),t.R7$(2),t.SpI(" ",e.LotNumber," "),t.R7$(2),t.SpI(" ",e.Weight," "),t.R7$(2),t.SpI(" ",e.WeightAdded," "),t.R7$(2),t.SpI(" ",e.DoneByNames," "),t.R7$(2),t.SpI(" ",t.i5U(15,7,e.AddedTime,"yyyy-MM-dd HH:mm:ss")," ")}}function ot(a,n){if(1&a){const e=t.RV6();t.j41(0,"form",29,0)(2,"div",30)(3,"div",62)(4,"h5",11),t.EFF(5,"Instruction Details"),t.k0s()(),t.j41(6,"div",31)(7,"div",32)(8,"div",33)(9,"mat-form-field",39)(10,"mat-label"),t.EFF(11,"Instruction"),t.k0s(),t.j41(12,"mat-select",63),t.bIt("selectionChange",function(i){t.eBV(e);const s=t.XpG();return t.Njj(s.onInstructionChange(i))}),t.DNE(13,tt,2,2,"mat-option",41),t.k0s(),t.nrm(14,"mat-validation-message",42),t.k0s()(),t.j41(15,"div",33)(16,"mat-form-field",39)(17,"mat-label"),t.EFF(18,"Material"),t.k0s(),t.j41(19,"mat-select",64),t.DNE(20,et,2,2,"mat-option",41),t.k0s(),t.nrm(21,"mat-validation-message",42),t.k0s()(),t.j41(22,"div",33)(23,"mat-form-field",39)(24,"mat-label"),t.EFF(25,"Lot Number"),t.k0s(),t.nrm(26,"input",65)(27,"mat-validation-message",42),t.k0s()(),t.j41(28,"div",33)(29,"mat-form-field",39)(30,"mat-label"),t.EFF(31,"Weight"),t.k0s(),t.nrm(32,"input",66)(33,"mat-validation-message",42),t.k0s()(),t.j41(34,"div",33)(35,"mat-form-field",39)(36,"mat-label"),t.EFF(37,"Weight Added"),t.k0s(),t.nrm(38,"input",67)(39,"mat-validation-message",42),t.k0s()(),t.j41(40,"div",33)(41,"mat-form-field",39)(42,"mat-label"),t.EFF(43,"Done By"),t.k0s(),t.j41(44,"mat-select",68),t.DNE(45,it,2,2,"mat-option",41),t.k0s(),t.nrm(46,"mat-validation-message",42),t.k0s()(),t.j41(47,"div",33)(48,"mat-form-field",39)(49,"mat-label"),t.EFF(50,"Added Time"),t.k0s(),t.nrm(51,"input",69)(52,"mat-validation-message",42),t.k0s()(),t.j41(53,"div",70)(54,"button",71),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addInstruction())}),t.j41(55,"mat-icon"),t.EFF(56,"add"),t.k0s()()()()()(),t.j41(57,"div",32)(58,"div",72)(59,"div",73)(60,"table",74)(61,"thead",75)(62,"tr")(63,"th",76),t.EFF(64,"Instruction"),t.k0s(),t.j41(65,"th"),t.EFF(66,"Material & Part Code"),t.k0s(),t.j41(67,"th"),t.EFF(68,"Lot Number "),t.k0s(),t.j41(69,"th"),t.EFF(70,"Weight (kg)"),t.k0s(),t.j41(71,"th"),t.EFF(72,"Weight Added (kg)"),t.k0s(),t.j41(73,"th"),t.EFF(74,"Done By"),t.k0s(),t.j41(75,"th"),t.EFF(76," Added Time "),t.k0s(),t.j41(77,"th"),t.EFF(78,"Action"),t.k0s()()(),t.j41(79,"tbody"),t.DNE(80,at,21,10,"tr",77),t.j41(81,"tr")(82,"td",78)(83,"strong"),t.EFF(84,"Total"),t.k0s()(),t.j41(85,"td")(86,"strong"),t.EFF(87),t.k0s()(),t.j41(88,"td")(89,"strong"),t.EFF(90),t.k0s()(),t.nrm(91,"td",79),t.k0s()()()()()()()}if(2&a){const e=t.XpG();t.Y8G("formGroup",e.InstructionForm),t.R7$(13),t.Y8G("ngForOf",e.productInstructionDetailsList),t.R7$(),t.Y8G("control",e.InstructionForm.controls.InstructionId)("message","Instruction")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.materialMasterList),t.R7$(),t.Y8G("control",e.InstructionForm.controls.MaterialId)("message","Material")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.LotNumber)("message","Lot Number")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.Weight)("message","Weight")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.WeightAdded)("message","Weight Added")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.usersList),t.R7$(),t.Y8G("control",e.InstructionForm.controls.DoneByIds)("message","Done By")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.AddedTime)("message","Added Time")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(28),t.Y8G("ngForOf",e.AddedInstructionList),t.R7$(7),t.JRh(e.totalWeight),t.R7$(3),t.JRh(e.totalWeightAdded)}}function st(a,n){1&a&&(t.j41(0,"mat-form-field",39)(1,"mat-label"),t.EFF(2,"Reason"),t.k0s(),t.nrm(3,"input",61),t.k0s())}function nt(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.tankName," ")}}function rt(a,n){if(1&a&&(t.j41(0,"mat-form-field",39)(1,"mat-label"),t.EFF(2,"Tank"),t.k0s(),t.j41(3,"mat-select",84),t.DNE(4,nt,2,2,"mat-option",41),t.k0s()()),2&a){const e=t.XpG(3);t.R7$(4),t.Y8G("ngForOf",e.tankList)}}function dt(a,n){if(1&a){const e=t.RV6();t.j41(0,"div",52)(1,"div",32)(2,"div",53)(3,"mat-label"),t.EFF(4),t.k0s()(),t.j41(5,"div",54)(6,"mat-radio-group",55),t.bIt("change",function(i){const s=t.eBV(e).index,r=t.XpG(2);return t.Njj(r.onAnswerChange(i,s))}),t.j41(7,"mat-radio-button",56),t.EFF(8,"Yes"),t.k0s(),t.j41(9,"mat-radio-button",57),t.EFF(10,"No"),t.k0s(),t.j41(11,"mat-radio-button",58),t.EFF(12,"NA"),t.k0s()()(),t.j41(13,"div",59),t.DNE(14,st,4,0,"mat-form-field",60)(15,rt,5,1,"mat-form-field",60),t.k0s()()()}if(2&a){const e=n.$implicit;t.Y8G("formGroupName",n.index),t.R7$(4),t.JRh(e.get("question").value),t.R7$(10),t.Y8G("ngIf","NA"===e.get("answer").value),t.R7$(),t.Y8G("ngIf",27==e.get("id").value&&"Yes"===e.get("answer").value)}}function lt(a,n){if(1&a&&(t.j41(0,"form",29,0)(2,"div",30)(3,"div",31)(4,"div",32)(5,"div",50),t.DNE(6,dt,16,4,"div",51),t.k0s()()()()()),2&a){const e=t.XpG();t.Y8G("formGroup",e.EndCheckListForm),t.R7$(6),t.Y8G("ngForOf",e.EndquestionsArray.controls)}}function ct(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function mt(a,n){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const e=n.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.specificationName," ")}}function ut(a,n){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.nI1(10,"date"),t.k0s(),t.j41(11,"td"),t.EFF(12),t.nI1(13,"date"),t.k0s(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.j41(18,"td"),t.EFF(19),t.k0s(),t.j41(20,"td")(21,"button",80),t.bIt("click",function(){const i=t.eBV(e),s=i.$implicit,r=i.index,u=t.XpG(2);return t.Njj(u.onEditQualityDetail(s,r))}),t.nrm(22,"i",81),t.k0s(),t.j41(23,"button",82),t.bIt("click",function(){const i=t.eBV(e).index,s=t.XpG(2);return t.Njj(s.removeQualityDetail(i))}),t.nrm(24,"i",83),t.k0s()()()}if(2&a){const e=n.$implicit,o=n.index;t.R7$(2),t.SpI(" ",o+1," "),t.R7$(2),t.SpI(" ",t.i5U(5,8,e.TestingDateTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",e.DoneByNames," "),t.R7$(2),t.SpI(" ",t.i5U(10,11,e.SampleReceivedTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",t.i5U(13,14,e.SampleTestedTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",e.SpecificationLimitName," "),t.R7$(2),t.SpI(" ",e.Test1," "),t.R7$(2),t.SpI(" ",e.Test2," ")}}function pt(a,n){if(1&a){const e=t.RV6();t.j41(0,"form",29,0)(2,"div",30)(3,"div",62)(4,"h5",11),t.EFF(5,"Quality Details"),t.k0s()(),t.j41(6,"div",31)(7,"div",32)(8,"div",33)(9,"mat-form-field",34),t.nrm(10,"input",85),t.j41(11,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.sdS(15);return t.Njj(i.open())}),t.j41(12,"mat-icon"),t.EFF(13,"calendar_today"),t.k0s()(),t.nrm(14,"ngx-mat-datetime-picker",37,3),t.k0s()(),t.j41(16,"div",33)(17,"mat-form-field",39)(18,"mat-label"),t.EFF(19,"Analysis Done By"),t.k0s(),t.j41(20,"mat-select",86),t.DNE(21,ct,2,2,"mat-option",41),t.k0s(),t.nrm(22,"mat-validation-message",42),t.k0s()(),t.j41(23,"div",33)(24,"mat-form-field",34),t.nrm(25,"input",87),t.j41(26,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.sdS(30);return t.Njj(i.open())}),t.j41(27,"mat-icon"),t.EFF(28,"calendar_today"),t.k0s()(),t.nrm(29,"ngx-mat-datetime-picker",37,4),t.k0s()(),t.j41(31,"div",33)(32,"mat-form-field",34),t.nrm(33,"input",88),t.j41(34,"button",36),t.bIt("click",function(){t.eBV(e);const i=t.sdS(38);return t.Njj(i.open())}),t.j41(35,"mat-icon"),t.EFF(36,"calendar_today"),t.k0s()(),t.nrm(37,"ngx-mat-datetime-picker",37,5),t.k0s()(),t.j41(39,"div",33)(40,"mat-form-field",39)(41,"mat-label"),t.EFF(42,"Specification Limit"),t.k0s(),t.j41(43,"mat-select",89),t.DNE(44,mt,2,2,"mat-option",41),t.k0s(),t.nrm(45,"mat-validation-message",42),t.k0s()(),t.j41(46,"div",33)(47,"mat-form-field",39)(48,"mat-label"),t.EFF(49,"Result"),t.k0s(),t.nrm(50,"input",90),t.k0s()(),t.j41(51,"div",33)(52,"mat-form-field",39)(53,"mat-label"),t.EFF(54," Comments"),t.k0s(),t.nrm(55,"input",91),t.k0s()(),t.j41(56,"div",70)(57,"button",71),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addQuality())}),t.j41(58,"mat-icon"),t.EFF(59,"add"),t.k0s()()()()()(),t.j41(60,"div",32)(61,"div",92)(62,"div",73)(63,"table",93)(64,"thead",75)(65,"tr")(66,"th"),t.EFF(67,"Id"),t.k0s(),t.j41(68,"th"),t.EFF(69,"Date Tested"),t.k0s(),t.j41(70,"th"),t.EFF(71,"Analysis Done By"),t.k0s(),t.j41(72,"th"),t.EFF(73,"Sample Received At"),t.k0s(),t.j41(74,"th"),t.EFF(75,"Sample Tested At"),t.k0s(),t.j41(76,"th"),t.EFF(77,"Specification Limit"),t.k0s(),t.j41(78,"th"),t.EFF(79,"Result"),t.k0s(),t.j41(80,"th"),t.EFF(81,"Comments"),t.k0s(),t.j41(82,"th"),t.EFF(83,"Action"),t.k0s()()(),t.j41(84,"tbody"),t.DNE(85,ut,25,17,"tr",77),t.k0s()()()()()()}if(2&a){const e=t.sdS(15),o=t.sdS(30),i=t.sdS(38),s=t.XpG();t.Y8G("formGroup",s.QualityForm),t.R7$(10),t.Y8G("ngxMatDatetimePicker",e),t.R7$(11),t.Y8G("ngForOf",s.usersList),t.R7$(),t.Y8G("control",s.QualityForm.controls.AnalysisDoneByIds)("message","Analysis Done By")("formSubmitted",s.isQualityFormSubmitted),t.R7$(3),t.Y8G("ngxMatDatetimePicker",o),t.R7$(8),t.Y8G("ngxMatDatetimePicker",i),t.R7$(11),t.Y8G("ngForOf",s.qCTSpecificationMasterList),t.R7$(),t.Y8G("control",s.QualityForm.controls.SpecificationLimitId)("message","Material")("formSubmitted",s.isQualityFormSubmitted),t.R7$(40),t.Y8G("ngForOf",s.AddedQualityList)}}function ht(a,n){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"number"),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s()()),2&a){const e=n.$implicit;t.R7$(2),t.SpI(" ",e.MaterialName," "),t.R7$(2),t.SpI(" ",e.WeightAdded," "),t.R7$(2),t.SpI(" ",t.i5U(7,4,e.diffWeight,"1.2-2")," "),t.R7$(3),t.SpI(" ",e.Weight," ")}}function ft(a,n){if(1&a&&(t.j41(0,"div",30)(1,"div",62)(2,"h5",11),t.EFF(3,"Adjustment Details"),t.k0s()(),t.j41(4,"div",31)(5,"div",32)(6,"div",72)(7,"div",73)(8,"table",94)(9,"thead",75)(10,"tr",95)(11,"th",96),t.EFF(12,"Material & Part Code"),t.k0s(),t.j41(13,"th",96),t.EFF(14,"Weight "),t.k0s(),t.j41(15,"th",76),t.EFF(16,"Adjustment"),t.k0s(),t.j41(17,"th",96),t.EFF(18,"Total"),t.k0s()()(),t.j41(19,"tbody"),t.DNE(20,ht,10,7,"tr",77),t.k0s()()()()()()()),2&a){const e=t.XpG();t.R7$(20),t.Y8G("ngForOf",e.DiffWghInstructionList)}}function gt(a,n){if(1&a){const e=t.RV6();t.j41(0,"button",97),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.goToNextTab())}),t.EFF(1,"Draft &Next"),t.k0s()}if(2&a){const e=t.XpG();t.Y8G("disabled",e.selectedIndex===e.tabCount-1)}}function It(a,n){if(1&a){const e=t.RV6();t.j41(0,"button",98),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.Submit())}),t.EFF(1,"Submit"),t.k0s()}}let F=(()=>{class a{constructor(e,o,i,s,r,u,c){this.activatedRoute=e,this.router=o,this.formBuilder=i,this.liquidPreparationService=s,this.notificationService=r,this.weightCheckService=u,this.cdr=c,this.selectedIndex=0,this.tabCount=6,this.isstartChecklistDisable=!0,this.isInstructionsDisable=!0,this.isEndChecklistDisable=!0,this.isQualityDisable=!0,this.isAdjustmentDisable=!0,this.page=m.Wt.liquidPreparation,this.permissions=m.eZ,this.isEndDateOk=!0,this.StartCheckListQueList=[],this.AddedInstructionList=[],this.DiffWghInstructionList=[],this.EditInstructionId=-1,this.totalWeight=0,this.totalWeightAdded=0,this.EndCheckListQueList=[],this.AddedQualityList=[],this.EditQualityId=-1,this.shiftList=[],this.productionOrderList=[],this.productList=[],this.usersList=[],this.startEndBatchChecklist=[],this.materialMasterList=[],this.productInstructionDetailsList=[],this.qCTSpecificationMasterList=[],this.tankList=[],this.IsValidTestedDate=!0,this.IsValidQualitydDate=!0,this.createForm()}ngOnInit(){this.loadDropdowns(),this.getRoute()}getRoute(){this.routerSub=this.activatedRoute.params.subscribe(e=>{this.isEditMode=!m.ov.isEmpty(e.id),this.createForm(),this.isEditMode&&(this.liquidPreparationId=e.id,this.getLiquidPreparationById())})}goToPreviousTab(){this.selectedIndex>0&&this.selectedIndex--}goToNextTab(){if(0===this.selectedIndex)this.isBasicFormSubmitted=!0,console.log("basic form value",this.basicForm.value),this.basicForm.valid&&this.isEndDateOk&&(this.draftBasicFormValue=this.basicForm.value,this.isstartChecklistDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++);else if(1===this.selectedIndex){this.isStartCheckListFormSubmitted=!0,console.log("start check form value",this.StartCheckListForm.value);let e=this.StartCheckListValidation();this.StartCheckListForm.valid&&e&&(this.draftStartCheckListFormValue=this.StartCheckListForm.value,this.isInstructionsDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++)}else if(2===this.selectedIndex){if(this.AddedInstructionList.length<=0)return void this.notificationService.error("select at least one instruction");this.DiffWghInstructionList=[],this.AddedInstructionList.forEach(e=>{(e.diffWeight>0||e.diffWeight<0)&&this.DiffWghInstructionList.push(e)}),this.isEndChecklistDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++}else if(3===this.selectedIndex){this.isEndCheckListFormSubmitted=!0,console.log("end check form value",this.EndCheckListForm.value);let e=this.EndCheckListValidation();this.EndCheckListForm.valid&&e&&(this.draftEndCheckListFormValue=this.EndCheckListForm.value,this.isQualityDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++)}else if(4===this.selectedIndex){if(this.AddedQualityList.length<=0)return void this.notificationService.error("select at least one Quality");this.isAdjustmentDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++}else 5===this.selectedIndex&&console.log("added adjustment",this.DiffWghInstructionList)}onEndDateChange(){const e=this.basicForm.get("EndDateTime")?.value,o=this.basicForm.get("StartDateTime")?.value;o||(this.notificationService.error("please select Start date"),this.isEndDateOk=!1),o&&e&&new Date(e)<=new Date(o)?(this.notificationService.error("End date should be greated than Start date"),this.isEndDateOk=!1):(this.basicForm.get("EndDateTime")?.updateValueAndValidity(),this.isEndDateOk=!0)}getLiquidPreparationById(){this.liquidPreparationService.getByIdLiquidPreparation(this.liquidPreparationId).subscribe(e=>{this.liquidPreparationData=e,this.setLiquidPreparationkData(),console.log("get by id data",e)},e=>{console.log(e)})}setLiquidPreparationkData(){this.basicForm.patchValue({StartDateTime:this.liquidPreparationData.startDateTime,EndDateTime:this.liquidPreparationData.endDateTime,SAPProductionOrderId:this.liquidPreparationData.sapProductionOrderId,ProductId:this.liquidPreparationData.productId,ShiftId:this.liquidPreparationData.shiftId,BatchLotNumber:parseInt(this.liquidPreparationData.batchLotNumber),TankId:this.liquidPreparationData.tankId,CompounderUserId:this.liquidPreparationData.compounderUserId,StandardBatchWeight:parseInt(this.liquidPreparationData.standardBatchWeight)}),this.basicForm.get("SAPProductionOrderId").disable(),this.basicForm.get("ProductId").disable(),setTimeout(()=>{let e=[],o=[];this.liquidPreparationData.liquidPreparationChecklistDetails.forEach(i=>{"1"===i.type?e.push(i):o.push(i)}),e.forEach(i=>{const s=this.StartCheckListForm.get("questions")?.value.find(r=>r.id===i.questionId);if(s){const r=this.StartCheckListForm.get("questions")?.value.indexOf(s);-1!==r&&this.StartCheckListForm.get("questions").at(r).patchValue({answer:i.answer,tankId:i.tankId?i.tankId:"",tankNo:i.tankNo?i.tankNo:"",reason:i.reason})}}),o.forEach(i=>{const s=this.EndCheckListForm.get("questions")?.value.find(r=>r.id===i.questionId);if(s){const r=this.EndCheckListForm.get("questions")?.value.indexOf(s);-1!==r&&this.EndCheckListForm.get("questions").at(r).patchValue({answer:i.answer,tankId:i.tankId?i.tankId:"",tankNo:i.tankNo?i.tankNo:"",reason:i.reason})}}),this.liquidPreparationData.liquidPreparationInstructionDetails.forEach(i=>{let s=i.weight-i.weightAdded,r=this.usersList.filter(c=>i.doneByIds?.includes(c.id)).map(c=>c.name).join(", "),u={InstructionId:i.instructionId,MaterialId:i.materialId,LotNumber:parseInt(i.lotNumber),Weight:i.weight,WeightAdded:i.weightAdded,DoneByIds:i.doneByIds.split(",").map(c=>parseInt(c,10)),AddedTime:i.addedTime,diffWeight:s||0,DoneByNames:r,InstructionName:this.productInstructionDetailsList.find(c=>c.id==i.instructionId)?.instruction,MaterialName:this.materialMasterList.find(c=>c.id==i.materialId)?.materialName};this.AddedInstructionList.push(u)}),this.calculateTotals(),this.liquidPreparationData.liquidPreparationSpecificationDetails.forEach(i=>{let r=this.usersList.filter(c=>i.analysisDoneByIds?.includes(c.id)).map(c=>c.name).join(", "),u={TestingDateTime:i.testingDateTime,AnalysisDoneByIds:i.analysisDoneByIds.split(",").map(c=>parseInt(c,10)),SampleReceivedTime:i.sampleReceivedTime,SampleTestedTime:i.sampleTestedTime,SpecificationLimitId:i.specificationLimitId,Test1:i.test1,Test2:i.test2,DoneByNames:r,SpecificationLimitName:this.qCTSpecificationMasterList.find(c=>c.id==i.specificationLimitId)?.specificationName};this.AddedQualityList.push(u)}),console.log("EditPrechecklistData",e)},1e3)}loadDropdowns(){this.weightCheckService.getProductionOrderList().subscribe(e=>{this.productionOrderList=e}),this.weightCheckService.getProductList().subscribe(e=>{this.productList=e}),this.weightCheckService.getUserList().subscribe(e=>{this.usersList=e}),this.weightCheckService.getShiftList().subscribe(e=>{this.shiftList=e}),this.liquidPreparationService.getTankMasterList().subscribe(e=>{this.tankList=e}),this.liquidPreparationService.getStartEndBatchCheckList().subscribe(e=>{this.startEndBatchChecklist=e,this.StartCheckListQueList=e.filter(o=>"1"===o.type),this.EndCheckListQueList=e.filter(o=>"2"===o.type),this.CreateStartChecklIstForm(),this.CreateEndChecklIstForm()}),this.liquidPreparationService.getMaterialMasterList().subscribe(e=>{this.materialMasterList=e}),this.liquidPreparationService.getQCTSpecificationMasterList().subscribe(e=>{this.qCTSpecificationMasterList=e}),this.liquidPreparationService.getProductInstructionDetailsList().subscribe(e=>{this.productInstructionDetailsList=e})}createForm(){this.basicForm=this.formBuilder.group({Id:[{value:"",disabled:!0}],Code:["",""],StartDateTime:["",[d.k0.required]],EndDateTime:["",[d.k0.required]],SAPProductionOrderId:["",[d.k0.required]],ProductId:["",[d.k0.required]],ShiftId:["",[d.k0.required]],BatchLotNumber:["",[d.k0.required]],TankId:["",[d.k0.required]],CompounderUserId:["",[d.k0.required]],StandardBatchWeight:["",[d.k0.required]]}),this.basicForm.controls.StartDateTime.setValue((new Date).toISOString().split("T")[0]),this.CreateInstructionForm(),this.CreateQualityForm()}CreateStartChecklIstForm(){this.StartCheckListForm=this.formBuilder.group({questions:this.formBuilder.array(this.createQuestionControls())})}CreateInstructionForm(){this.EditInstructionId=-1,this.InstructionForm=this.formBuilder.group({InstructionId:["",[d.k0.required]],MaterialId:["",[d.k0.required]],LotNumber:["",[d.k0.required]],Weight:["",[d.k0.required]],WeightAdded:["",[d.k0.required]],DoneByIds:["",[d.k0.required]],AddedTime:["",[d.k0.required]]})}CreateEndChecklIstForm(){this.EndCheckListForm=this.formBuilder.group({questions:this.formBuilder.array(this.createEndQuestionControls())})}CreateQualityForm(){this.EditQualityId=-1,this.QualityForm=this.formBuilder.group({TestingDateTime:["",[d.k0.required]],AnalysisDoneByIds:["",[d.k0.required]],SampleReceivedTime:["",[d.k0.required]],SampleTestedTime:["",[d.k0.required]],SpecificationLimitId:["",[d.k0.required]],Test1:[""],Test2:[""]})}createQuestionControls(){return this.StartCheckListQueList.map(e=>this.formBuilder.group({id:[e.id],question:[e.question],answer:["Yes",d.k0.required],tankNo:[""],tankId:[""],reason:[""]}))}get questionsArray(){return this.StartCheckListForm.get("questions")}onAnswerChange(e,o){if(console.log("ebent & i",e,o),"No"===e.value){this.notificationService.error("You can't select NO");const i=this.StartCheckListForm.get("questions");if(o>=0){const s=i?.at(o);console.log("questiongroup",s),s&&(s.controls.answer?.setValue("Yes",{emitEvent:!0}),this.cdr.detectChanges())}else console.error("Index out of bounds")}}StartCheckListValidation(){const e=this.StartCheckListForm.get("questions");if(!e)return this.notificationService.error("Form is not initialized correctly."),!1;let o=!0;return e.controls.forEach((i,s)=>{const r=i,u=r.get("answer")?.value,c=r.get("reason")?.value;"NA"===u&&(!c||0===c.trim().length)&&(this.notificationService.error("Reason is mandatory when answer is 'NA'."),o=!1)}),o}createEndQuestionControls(){return this.EndCheckListQueList.map(e=>this.formBuilder.group({id:[e.id],question:[e.question],answer:["Yes",d.k0.required],tankNo:[""],tankId:[""],reason:[""]}))}get EndquestionsArray(){return this.EndCheckListForm.get("questions")}onEndAnswerChange(e,o){if(console.log("ebent & i",e,o),"No"===e.value){this.notificationService.error("You can't select NO");const i=this.EndCheckListForm.get("questions");if(o>=0){const s=i?.at(o);console.log("questiongroup",s),s&&(s.controls.answer?.setValue("Yes",{emitEvent:!0}),this.cdr.detectChanges())}else console.error("Index out of bounds")}}EndCheckListValidation(){const e=this.EndCheckListForm.get("questions");if(!e)return this.notificationService.error("Form is not initialized correctly."),!1;let o=!0;return e.controls.forEach((i,s)=>{const r=i,u=r.get("answer")?.value,c=r.get("reason")?.value,yt=r.get("id")?.value,Ct=r.get("tankId")?.value;"NA"===u&&(!c||0===c.trim().length)&&(this.notificationService.error("Reason is mandatory when answer is 'NA'."),o=!1),"Yes"===u&&27==yt&&!Ct&&(this.notificationService.error("Tank is mandatory when Storage tank available 'Yes' ."),o=!1)}),o}onInstructionChange(e){console.log("inst change",e);let o=this.productInstructionDetailsList.find(r=>r.id==e.value).weight;this.InstructionForm.controls.Weight.setValue(o),(new Date).toISOString(),this.InstructionForm.get("AddedTime")?.setValue(new Date)}addInstruction(){if(this.isInstructionFormSubmitted=!0,this.InstructionForm.valid){let e=this.InstructionForm.value;e.diffWeight=e.Weight!=e.WeightAdded?e.Weight-e.WeightAdded:0;let o=this.usersList.filter(s=>e.DoneByIds.includes(s.id)).map(s=>s.name).join(", ");e.DoneByNames=o,e.InstructionName=this.productInstructionDetailsList.find(s=>s.id==e.InstructionId).instruction,e.MaterialName=this.materialMasterList.find(s=>s.id==e.MaterialId).materialName,e.AddedTime=(new Date).toISOString(),console.log("Instruction form value",e),this.EditInstructionId>=0?(this.AddedInstructionList[this.EditInstructionId]=e,this.calculateTotals(),this.InstructionForm.reset(),this.isInstructionFormSubmitted=!1,this.CreateInstructionForm()):(this.AddedInstructionList.push(e),this.calculateTotals(),this.InstructionForm.reset(),this.isInstructionFormSubmitted=!1,this.CreateInstructionForm())}console.log("AddedInstructionList",this.AddedInstructionList)}calculateTotals(){this.totalWeight=this.AddedInstructionList.reduce((e,o)=>e+(o.Weight||0),0),this.totalWeightAdded=this.AddedInstructionList.reduce((e,o)=>e+(o.WeightAdded||0),0)}onEditDetail(e,o){console.log("details selected for edit",this.AddedInstructionList[o]);let i=this.AddedInstructionList[o];this.InstructionForm.patchValue({InstructionId:i.InstructionId,MaterialId:i.MaterialId,LotNumber:i.LotNumber,Weight:i.Weight,WeightAdded:i.WeightAdded,DoneByIds:i.DoneByIds,AddedTime:(new Date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),this.EditInstructionId=o}removeDetail(e){this.AddedInstructionList.splice(e,1),console.log("AddedInstructionList",this.AddedInstructionList)}onStartDateChange(){const e=this.basicForm.get("StartDateTime")?.value;this.StartDateOfBasicForm=new Date(e)}onTestingDateTimeChange(){const e=this.QualityForm.get("TestingDateTime")?.value,o=new Date(e);o&&o<this.StartDateOfBasicForm?(this.notificationService.error("Test date should be greated than Basic Start date"),this.QualityForm.get("TestingDateTime")?.reset(),this.IsValidQualitydDate=!1):(this.QualityForm.get("TestingDateTime")?.updateValueAndValidity(),this.IsValidQualitydDate=!0)}onRecieveDateChange(){const e=this.QualityForm.get("SampleReceivedTime")?.value,o=new Date(e);o&&o<this.StartDateOfBasicForm?(this.notificationService.error("Sample received date should be greated than Basic Start date"),this.QualityForm.get("SampleReceivedTime")?.reset(),this.IsValidQualitydDate=!1):(this.QualityForm.get("SampleReceivedTime")?.updateValueAndValidity(),this.IsValidQualitydDate=!0)}onTestedDateChange(){const e=this.QualityForm.get("SampleTestedTime")?.value,o=this.QualityForm.get("SampleReceivedTime")?.value,i=new Date(e),s=new Date(o);o?o&&e&&i<s?(this.notificationService.error("Sample tested date should be greated than sample recieved date"),this.QualityForm.get("SampleTestedTime")?.reset(),this.IsValidTestedDate=!1):(this.QualityForm.get("SampleTestedTime")?.updateValueAndValidity(),this.IsValidTestedDate=!0):(this.notificationService.error("please select Sample recieved date"),this.QualityForm.get("SampleTestedTime")?.reset(),this.IsValidTestedDate=!1)}addQuality(){if(this.isQualityFormSubmitted=!0,this.IsValidTestedDate)if(this.QualityForm.valid){let e=this.QualityForm.value;console.log("quality formvalue",e);let o=this.usersList.filter(i=>e.AnalysisDoneByIds.includes(i.id)).map(i=>i.name).join(", ");e.DoneByNames=o,e.SpecificationLimitName=this.qCTSpecificationMasterList.find(i=>i.id==e.SpecificationLimitId).specificationName,this.EditQualityId>=0?(this.AddedQualityList[this.EditQualityId]=e,this.QualityForm.reset(),this.isQualityFormSubmitted=!1,this.CreateQualityForm()):(this.AddedQualityList.push(e),this.QualityForm.reset(),this.isQualityFormSubmitted=!1,this.CreateQualityForm())}else this.notificationService.error("Invalid Data");else this.notificationService.error("Pl correct tested Date");console.log("AddedQualityList",this.AddedQualityList)}onEditQualityDetail(e,o){console.log("Quaitydetails selected for edit",this.AddedQualityList[o]);let i=this.AddedQualityList[o];this.QualityForm.patchValue({TestingDateTime:i.TestingDateTime,AnalysisDoneByIds:i.AnalysisDoneByIds,SampleReceivedTime:i.SampleReceivedTime,SampleTestedTime:i.SampleTestedTime,SpecificationLimitId:i.SpecificationLimitId,Test1:i.Test1,Test2:i.Test2}),this.EditQualityId=o}removeQualityDetail(e){this.AddedQualityList.splice(e,1),console.log("AddedQualityList",this.AddedQualityList)}getToday(){return(new Date).toISOString().split("T")[0]}createliquidPreparation(e){this.liquidPreparationService.addLiquidPreparation(e).subscribe(()=>{this.cancel(),this.notificationService.success("Liquid Preparation created successfully.")},o=>{this.error=o})}updateliquidPreparation(e){this.liquidPreparationService.updateLiquidPreparation(e).subscribe(()=>{this.cancel(),this.notificationService.success("Liquid Preparation updated successfully.")},o=>{this.error=o})}Submit(){console.log("draftBasicFormValue",this.draftBasicFormValue),console.log("draftStartCheckListFormValue",this.draftStartCheckListFormValue),console.log("AddedInstructionList",this.AddedInstructionList),console.log("draftEndCheckListFormValue",this.draftEndCheckListFormValue),console.log("AddedQualityList",this.AddedQualityList),console.log("DiffWghInstructionList",this.DiffWghInstructionList);let e=this.TransFormData();console.log("Playload",e),this.isEditMode?this.updateliquidPreparation(e):this.createliquidPreparation(e)}formatDateForSQL(e){return e&&e.isValid()?e.format("YYYY-MM-DDTHH:mm:ss"):null}TransFormData(){const e=[...this.draftStartCheckListFormValue.questions.map(i=>({...i,type:1})),...this.draftEndCheckListFormValue.questions.map(i=>({...i,type:2}))];return{Id:this.isEditMode?this.liquidPreparationId:0,Code:this.isEditMode?this.liquidPreparationData.code:"",StartDateTime:this.draftBasicFormValue.StartDateTime,EndDateTime:this.draftBasicFormValue.EndDateTime,SAPProductionOrderId:this.isEditMode?this.liquidPreparationData.sapProductionOrderId:this.draftBasicFormValue.SAPProductionOrderId,ProductId:this.isEditMode?this.liquidPreparationData.ProductId:this.draftBasicFormValue.ProductId,ShiftId:this.draftBasicFormValue.ShiftId,BatchLotNumber:this.draftBasicFormValue.BatchLotNumber.toString(),TankId:this.draftBasicFormValue.TankId,CompounderUserId:this.draftBasicFormValue.CompounderUserId,StandardBatchWeight:this.draftBasicFormValue.StandardBatchWeight.toString(),TestingDateTime:null,AnalysisDoneByIds:"",AnalysisDoneByList:null,SampleReceivedTime:null,SampleTestedTime:null,IsActive:!0,liquidPreparationAdjustmentDetails:this.DiffWghInstructionList.map(i=>({Id:0,LiquidPreparationId:0,MaterialId:i.MaterialId,LiquidPreparationInstructionId:i.InstructionId,Weight:i.WeightAdded,Adjustment:i.diffWeight,Total:i.Weight,IsActive:!0})),liquidPreparationChecklistDetails:e.map(i=>({Id:0,LiquidPreparationId:0,Type:i.type.toString(),QuestionId:i.id,Answer:i.answer,TankNo:i.tankNo||null,IsActive:!0,TankId:i.tankId||null,Reason:i.reason||""})),liquidPreparationInstructionDetails:this.AddedInstructionList.map(i=>({Id:0,LiquidPreparationId:0,InstructionId:i.InstructionId,MaterialId:i.MaterialId,LotNumber:i.LotNumber.toString(),Weight:i.Weight,WeightAdded:i.WeightAdded,DoneByList:i.DoneByIds.map(s=>`${s}`),AddedTime:i.AddedTime,IsActive:!0})),liquidPreparationSpecificationDetails:this.AddedQualityList.map(i=>({Id:0,LiquidPreparationId:0,SpecificationLimitId:i.SpecificationLimitId,Test1:i.Test1||"",Test2:i.Test2||"",TestingDateTime:i.TestingDateTime,AnalysisDoneByList:i.AnalysisDoneByIds.map(s=>`${s}`),SampleReceivedTime:i.SampleReceivedTime,SampleTestedTime:i.SampleTestedTime,IsActive:!0}))}}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(h.nX),t.rXU(h.Ix),t.rXU(d.ze),t.rXU(b),t.rXU(S.tw),t.rXU(M.Q),t.rXU(t.gRc))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-add-edit"]],decls:29,vars:10,consts:[["form","ngForm"],["pickerStartDate",""],["pickerEndDate",""],["pickerTestingDateTime",""],["pickerSampleReceivedTime",""],["pickerSampleTestedTime",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"click",4,"authPermission"],[1,"tab-group-container"],[1,"tab-group-bordered",3,"selectedIndexChange","selectedIndex"],["label","Basic"],["matTabContent",""],["label","Start Checklist",3,"disabled"],["label","Instructions",3,"disabled"],["label","End Checklist",3,"disabled"],["label","Quality",3,"disabled"],["label","Adjustment",3,"disabled"],[1,"d-flex","justify-content-end",2,"margin-top","20px"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","primary","class","ms-4",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary","class","ms-4",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",1,"app-button",3,"click"],["novalidate","",1,"app-form",3,"formGroup"],[1,"card","mb-4"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","mb-3"],["appearance","fill"],["matInput","","placeholder","Start Date","formControlName","StartDateTime","required","",3,"dateChange","ngxMatDatetimePicker"],["type","button","mat-icon-button","","matSuffix","",3,"click"],["apperance","fill"],["matInput","","placeholder","End Date","formControlName","EndDateTime","required","",3,"dateChange","ngxMatDatetimePicker"],["appearance","fill",1,"full-width"],["formControlName","SAPProductionOrderId",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"control","message","formSubmitted"],["formControlName","ProductId",3,"disabled"],["formControlName","ShiftId"],["matInput","","formControlName","BatchLotNumber","type","number"],["formControlName","TankId"],["formControlName","CompounderUserId"],["matInput","","formControlName","StandardBatchWeight","type","number"],[3,"value"],["formArrayName","questions"],["class","mb-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mb-3",3,"formGroupName"],[1,"col-12","col-sm-12","col-md-5","col-lg-5","mb-3"],[1,"col-12","col-sm-12","col-md-3","col-lg-3","mb-3"],["formControlName","answer",3,"change"],["value","Yes"],["value","No","disabled","true"],["value","NA"],[1,"col-12","col-sm-12","col-md-4","col-lg-4","mb-3"],["appearance","fill","class","full-width",4,"ngIf"],["matInput","","formControlName","reason"],[1,"card-header"],["formControlName","InstructionId",3,"selectionChange"],["formControlName","MaterialId"],["matInput","","formControlName","LotNumber"],["matInput","","formControlName","Weight","type","number"],["matInput","","formControlName","WeightAdded","type","number"],["formControlName","DoneByIds","multiple",""],["matInput","","formControlName","AddedTime","readonly",""],[1,"col-12","col-sm-12","col-md-1","col-lg-1","mb-3","p-1","d-flex","align-items-center"],["type","button","mat-icon-button","","color","warn",3,"click"],[1,"col-md-12"],[1,"table-responsive"],["id","gridNozzlewiseWeight",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner"],[1,"bg-primary","text-primary","text-center"],[2,"width","20%"],[4,"ngFor","ngForOf"],["colspan","3",1,"text-center"],["colspan","3"],["type","button",1,"btn","btn-primary","btn-sm","btnModifyRow",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-danger","btn-sm","btnRemoveRow",3,"click"],[1,"fa","fa-close"],["formControlName","tankId"],["matInput","","placeholder","Date Tested","formControlName","TestingDateTime","required","",3,"ngxMatDatetimePicker"],["formControlName","AnalysisDoneByIds","multiple",""],["matInput","","placeholder","Sample Received At","formControlName","SampleReceivedTime","required","",3,"ngxMatDatetimePicker"],["matInput","","placeholder","Sample Tested At","formControlName","SampleTestedTime","required","",3,"ngxMatDatetimePicker"],["formControlName","SpecificationLimitId"],["matInput","","formControlName","Test1"],["matInput","","formControlName","Test2"],[1,"col-md-12","full-width"],["id","gridQualityList",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner"],["id","gridAdjustment",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner",2,"overflow","scroll","width","auto"],[1,"full-width"],[2,"width","25%"],["mat-raised-button","","color","primary",1,"ms-4",3,"click","disabled"],["mat-raised-button","","color","primary",1,"ms-4",3,"click"]],template:function(o,i){1&o&&(t.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h4",11),t.nrm(6,"i",12),t.EFF(7," Add/Edit Liquid Preparation"),t.k0s()(),t.j41(8,"div",13),t.DNE(9,w,2,0,"a",14),t.k0s()(),t.j41(10,"div",15)(11,"mat-tab-group",16),t.mxI("selectedIndexChange",function(r){return t.DH7(i.selectedIndex,r)||(i.selectedIndex=r),r}),t.j41(12,"mat-tab",17),t.DNE(13,J,68,31,"ng-template",18),t.k0s(),t.j41(14,"mat-tab",19),t.DNE(15,Z,7,2,"ng-template",18),t.k0s(),t.j41(16,"mat-tab",20),t.DNE(17,ot,92,28,"ng-template",18),t.k0s(),t.j41(18,"mat-tab",21),t.DNE(19,lt,7,2,"ng-template",18),t.k0s(),t.j41(20,"mat-tab",22),t.DNE(21,pt,86,13,"ng-template",18),t.k0s(),t.j41(22,"mat-tab",23),t.DNE(23,ft,21,1,"ng-template",18),t.k0s()(),t.j41(24,"div",24)(25,"button",25),t.bIt("click",function(){return i.goToPreviousTab()}),t.EFF(26,"Previous"),t.k0s(),t.DNE(27,gt,2,1,"button",26)(28,It,2,0,"button",27),t.k0s()()()()()),2&o&&(t.R7$(9),t.Y8G("authPermission",i.page+"_"+i.permissions.list),t.R7$(2),t.R50("selectedIndex",i.selectedIndex),t.R7$(3),t.Y8G("disabled",i.isstartChecklistDisable),t.R7$(2),t.Y8G("disabled",i.isInstructionsDisable),t.R7$(2),t.Y8G("disabled",i.isEndChecklistDisable),t.R7$(2),t.Y8G("disabled",i.isQualityDisable),t.R7$(2),t.Y8G("disabled",i.isAdjustmentDisable),t.R7$(3),t.Y8G("disabled",0===i.selectedIndex),t.R7$(2),t.Y8G("ngIf",5!=i.selectedIndex),t.R7$(),t.Y8G("ngIf",5===i.selectedIndex))},dependencies:[p.Sq,p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.j4,d.JD,d.$R,d.v8,g.It,g.$z,g.iY,I.rl,I.nJ,I.yw,y.fg,E.An,Y.VO,C.wT,P.VT,P._g,_.$L,_.mq,_.T8,D.B,Q.r,f.m7,f.yF,p.QX,p.vh],styles:["mat-tab-group[_ngcontent-%COMP%]{margin:20px}.tab-group-bordered[_ngcontent-%COMP%]{border:2px solid var(--bs-border-color)!important;border-radius:8px;padding:10px;margin-bottom:20px}.card[_ngcontent-%COMP%]{margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:.75rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.full-width[_ngcontent-%COMP%]{width:100%}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.readonly-input[_ngcontent-%COMP%]{color:#000;background-color:#f5f5f5;cursor:not-allowed;border:1px solid #dcdcdc}  .mat-calendar{background-color:#d3d3d3}  .time-container{background-color:#d3d3d3}  .mat-calendar-body-selected{background-color:#1976d2!important;color:#fff!important;border-radius:50%!important}  .mat-calendar-body-active{background-color:#42a5f5!important;border-radius:50%!important}  .mat-calendar-body-today{border-color:#ff9800!important;border-width:2px;border-style:solid;border-radius:50%}"]})}return a})();l(9239);const kt=[{path:"",component:L,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:T,canActivate:[m.LL],data:{page:m.Wt.liquidPreparation,title:"LiquidPreparation"}},{path:"add",canActivate:[m.LL],data:{page:m.Wt.liquidPreparation,title:"LiquidPreparation"},component:F},{path:"edit/:id",canActivate:[m.LL],data:{page:m.Wt.liquidPreparation,title:"LiquidPreparation"},component:F}]}];let Ft=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275mod=t.$C({type:a});static#i=this.\u0275inj=t.G2t({imports:[h.iI.forChild(kt),h.iI]})}return a})();var vt=l(1774),Lt=l(2356),St=l(9830),Et=l(40),Dt=l(5263);let Tt=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275mod=t.$C({type:a});static#i=this.\u0275inj=t.G2t({providers:[b,(0,St._c)()],imports:[p.MD,Ft,vt.Gg,Lt.c9,_.RI,f.Hw,f.Xg,f.T_,C.WX,Dt.ZG,Et.Yr,I.RG,y.fS]})}return a})()}}]);