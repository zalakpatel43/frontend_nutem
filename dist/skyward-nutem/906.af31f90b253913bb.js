"use strict";(self.webpackChunkskyward_nutem=self.webpackChunkskyward_nutem||[]).push([[906],{6441:(B,v,s)=>{s.d(v,{L:()=>t});var u=s(4438),h=s(4532),d=s(8498);let t=(()=>{class p{constructor(f,b){this.permissionService=f,this.router=b}canActivate(f,b){return!!this.permissionService.hasPermission(f.data.permission)||(this.router.navigate(["/unauthorized"]),!1)}static#t=this.\u0275fac=function(b){return new(b||p)(u.KVO(h.n),u.KVO(d.Ix))};static#e=this.\u0275prov=u.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},6906:(B,v,s)=>{s.r(v),s.d(v,{LaborVarianceModule:()=>bt});var u=s(177),h=s(8498),d=s(4434),t=s(4438),p=s(1626);let k=(()=>{class a{constructor(e,o){this.http=e,this._baseService=o}getLaborVarianceList(){return this.http.get(`${d.T6.laborVarinceList}`)}addLaborVariance(e){return this.http.post(`${d.T6.laborVarinceAdd}`,e)}updateLaborVariance(e){return this.http.post(`${d.T6.laborVarinceEdit}`,e)}getByIdLaborVariance(e){return this.http.get(`${d.T6.laborVarinceGetById}?id=`+e)}DeleteLaborVariance(e){return this.http.get(`${d.T6.laborVarinceDelete}?id=`+e)}static#t=this.\u0275fac=function(o){return new(o||a)(t.KVO(p.Qq),t.KVO(d.dD))};static#e=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var f=s(5794),b=s(7936),C=s(8834),N=s(9213),D=s(3380),M=s(6081);const O=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),$=()=>["../","add"],w=a=>["..","edit",a];function G(a,l){1&a&&(t.j41(0,"a",17)(1,"span"),t.EFF(2,"Add New"),t.k0s(),t.nrm(3,"i",18),t.k0s()),2&a&&t.Y8G("routerLink",t.lJ4(1,$))}function x(a,l){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const e=l.value;t.R7$(),t.JRh(t.i5U(2,1,e,"dd/MM/yyyy hh:mm a"))}}function Y(a,l){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=l.value;t.R7$(),t.JRh(e)}}function J(a,l){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=l.value;t.R7$(),t.JRh(e)}}function H(a,l){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=l.value;t.R7$(),t.JRh(e)}}function U(a,l){if(1&a&&(t.j41(0,"a",22)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&a){const e=t.XpG().row;t.Y8G("routerLink",t.eq3(1,w,e.id))}}function X(a,l){if(1&a){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const r=t.XpG().row,i=t.XpG(2);return t.Njj(i.removeLaborVarince(r.id))}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function W(a,l){if(1&a&&t.DNE(0,U,3,3,"a",20)(1,X,3,0,"button",21),2&a){const e=t.XpG(2);t.Y8G("ngIf",e.IsEditPermission),t.R7$(),t.Y8G("ngIf",e.IsDeletePermission)}}function K(a,l){1&a&&(t.j41(0,"ngx-datatable-column",19),t.DNE(1,W,2,2,"ng-template",12),t.k0s()),2&a&&t.Y8G("sortable",!1)}let _=(()=>{class a{constructor(e,o,r){this.laborVarinaceService=e,this.notificationService=o,this.permissionService=r,this.LaborVarianceData=[],this.page=d.Wt.laborVariance,this.permissions=d.eZ,this.IsAddPemission=!0,this.IsEditPermission=!0,this.IsDeletePermission=!0,this.searchData={},this.showDeleteModal=!1}ngOnInit(){this.getLaborVarinceData()}getLaborVarinceData(){this.loading=!0,this.laborVarinaceService.getLaborVarianceList().subscribe(e=>{this.LaborVarianceData=e,this.loading=!1},e=>{this.error=e,this.loading=!1})}removeLaborVarince(e){confirm("Are you sure, you want to delete this Weight Check?")&&this.laborVarinaceService.DeleteLaborVariance(e).subscribe(()=>{this.getLaborVarinceData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(e){this.searchData=Object.assign({},e)}isActiveRow(e){return{"text-danger":!e.isActive}}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(k),t.rXU(f.tw),t.rXU(b.n))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-list"]],decls:22,vars:15,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","class","app-button btn",3,"routerLink",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","Date","prop","dateTime"],["ngx-datatable-cell-template",""],["name","Product Line","prop","productLineName"],["name","Shift","prop","shiftName"],["name","Total Employee","prop","totalEmployee"],["name","Actions",3,"sortable",4,"ngIf"],["mat-flat-button","",1,"app-button","btn",3,"routerLink"],[1,"icon-plus"],["name","Actions",3,"sortable"],["class","button-padding icon-green",3,"routerLink",4,"ngIf"],["type","button","style","border: none; background-color: white; color: red;",3,"click",4,"ngIf"],[1,"button-padding","icon-green",3,"routerLink"],["type","button",2,"border","none","background-color","white","color","red",3,"click"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Labor Variance List"),t.k0s()(),t.j41(7,"div",6),t.DNE(8,G,4,2,"a",7),t.k0s()(),t.j41(9,"div",8)(10,"div",9)(11,"ngx-datatable",10),t.nI1(12,"searchtable"),t.j41(13,"ngx-datatable-column",11),t.DNE(14,x,3,4,"ng-template",12),t.k0s(),t.j41(15,"ngx-datatable-column",13),t.DNE(16,Y,2,1,"ng-template",12),t.k0s(),t.j41(17,"ngx-datatable-column",14),t.DNE(18,J,2,1,"ng-template",12),t.k0s(),t.j41(19,"ngx-datatable-column",15),t.DNE(20,H,2,1,"ng-template",12),t.k0s(),t.DNE(21,K,2,1,"ngx-datatable-column",16),t.k0s()()()()()()),2&o&&(t.R7$(8),t.Y8G("ngIf",r.IsAddPemission),t.R7$(3),t.Y8G("rows",t.i5U(12,11,r.LaborVarianceData,r.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",r.loading)("scrollbarH",!0)("messages",t.lJ4(14,O)),t.R7$(10),t.Y8G("ngIf",r.IsEditPermission||r.IsDeletePermission))},dependencies:[u.bT,h.Wk,C.It,N.An,D.ge,D.ed,D.QI,u.vh,M.j],styles:[".ngx-datatable .datatable-header-cell{background-color:#17bb58!important;color:#fff!important}.icon-green[_ngcontent-%COMP%]{color:green}.btn[_ngcontent-%COMP%]{background-color:#17bb58!important;color:#fff!important}  .ngx-datatable.material .datatable-body .progress-linear .container{background-color:#90ee90}  .ngx-datatable.material .datatable-body .progress-linear .container .bar{background-color:green}"]})}return a})();var V=s(6441),m=s(9417),z=s(1528),Q=s(4480),L=s(2102),Z=s(9631),q=s(2798),tt=s(6600),S=s(5084),et=s(8777),ot=s(7133),P=s(2356);function rt(a,l){if(1&a){const e=t.RV6();t.j41(0,"a",45),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.cancel())}),t.EFF(1," View List "),t.k0s()}}function at(a,l){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.shiftName," ")}}function it(a,l){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function nt(a,l){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.poNumber," ")}}function st(a,l){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.productName," ")}}function lt(a,l){if(1&a){const e=t.RV6();t.j41(0,"div",47)(1,"div",17)(2,"div",18)(3,"mat-form-field",19)(4,"mat-label"),t.EFF(5,"Production Order"),t.k0s(),t.j41(6,"mat-select",48),t.DNE(7,nt,2,2,"mat-option",24),t.k0s()()(),t.j41(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),t.EFF(11,"Product"),t.k0s(),t.j41(12,"mat-select",49),t.DNE(13,st,2,2,"mat-option",24),t.k0s()()(),t.j41(14,"div",18)(15,"mat-form-field",19)(16,"mat-label"),t.EFF(17,"Start Time"),t.k0s(),t.nrm(18,"input",50)(19,"ngx-material-timepicker",null,2),t.k0s()(),t.j41(21,"div",18)(22,"mat-form-field",19)(23,"mat-label"),t.EFF(24,"End Time"),t.k0s(),t.nrm(25,"input",51)(26,"ngx-material-timepicker",null,3),t.k0s()(),t.j41(28,"div",18)(29,"mat-form-field",19)(30,"mat-label"),t.EFF(31,"Late Start Reason"),t.k0s(),t.nrm(32,"input",52),t.k0s()(),t.j41(33,"div",18)(34,"mat-form-field",19)(35,"mat-label"),t.EFF(36,"Change Over Time"),t.k0s(),t.nrm(37,"input",53),t.k0s()(),t.j41(38,"div",18)(39,"mat-form-field",19)(40,"mat-label"),t.EFF(41,"Actual Bottle Produced"),t.k0s(),t.nrm(42,"input",54),t.k0s()(),t.j41(43,"div",18)(44,"mat-form-field",19)(45,"mat-label"),t.EFF(46,"Total Run Time(Mins)"),t.k0s(),t.nrm(47,"input",55),t.k0s()(),t.j41(48,"div",18)(49,"mat-form-field",19)(50,"mat-label"),t.EFF(51,"Shift Comments"),t.k0s(),t.nrm(52,"input",56),t.k0s()(),t.j41(53,"div",18)(54,"mat-form-field",19)(55,"mat-label"),t.EFF(56,"Downtime (Mins)"),t.k0s(),t.nrm(57,"input",57),t.k0s()(),t.j41(58,"div",18)(59,"mat-form-field",19)(60,"mat-label"),t.EFF(61,"Downtime Comments"),t.k0s(),t.nrm(62,"input",58),t.k0s()(),t.j41(63,"div",18)(64,"mat-form-field",19)(65,"mat-label"),t.EFF(66,"HC"),t.k0s(),t.nrm(67,"input",59),t.k0s()(),t.j41(68,"div",18)(69,"mat-form-field",19)(70,"mat-label"),t.EFF(71,"Case Attainment"),t.k0s(),t.nrm(72,"input",60),t.k0s()(),t.j41(73,"div",18)(74,"mat-form-field",19)(75,"mat-label"),t.EFF(76,"Case Target"),t.k0s(),t.nrm(77,"input",61),t.k0s()(),t.j41(78,"div",18)(79,"mat-form-field",19)(80,"mat-label"),t.EFF(81,"%"),t.k0s(),t.nrm(82,"input",62),t.k0s()(),t.j41(83,"div",18)(84,"mat-form-field",19)(85,"mat-label"),t.EFF(86,"Bottle Target"),t.k0s(),t.nrm(87,"input",63),t.k0s()(),t.j41(88,"div",18)(89,"mat-form-field",19)(90,"mat-label"),t.EFF(91,"Shift Index"),t.k0s(),t.nrm(92,"input",64),t.k0s()(),t.j41(93,"div",18)(94,"mat-form-field",19)(95,"mat-label"),t.EFF(96,"Criteria"),t.k0s(),t.nrm(97,"input",65),t.k0s()(),t.j41(98,"div",18)(99,"mat-form-field",19)(100,"mat-label"),t.EFF(101,"Missing FG Items"),t.k0s(),t.nrm(102,"input",66),t.k0s()(),t.j41(103,"div",18)(104,"mat-form-field",19)(105,"mat-label"),t.EFF(106,"Non Production Time"),t.k0s(),t.nrm(107,"input",67),t.k0s()(),t.j41(108,"div",18)(109,"mat-form-field",19)(110,"mat-label"),t.EFF(111,"Additional Comments"),t.k0s(),t.nrm(112,"input",68),t.k0s()(),t.j41(113,"div",18)(114,"mat-form-field",19)(115,"mat-label"),t.EFF(116,"Time Per Person "),t.k0s(),t.nrm(117,"input",69),t.k0s()(),t.j41(118,"div",18)(119,"mat-form-field",19)(120,"mat-label"),t.EFF(121,"Total Mins"),t.k0s(),t.nrm(122,"input",70),t.k0s()(),t.j41(123,"div",18)(124,"mat-form-field",19)(125,"mat-label"),t.EFF(126,"Description"),t.k0s(),t.nrm(127,"input",71),t.k0s()(),t.j41(128,"div",72)(129,"button",73),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.addFinallaborVarianceDetail())}),t.j41(130,"mat-icon"),t.EFF(131,"add"),t.k0s()()()()()}if(2&a){const e=l.index,o=t.sdS(20),r=t.sdS(27),i=t.XpG();t.Y8G("formGroupName",e),t.R7$(7),t.Y8G("ngForOf",i.productionOrderList),t.R7$(6),t.Y8G("ngForOf",i.productList),t.R7$(5),t.Y8G("ngxTimepicker",o),t.R7$(7),t.Y8G("ngxTimepicker",r)}}function mt(a,l){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s(),t.j41(17,"td"),t.EFF(18),t.k0s(),t.j41(19,"td"),t.EFF(20),t.k0s(),t.j41(21,"td"),t.EFF(22),t.k0s(),t.j41(23,"td"),t.EFF(24),t.k0s(),t.j41(25,"td"),t.EFF(26),t.k0s(),t.j41(27,"td"),t.EFF(28),t.k0s(),t.j41(29,"td"),t.EFF(30),t.k0s(),t.j41(31,"td"),t.EFF(32),t.k0s(),t.j41(33,"td"),t.EFF(34),t.k0s(),t.j41(35,"td"),t.EFF(36),t.k0s(),t.j41(37,"td"),t.EFF(38),t.k0s(),t.j41(39,"td"),t.EFF(40),t.k0s(),t.j41(41,"td"),t.EFF(42),t.k0s(),t.j41(43,"td"),t.EFF(44),t.k0s(),t.j41(45,"td"),t.EFF(46),t.k0s(),t.j41(47,"td"),t.EFF(48),t.k0s(),t.j41(49,"td")(50,"button",74),t.bIt("click",function(){const r=t.eBV(e),i=r.$implicit,g=r.index,n=t.XpG();return t.Njj(n.onEditDetail(i,g))}),t.nrm(51,"i",75),t.k0s(),t.j41(52,"button",76),t.bIt("click",function(){const r=t.eBV(e).index,i=t.XpG();return t.Njj(i.removeLaborVarianceDetail(r))}),t.nrm(53,"i",77),t.k0s()()()}if(2&a){const e=l.$implicit;t.R7$(2),t.JRh(e.POName),t.R7$(2),t.JRh(e.ProductName),t.R7$(2),t.JRh(e.StartDateTime),t.R7$(2),t.JRh(e.EndDateTime),t.R7$(2),t.JRh(e.LateStartReason),t.R7$(2),t.JRh(e.ChangeOverTime),t.R7$(2),t.JRh(e.ActualBottleProduced),t.R7$(2),t.JRh(e.TotalRunTImeMins),t.R7$(2),t.JRh(e.ShiftComments),t.R7$(2),t.JRh(e.DownTimeMins),t.R7$(2),t.JRh(e.DownTImeComments),t.R7$(2),t.JRh(e.HC),t.R7$(2),t.JRh(e.CaseAttainment),t.R7$(2),t.JRh(e.CaseTarget),t.R7$(2),t.SpI("",e.Percentage," %"),t.R7$(2),t.JRh(e.BottleTarget),t.R7$(2),t.JRh(e.ShiftIndex),t.R7$(2),t.JRh(e.Criteria),t.R7$(2),t.JRh(e.MissingFGItems),t.R7$(2),t.JRh(e.NonProductionTime),t.R7$(2),t.JRh(e.AdditionalComments),t.R7$(2),t.JRh(e.TimePerPerson),t.R7$(2),t.JRh(e.TotalMins),t.R7$(2),t.JRh(e.Description)}}let I=(()=>{class a{constructor(e,o,r,i,g,n,c,T){this.activatedRoute=e,this.router=o,this.formBuilder=r,this.laborVarinceService=i,this.notificationService=g,this.weightCheckService=n,this.permissionService=c,this.downtimeTrackingService=T,this.page=d.Wt.laborVariance,this.permissions=d.eZ,this.shiftList=[],this.productionOrderList=[],this.productList=[],this.fillingLineList=[],this.usersList=[],this.AddedlaborVarianceDetailsList=[],this.EditDetailsId=-1,this.minEndDate=null,this.IsViewPermission=!0,this.TotalEmployee=0,this.createForm()}ngOnInit(){this.getRoute(),this.loadDropdowns()}getRoute(){this.routerSub=this.activatedRoute.params.subscribe(e=>{this.isEditMode=!d.ov.isEmpty(e.id),this.createForm(),this.addlaborDetail(),this.isEditMode&&(this.laborVarianceId=e.id,this.getlaborVarianceById())})}getlaborVarianceById(){this.laborVarinceService.getByIdLaborVariance(this.laborVarianceId).subscribe(e=>{this.laborVarianceData=e,this.setlaborVariancekData(),console.log("get by id data",e)},e=>{console.log(e)})}setlaborVariancekData(){this.laborVarianceForm.patchValue({Code:this.laborVarianceData.code,DateTime:this.laborVarianceData.dateTime,ShiftId:this.laborVarianceData.shiftId,ProductLineId:this.laborVarianceData.productLineId,Employees:this.laborVarianceData.employees,TempEmployee:this.laborVarianceData.tempEmployee,TotalEmployee:this.laborVarianceData.totalEmployee,Note:this.laborVarianceData.note});const e=o=>new Date(o).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});setTimeout(()=>{this.laborVarianceData.laborVarianceDetails?.forEach(o=>{let r={SAPProductionOrderId:o.sapProductionOrderId,ProductId:o.productId,StartDateTime:o.startDateTime?e(o.startDateTime):"",EndDateTime:o.endDateTime?e(o.endDateTime):"",LateStartReason:o.lateStartReason,ChangeOverTime:o.changeOverTime,ActualBottleProduced:o.actualBottleProduced,TotalRunTImeMins:o.totalRunTImeMins,ShiftComments:o.shiftComments,DownTimeMins:o.downTimeMins,DownTImeComments:o.downTImeComments,HC:o.hc,CaseAttainment:o.caseAttainment,CaseTarget:o.caseTarget,Percentage:o.percentage,BottleTarget:o.bottleTarget,ShiftIndex:o.shiftIndex,Criteria:o.criteria,MissingFGItems:o.missingFGItems,NonProductionTime:o.nonProductionTime,AdditionalComments:o.additionalComments,TimePerPerson:o.timePerPerson,TotalMins:o.totalMins,Description:o.description,POName:this.productionOrderList.find(i=>i.id===o.sapProductionOrderId)?.poNumber,ProductName:this.productList.find(i=>i.id===o.productId)?.productName};this.AddedlaborVarianceDetailsList.push(r)})},500)}loadDropdowns(){this.weightCheckService.getShiftList().subscribe(e=>{this.shiftList=e}),this.weightCheckService.getProductionOrderList().subscribe(e=>{this.productionOrderList=e,this.AddedlaborVarianceDetailsList.forEach(o=>{o.POName=this.productionOrderList.find(r=>r.id==o.SAPProductionOrderId)?.poNumber,o.ProductName=this.productList.find(r=>r.id==o.ProductId)?.productName})}),this.weightCheckService.getProductList().subscribe(e=>{this.productList=e}),this.downtimeTrackingService.getMaster().subscribe(e=>{this.fillingLineList=this.filterFillingLines(e)})}filterFillingLines(e){return e.filter(o=>o.categoryName&&-1!==o.categoryName.toLowerCase().indexOf("fill"))}createForm(){this.laborVarianceForm=this.formBuilder.group({Code:[{value:"",disabled:!0},[m.k0.required]],DateTime:["",[m.k0.required]],ShiftId:["",[m.k0.required]],ProductLineId:["",[m.k0.required]],Employees:["",[m.k0.required]],TempEmployee:["",[m.k0.required]],TotalEmployee:["",""],Note:["",""],LaborVarianceDetails:this.formBuilder.array([])}),this.laborVarianceForm.controls.DateTime.setValue((new Date).toISOString().split("T")[0]),this.laborVarianceForm.get("Employees")?.valueChanges.subscribe(()=>{this.updateTotalEmployees()}),this.laborVarianceForm.get("TempEmployee")?.valueChanges.subscribe(()=>{this.updateTotalEmployees()})}updateTotalEmployees(){const e=this.laborVarianceForm.get("Employees")?.value||0,o=this.laborVarianceForm.get("TempEmployee")?.value||0;this.TotalEmployee=e+o,this.laborVarianceForm.get("TotalEmployee")?.setValue(this.TotalEmployee,{emitEvent:!1}),this.LaborVarianceDetails.at(0).get("HC")?.setValue(this.TotalEmployee,{emitEvent:!1})}getToday(){return(new Date).toISOString().split("T")[0]}addlaborDetail(){this.LaborVarianceDetails?.clear(),this.EditDetailsId=-1;const e=this.formBuilder.group({});e.addControl("SAPProductionOrderId",this.formBuilder.control("")),e.addControl("ProductId",this.formBuilder.control("")),e.addControl("StartDateTime",this.formBuilder.control("")),e.addControl("EndDateTime",this.formBuilder.control("")),e.addControl("LateStartReason",this.formBuilder.control("")),e.addControl("ChangeOverTime",this.formBuilder.control("")),e.addControl("ActualBottleProduced",this.formBuilder.control("")),e.addControl("TotalRunTImeMins",this.formBuilder.control("")),e.addControl("ShiftComments",this.formBuilder.control("")),e.addControl("DownTimeMins",this.formBuilder.control("")),e.addControl("DownTImeComments",this.formBuilder.control("")),e.addControl("HC",this.formBuilder.control(this.TotalEmployee||"")),e.addControl("CaseAttainment",this.formBuilder.control("")),e.addControl("CaseTarget",this.formBuilder.control("")),e.addControl("Percentage",this.formBuilder.control("")),e.addControl("BottleTarget",this.formBuilder.control("")),e.addControl("ShiftIndex",this.formBuilder.control("")),e.addControl("Criteria",this.formBuilder.control("")),e.addControl("MissingFGItems",this.formBuilder.control("")),e.addControl("NonProductionTime",this.formBuilder.control("")),e.addControl("AdditionalComments",this.formBuilder.control("")),e.addControl("TimePerPerson",this.formBuilder.control("")),e.addControl("TotalMins",this.formBuilder.control("")),e.addControl("Description",this.formBuilder.control("")),this.LaborVarianceDetails=this.laborVarianceForm?.get("LaborVarianceDetails"),this.LaborVarianceDetails.push(e),this.LaborVarianceDetails.at(0).get("CaseAttainment")?.valueChanges.subscribe(()=>{this.updatePercentage()}),this.LaborVarianceDetails.at(0).get("CaseTarget")?.valueChanges.subscribe(()=>{this.updatePercentage()})}updatePercentage(){const e=this.LaborVarianceDetails.at(0).get("CaseAttainment")?.value||0,o=this.LaborVarianceDetails.at(0).get("CaseTarget")?.value||0,r=o?(e/o*100).toFixed(2):0;this.LaborVarianceDetails.at(0).get("Percentage")?.setValue(r)}addFinallaborVarianceDetail(){const e=this.LaborVarianceDetails.at(0).value;e.SAPProductionOrderId?e.ProductId?this.EditDetailsId>=0?(e.POName=this.productionOrderList.find(o=>o.id==e.SAPProductionOrderId).poNumber,e.ProductName=this.productList.find(o=>o.id==e.ProductId).productName,this.AddedlaborVarianceDetailsList[this.EditDetailsId]=e,this.addlaborDetail()):(e.POName=this.productionOrderList.find(o=>o.id==e.SAPProductionOrderId).poNumber,e.ProductName=this.productList.find(o=>o.id==e.ProductId).productName,this.AddedlaborVarianceDetailsList.push(e),this.addlaborDetail()):this.notificationService.error("please select product"):this.notificationService.error("please select production order")}onEditDetail(e,o){this.populateFormWithValues(this.AddedlaborVarianceDetailsList[o]),this.EditDetailsId=o}populateFormWithValues(e){const o=Array.isArray(e)?e:[e];this.LaborVarianceDetails=this.laborVarianceForm.get("LaborVarianceDetails"),this.LaborVarianceDetails.clear(),o.forEach(r=>{const i=this.formBuilder.group({});i.addControl("SAPProductionOrderId",this.formBuilder.control(r.SAPProductionOrderId||"")),i.addControl("ProductId",this.formBuilder.control(r.ProductId||"")),i.addControl("StartDateTime",this.formBuilder.control(r.StartDateTime||"")),i.addControl("EndDateTime",this.formBuilder.control(r.EndDateTime||"")),i.addControl("LateStartReason",this.formBuilder.control(r.LateStartReason||"")),i.addControl("ChangeOverTime",this.formBuilder.control(r.ChangeOverTime||"")),i.addControl("ActualBottleProduced",this.formBuilder.control(r.ActualBottleProduced||"")),i.addControl("TotalRunTImeMins",this.formBuilder.control(r.TotalRunTImeMins||"")),i.addControl("ShiftComments",this.formBuilder.control(r.ShiftComments||"")),i.addControl("DownTimeMins",this.formBuilder.control(r.DownTimeMins||"")),i.addControl("DownTImeComments",this.formBuilder.control(r.DownTImeComments||"")),i.addControl("HC",this.formBuilder.control(r.HC||"")),i.addControl("CaseAttainment",this.formBuilder.control(r.CaseAttainment||"")),i.addControl("CaseTarget",this.formBuilder.control(r.CaseTarget||"")),i.addControl("Percentage",this.formBuilder.control(r.Percentage||"")),i.addControl("BottleTarget",this.formBuilder.control(r.BottleTarget||"")),i.addControl("ShiftIndex",this.formBuilder.control(r.ShiftIndex||"")),i.addControl("Criteria",this.formBuilder.control(r.Criteria||"")),i.addControl("MissingFGItems",this.formBuilder.control(r.MissingFGItems||"")),i.addControl("NonProductionTime",this.formBuilder.control(r.NonProductionTime||"")),i.addControl("AdditionalComments",this.formBuilder.control(r.AdditionalComments||"")),i.addControl("TimePerPerson",this.formBuilder.control(r.TimePerPerson||"")),i.addControl("TotalMins",this.formBuilder.control(r.TotalMins||"")),i.addControl("Description",this.formBuilder.control(r.Description||"")),this.LaborVarianceDetails.push(i),this.LaborVarianceDetails.at(0).get("CaseAttainment")?.valueChanges.subscribe(()=>{this.updatePercentage()}),this.LaborVarianceDetails.at(0).get("CaseTarget")?.valueChanges.subscribe(()=>{this.updatePercentage()})})}removeLaborVarianceDetail(e){this.AddedlaborVarianceDetailsList.splice(e,1)}createLaborVariance(e){this.laborVarinceService.addLaborVariance(e).subscribe(()=>{this.cancel(),this.notificationService.success("Labor Variance created successfully.")},o=>{this.error=o})}updateLaborVariance(e){this.laborVarinceService.updateLaborVariance(e).subscribe(()=>{this.cancel(),this.notificationService.success("Labor  Variance updated successfully.")},o=>{this.error=o})}save(){if(this.isFormSubmitted=!0,this.laborVarianceForm.invalid)this.notificationService.error("Invalid form data");else if(this.AddedlaborVarianceDetailsList.length<1)this.notificationService.error("at lease one labor variance deatils required");else{let e=this.laborVarianceForm.value;e.LaborVarianceDetails=this.AddedlaborVarianceDetailsList,console.log("formvalue",e);let o=this.transformData(e);console.log("Playload",o),this.isEditMode?this.updateLaborVariance(o):this.createLaborVariance(o)}}transformData(e){function r(n){const T=n.match(/(\d{1,2}):(\d{2}) (AM|PM)/i);if(!T)throw new Error("Invalid time format");let[,y,j,E]=T,F=parseInt(y,10);const gt=parseInt(j,10);"AM"===E.toUpperCase()?12===F&&(F=0):"PM"===E.toUpperCase()&&12!==F&&(F+=12);const Ft=F.toString().padStart(2,"0"),Ct=gt.toString().padStart(2,"0"),R=new Date;return`${R.getFullYear()}-${(R.getMonth()+1).toString().padStart(2,"0")}-${R.getDate().toString().padStart(2,"0")}T${Ft}:${Ct}`}const i=Array.isArray(e.LaborVarianceDetails)?e.LaborVarianceDetails:Object.values(e.LaborVarianceDetails||{});return{Id:this.isEditMode?this.laborVarianceData.id:0,Code:this.isEditMode?this.laborVarianceData.code:"",DateTime:function o(n){const c=new Date(n);if(isNaN(c.getTime()))throw new Error("Invalid date string provided");return`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}T${String(c.getHours()).padStart(2,"0")}:${String(c.getMinutes()).padStart(2,"0")}`}(e.DateTime),ShiftId:e.ShiftId,ProductLineId:e.ProductLineId,Employees:e.Employees,TempEmployee:e.TempEmployee,TotalEmployee:e.TotalEmployee,Note:e.Note,LaborVarianceDetails:Array.isArray(i)?i.map((n,c)=>({id:0,headerId:0,SAPProductionOrderId:n.SAPProductionOrderId,ProductId:n.ProductId,StartDateTime:n.StartDateTime?r(n.StartDateTime):null,EndDateTime:n.EndDateTime?r(n.EndDateTime):null,LateStartReason:n.LateStartReason,ChangeOverTime:Number(n.ChangeOverTime),ActualBottleProduced:Number(n.ActualBottleProduced),TotalRunTImeMins:Number(n.TotalRunTImeMins),ShiftComments:n.ShiftComments,DownTimeMins:Number(n.DownTimeMins),DownTImeComments:n.DownTImeComments,HC:n.HC,CaseAttainment:Number(n.CaseAttainment),CaseTarget:Number(n.CaseTarget),Percentage:Number(n.Percentage),BottleTarget:Number(n.BottleTarget),ShiftIndex:n.ShiftIndex,Criteria:n.Criteria,MissingFGItems:Number(n.MissingFGItems),NonProductionTime:Number(n.NonProductionTime),AdditionalComments:n.AdditionalComments,TimePerPerson:Number(n.TimePerPerson),TotalMins:Number(n.TotalMins),Description:n.Description})):[]}}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(h.nX),t.rXU(h.Ix),t.rXU(m.ze),t.rXU(k),t.rXU(f.tw),t.rXU(z.Q),t.rXU(b.n),t.rXU(Q.q))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-add-edit"]],decls:134,vars:30,consts:[["form","ngForm"],["pickerStart",""],["Starttimepicker",""],["Endtimepicker",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button back-Green",3,"click",4,"ngIf"],["novalidate","",1,"app-form",3,"submit","formGroup"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","mb-3"],["appearance","fill",1,"full-width"],["matInput","","formControlName","DateTime",3,"matDatepicker","max"],["matSuffix","",3,"for"],[3,"control","message","formSubmitted"],["formControlName","ShiftId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","ProductLineId"],["matInput","","formControlName","Employees","type","number"],["matInput","","formControlName","TempEmployee","type","number"],["matInput","","formControlName","TotalEmployee","type","number","readonly",""],[1,"col-12","col-sm-12","col-md-12","col-lg-12","mb-3"],["matInput","","formControlName","Note"],[1,"card-header","d-flex","align-items-center","justify-content-between"],["formArrayName","LaborVarianceDetails"],["class","row mt-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-md-12"],[1,"table-responsive"],["id","gridLaborVarince",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner"],[1,"bg-primary","text-primary","text-center"],[1,"back-Green"],[1,"back-Green",2,"width","10%"],[1,"back-Green",2,"width","15%"],[1,"back-Green",2,"width","8%"],[4,"ngFor","ngForOf"],[1,"col-lg-12","text-center"],["type","submit","mat-flat-button","",1,"app-button","mr-1","back-Green"],["mat-flat-button","","color","primary",1,"app-button","back-Green",3,"click"],[3,"value"],[1,"row","mt-3",3,"formGroupName"],["formControlName","SAPProductionOrderId"],["formControlName","ProductId"],["matInput","","placeholder","Select time","formControlName","StartDateTime",3,"ngxTimepicker"],["matInput","","placeholder","Select time","formControlName","EndDateTime",3,"ngxTimepicker"],["matInput","","formControlName","LateStartReason"],["matInput","","formControlName","ChangeOverTime","type","number"],["matInput","","formControlName","ActualBottleProduced","type","number"],["matInput","","formControlName","TotalRunTImeMins","type","number"],["matInput","","formControlName","ShiftComments"],["matInput","","formControlName","DownTimeMins","type","number"],["matInput","","formControlName","DownTImeComments"],["matInput","","formControlName","HC","type","number","readonly",""],["matInput","","formControlName","CaseAttainment","type","number"],["matInput","","formControlName","CaseTarget","type","number"],["matInput","","formControlName","Percentage","type","number","readonly",""],["matInput","","formControlName","BottleTarget","type","number"],["matInput","","formControlName","ShiftIndex"],["matInput","","formControlName","Criteria"],["matInput","","formControlName","MissingFGItems","type","number"],["matInput","","formControlName","NonProductionTime","type","number"],["matInput","","formControlName","AdditionalComments"],["matInput","","formControlName","TimePerPerson","type","number"],["matInput","","formControlName","TotalMins","type","number"],["matInput","","formControlName","Description"],[1,"col-12","col-sm-12","col-md-2","col-lg-2","mb-3","p-1","d-flex","align-items-center"],["type","button","mat-icon-button","",1,"icon-green",3,"click"],["type","button",1,"btn","btn-success","btn-sm","btnModifyRow","back-Green",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-danger","btn-sm","btnRemoveRow","ms-1",3,"click"],[1,"fa","fa-close"]],template:function(o,r){if(1&o){const i=t.RV6();t.j41(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"h4",9),t.nrm(6,"i",10),t.EFF(7," Add/Edit Labor Variance"),t.k0s()(),t.j41(8,"div",11),t.DNE(9,rt,2,0,"a",12),t.k0s()(),t.j41(10,"form",13,0),t.bIt("submit",function(){return t.eBV(i),t.Njj(r.save())}),t.j41(12,"div",14)(13,"div",15)(14,"h5",9),t.EFF(15,"Basic Details"),t.k0s()(),t.j41(16,"div",16)(17,"div",17)(18,"div",18)(19,"mat-form-field",19)(20,"mat-label"),t.EFF(21,"Date"),t.k0s(),t.nrm(22,"input",20)(23,"mat-datepicker-toggle",21)(24,"mat-datepicker",null,1)(26,"mat-validation-message",22),t.k0s()(),t.j41(27,"div",18)(28,"mat-form-field",19)(29,"mat-label"),t.EFF(30,"Shift"),t.k0s(),t.j41(31,"mat-select",23),t.DNE(32,at,2,2,"mat-option",24),t.k0s(),t.nrm(33,"mat-validation-message",22),t.k0s()(),t.j41(34,"div",18)(35,"mat-form-field",19)(36,"mat-label"),t.EFF(37,"Product Line"),t.k0s(),t.j41(38,"mat-select",25),t.DNE(39,it,2,2,"mat-option",24),t.k0s(),t.nrm(40,"mat-validation-message",22),t.k0s()(),t.j41(41,"div",18)(42,"mat-form-field",19)(43,"mat-label"),t.EFF(44,"Employees "),t.k0s(),t.nrm(45,"input",26)(46,"mat-validation-message",22),t.k0s()(),t.j41(47,"div",18)(48,"mat-form-field",19)(49,"mat-label"),t.EFF(50,"Temporary "),t.k0s(),t.nrm(51,"input",27)(52,"mat-validation-message",22),t.k0s()(),t.j41(53,"div",18)(54,"mat-form-field",19)(55,"mat-label"),t.EFF(56,"Total"),t.k0s(),t.nrm(57,"input",28)(58,"mat-validation-message",22),t.k0s()(),t.j41(59,"div",29)(60,"mat-form-field",19)(61,"mat-label"),t.EFF(62,"Note"),t.k0s(),t.nrm(63,"textarea",30)(64,"mat-validation-message",22),t.k0s()()()()(),t.j41(65,"div",14)(66,"div",31)(67,"h5",9),t.EFF(68,"Labor Variance Details"),t.k0s()(),t.j41(69,"div",16)(70,"div",32),t.DNE(71,lt,132,5,"div",33),t.k0s()()(),t.j41(72,"div",17)(73,"div",34)(74,"div",35)(75,"table",36)(76,"thead",37)(77,"tr")(78,"th",38),t.EFF(79,"PO No"),t.k0s(),t.j41(80,"th",38),t.EFF(81,"Item no"),t.k0s(),t.j41(82,"th",39),t.EFF(83,"Start Time"),t.k0s(),t.j41(84,"th",39),t.EFF(85,"End Time"),t.k0s(),t.j41(86,"th",40),t.EFF(87,"Late Start Reason"),t.k0s(),t.j41(88,"th",39),t.EFF(89,"Change Over Time"),t.k0s(),t.j41(90,"th",38),t.EFF(91,"Actual Bottle Produced"),t.k0s(),t.j41(92,"th",38),t.EFF(93,"Total Run Time (Mins)"),t.k0s(),t.j41(94,"th",38),t.EFF(95,"Shift Comments"),t.k0s(),t.j41(96,"th",38),t.EFF(97,"Down Time (Mins)"),t.k0s(),t.j41(98,"th",38),t.EFF(99,"DT Comments"),t.k0s(),t.j41(100,"th",38),t.EFF(101,"HC"),t.k0s(),t.j41(102,"th",38),t.EFF(103,"Case Attainment"),t.k0s(),t.j41(104,"th",38),t.EFF(105,"Case Target"),t.k0s(),t.j41(106,"th",38),t.EFF(107,"%"),t.k0s(),t.j41(108,"th",38),t.EFF(109,"Bottle Target"),t.k0s(),t.j41(110,"th",38),t.EFF(111,"Shift Index"),t.k0s(),t.j41(112,"th",38),t.EFF(113,"Criteria"),t.k0s(),t.j41(114,"th",38),t.EFF(115,"Missing FG Items"),t.k0s(),t.j41(116,"th",38),t.EFF(117,"Non Production Time"),t.k0s(),t.j41(118,"th",38),t.EFF(119,"Additional Comments"),t.k0s(),t.j41(120,"th",38),t.EFF(121,"Time Per Person"),t.k0s(),t.j41(122,"th",38),t.EFF(123,"Total Mins"),t.k0s(),t.j41(124,"th",38),t.EFF(125,"Description"),t.k0s(),t.j41(126,"th",41),t.EFF(127,"Action"),t.k0s()()(),t.j41(128,"tbody"),t.DNE(129,mt,54,24,"tr",42),t.k0s()()()()(),t.j41(130,"div",17)(131,"div",43)(132,"button",44),t.EFF(133,"Save"),t.k0s()()()()()()()}if(2&o){const i=t.sdS(25);t.R7$(9),t.Y8G("ngIf",r.IsViewPermission),t.R7$(),t.Y8G("formGroup",r.laborVarianceForm),t.R7$(12),t.Y8G("matDatepicker",i)("max",r.getToday()),t.R7$(),t.Y8G("for",i),t.R7$(3),t.Y8G("control",r.laborVarianceForm.controls.DateTime)("message","Date Time")("formSubmitted",r.isFormSubmitted),t.R7$(6),t.Y8G("ngForOf",r.shiftList),t.R7$(),t.Y8G("control",r.laborVarianceForm.controls.ShiftId)("message","Shift")("formSubmitted",r.isFormSubmitted),t.R7$(6),t.Y8G("ngForOf",r.fillingLineList),t.R7$(),t.Y8G("control",r.laborVarianceForm.controls.ProductLineId)("message","Product Line")("formSubmitted",r.isFormSubmitted),t.R7$(6),t.Y8G("control",r.laborVarianceForm.controls.Employees)("message","Employees")("formSubmitted",r.isFormSubmitted),t.R7$(6),t.Y8G("control",r.laborVarianceForm.controls.TempEmployee)("message","Temp Employee")("formSubmitted",r.isFormSubmitted),t.R7$(6),t.Y8G("control",r.laborVarianceForm.controls.TotalEmployee)("message","Total Employee")("formSubmitted",r.isFormSubmitted),t.R7$(6),t.Y8G("control",r.laborVarianceForm.controls.Note)("message","Note")("formSubmitted",r.isFormSubmitted),t.R7$(7),t.Y8G("ngForOf",null==r.LaborVarianceDetails?null:r.LaborVarianceDetails.controls),t.R7$(58),t.Y8G("ngForOf",r.AddedlaborVarianceDetailsList)}},dependencies:[u.Sq,u.bT,m.qT,m.me,m.Q0,m.BC,m.cb,m.j4,m.JD,m.$R,m.v8,C.It,C.$z,C.iY,L.rl,L.nJ,L.yw,Z.fg,N.An,q.VO,tt.wT,S.Vh,S.bZ,S.bU,et.T,ot.r,P.zk,P.v2],styles:[".card[_ngcontent-%COMP%]{margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:.75rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.full-width[_ngcontent-%COMP%]{width:100%}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.card-header[_ngcontent-%COMP%]{background-color:#17bb58!important;border-bottom:1px solid rgb(23,187,88)!important;padding:.75rem 1.25rem;color:#fff}.back-Green[_ngcontent-%COMP%]{background-color:#17bb58!important;color:#fff!important}.icon-green[_ngcontent-%COMP%]{color:green}"]})}return a})();s(9239);const ut=[{path:"",component:(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-labor-variance"]],decls:1,vars:0,template:function(o,r){1&o&&t.nrm(0,"router-outlet")},dependencies:[h.n3]})}return a})(),children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:_,canActivate:[V.L],data:{permission:"Production Order (PER_PURCHASEORDER) - View"}},{path:"add",canActivate:[V.L],data:{permission:"Production Order (PER_PURCHASEORDER) - View"},component:I},{path:"edit/:id",canActivate:[V.L],data:{permission:"Production Order (PER_PURCHASEORDER) - View"},component:I}]}];let ht=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275mod=t.$C({type:a});static#o=this.\u0275inj=t.G2t({imports:[h.iI.forChild(ut),h.iI]})}return a})();var pt=s(1774),ft=s(9830);let bt=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#e=this.\u0275mod=t.$C({type:a});static#o=this.\u0275inj=t.G2t({providers:[k,(0,ft._c)()],imports:[u.MD,ht,pt.Gg,P.c9]})}return a})()}}]);