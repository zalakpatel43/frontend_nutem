"use strict";(self.webpackChunkskyward_admin=self.webpackChunkskyward_admin||[]).push([[663],{37663:(X,y,i)=>{i.r(y),i.d(y,{CompanyModule:()=>V});var g=i(71774),c=i(18498),m=i(4434),s=i(89417),E=i(80775),D=i(52495),t=i(54438);let u=(()=>{class n extends m.QP{constructor(e){super(e,"company"),this._baseService=e}static#t=this.\u0275fac=function(a){return new(a||n)(t.KVO(m.dD))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}return n})();var v=i(45794),h=i(88834),C=i(32102),j=i(99631),b=i(30220),I=i(58777),N=i(67133),A=i(71893);function L(n,d){if(1&n){const e=t.RV6();t.j41(0,"a",37),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.cancel())}),t.EFF(1," View List "),t.k0s()}}let f=(()=>{class n{constructor(e,a,o,r,l){this.activatedRoute=e,this.router=a,this.formBuilder=o,this.companyService=r,this.notificationService=l,this.page=m.Wt.company,this.permissions=m.eZ,this.fileOptions={maxAllowedFile:1,completeCallback:this.uploadCompleted.bind(this),onWhenAddingFileFailed:this.uploadFailed.bind(this)},this.fileUploader=new m.o7(this.fileOptions),this.createForm()}ngOnInit(){this.getCompanyRoute()}getCompanyRoute(){this.routerSub=this.activatedRoute.params.subscribe(e=>{this.isEditMode=!m.ov.isEmpty(e.id),this.createForm(),this.isEditMode?(this.companyId=+e.id,this.getCompanyDetails()):this.companyData=new E.CC})}getCompanyDetails(){this.companyService.getById(this.companyId).subscribe(e=>{this.companyData=e,this.setCompanyData()},e=>{console.log(e)})}setCompanyData(){this.frmCompany.patchValue(this.companyData)}createForm(){this.frmCompany=this.formBuilder.group({companyName:["",[s.k0.required,s.k0.maxLength(100)]],alias:[""],address1:["",[s.k0.required]],address2:[""],address3:[""],pincode:["",[s.k0.required,s.k0.maxLength(10)]],city:["",[s.k0.required,s.k0.maxLength(50)]],state:["",[s.k0.required,s.k0.maxLength(50)]],country:["",[s.k0.required,s.k0.maxLength(50)]],panNo:[""],gstNo:[""],emailID:["",[s.k0.email,s.k0.maxLength(50)]],website:[""],phoneNo:["",[s.k0.maxLength(15)]],isActive:[!1],companyLogoId:[""],currency:[""]})}save(){this.isFormSubmitted=!0,!this.frmCompany.invalid&&(this.isEditMode?this.updateCompany():this.createCompany())}removeFile(e){this.companyData&&(this.companyData.companyLogoId=null,this.companyData.companyLogo=null,this.frmCompany.controls.companyLogoId.setValue(null)),this.fileUploader.uploader.clearQueue()}canHideUploader(){let e=!1;return(this.companyData&&this.companyData.companyLogoId>0||this.fileUploader.hasFile())&&(e=!0),e}createCompany(){let e=Object.assign({},this.frmCompany.value);this.companyService.add(e).subscribe(a=>{a.isSuccess?this.fileUploader.hasFile()?this.uploadDocuments(a.id):(this.cancel(),this.notificationService.success("Company saved successfully.")):this.notificationService.warning(a.message)},a=>{this.error=400===a.status&&a.error.modelState?a.error.modelState[""][0]:"Something went wrong"})}updateCompany(){let e=Object.assign(this.companyData,this.frmCompany.value);this.companyService.update(this.companyId,e).subscribe(a=>{a.isSuccess?this.fileUploader.hasFile()?this.uploadDocuments(a.id):(this.cancel(),this.notificationService.success("Company updated successfully.")):this.notificationService.warning(a.message)},a=>{this.error=400===a.status&&a.error.modelState?a.error.modelState[""][0]:"Something went wrong"})}uploadDocuments(e){this.fileUploader.uploadFiles({uploadType:D.Sq.Company,id:e.toString()})}uploadCompleted(){this.cancel(),this.notificationService.success(this.isEditMode?"Company updated successfully.":"Company saved successfully.")}uploadFailed(){this.notificationService.warning("You are only allowed to upload jpg/jpeg/png/pdf/doc files.")}onSelectFile(e){}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(a){return new(a||n)(t.rXU(c.nX),t.rXU(c.Ix),t.rXU(s.ze),t.rXU(u),t.rXU(v.tw))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["ng-component"]],decls:114,vars:37,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"click",4,"authPermission"],["novalidate","",3,"ngSubmit","formGroup"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-6"],["matInput","","formControlName","companyName"],[3,"control","message","formSubmitted"],["matInput","","formControlName","alias"],[1,"col-md-4"],["matInput","","formControlName","address1"],["matInput","","formControlName","address2"],["matInput","","formControlName","address3"],["type","text","matInput","","formControlName","pincode"],["type","text","matInput","","formControlName","city"],["type","text","matInput","","formControlName","state"],["type","text","matInput","","formControlName","country"],["type","text","matInput","","formControlName","panNo"],["type","text","matInput","","formControlName","gstNo"],["type","email","matInput","","formControlName","emailID"],["type","url","matInput","","formControlName","website"],["type","tel","matInput","","formControlName","phoneNo"],["type","hidden","formControlName","companyLogoId"],[3,"removeDocument","selectedFile","documents","isEditMode","uploader","label","hideUploader"],[1,"row","mt-3"],[1,"col-md-12","text-right"],["type","submit","mat-flat-button","","color","primary",1,"app-button","mr-5"],["type","button","mat-flat-button","","color","primary",1,"app-button",3,"click"],["mat-flat-button","","color","primary",1,"app-button",3,"click"]],template:function(a,o){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.nrm(6,"i",6),t.EFF(7," Add/Edit Company Details"),t.k0s()(),t.j41(8,"div",7),t.DNE(9,L,2,0,"a",8),t.k0s()(),t.j41(10,"div")(11,"form",9),t.bIt("ngSubmit",function(){return o.save()}),t.j41(12,"div",10)(13,"div",11)(14,"h5",5),t.EFF(15,"Basic Details"),t.k0s()(),t.j41(16,"div",12)(17,"div",13)(18,"div",14)(19,"mat-form-field")(20,"mat-label"),t.EFF(21,"Company Name *"),t.k0s(),t.nrm(22,"input",15)(23,"mat-validation-message",16),t.k0s()(),t.j41(24,"div",14)(25,"mat-form-field")(26,"mat-label"),t.EFF(27,"Alias"),t.k0s(),t.nrm(28,"input",17),t.k0s()()(),t.j41(29,"div",13)(30,"div",18)(31,"mat-form-field")(32,"mat-label"),t.EFF(33,"Address Line 1"),t.k0s(),t.nrm(34,"input",19)(35,"mat-validation-message",16),t.k0s()(),t.j41(36,"div",18)(37,"mat-form-field")(38,"mat-label"),t.EFF(39,"Address Line 2"),t.k0s(),t.nrm(40,"input",20),t.k0s()(),t.j41(41,"div",18)(42,"mat-form-field")(43,"mat-label"),t.EFF(44,"Address Line 3"),t.k0s(),t.nrm(45,"input",21),t.k0s()()(),t.j41(46,"div",13)(47,"div",18)(48,"mat-form-field")(49,"mat-label"),t.EFF(50,"Pincode"),t.k0s(),t.nrm(51,"input",22)(52,"mat-validation-message",16),t.k0s()(),t.j41(53,"div",18)(54,"mat-form-field")(55,"mat-label"),t.EFF(56,"City"),t.k0s(),t.nrm(57,"input",23)(58,"mat-validation-message",16),t.k0s()(),t.j41(59,"div",18)(60,"mat-form-field")(61,"mat-label"),t.EFF(62,"State"),t.k0s(),t.nrm(63,"input",24)(64,"mat-validation-message",16),t.k0s()()(),t.j41(65,"div",13)(66,"div",18)(67,"mat-form-field")(68,"mat-label"),t.EFF(69,"Country"),t.k0s(),t.nrm(70,"input",25)(71,"mat-validation-message",16),t.k0s()(),t.j41(72,"div",18)(73,"mat-form-field")(74,"mat-label"),t.EFF(75,"PAN No"),t.k0s(),t.nrm(76,"input",26)(77,"mat-validation-message",16),t.k0s()(),t.j41(78,"div",18)(79,"mat-form-field")(80,"mat-label"),t.EFF(81,"GST No"),t.k0s(),t.nrm(82,"input",27)(83,"mat-validation-message",16),t.k0s()()(),t.j41(84,"div",13)(85,"div",18)(86,"mat-form-field")(87,"mat-label"),t.EFF(88,"Email ID"),t.k0s(),t.nrm(89,"input",28)(90,"mat-validation-message",16),t.k0s()(),t.j41(91,"div",18)(92,"mat-form-field")(93,"mat-label"),t.EFF(94,"Website"),t.k0s(),t.nrm(95,"input",29),t.k0s()(),t.j41(96,"div",18)(97,"mat-form-field")(98,"mat-label"),t.EFF(99,"Phone Number"),t.k0s(),t.nrm(100,"input",30)(101,"mat-validation-message",16),t.k0s()()(),t.j41(102,"div",13)(103,"div",18)(104,"label"),t.EFF(105,"Company Logo"),t.k0s(),t.nrm(106,"input",31),t.j41(107,"file-uploader",32),t.bIt("removeDocument",function(l){return o.removeFile(l)})("selectedFile",function(l){return o.onSelectFile(l)}),t.k0s()()()()(),t.j41(108,"div",33)(109,"div",34)(110,"button",35),t.EFF(111,"Save"),t.k0s(),t.j41(112,"button",36),t.bIt("click",function(){return o.cancel()}),t.EFF(113,"Cancel"),t.k0s()()()()()()()()),2&a&&(t.R7$(9),t.Y8G("authPermission",o.page+"_"+o.permissions.list),t.R7$(2),t.Y8G("formGroup",o.frmCompany),t.R7$(12),t.Y8G("control",o.frmCompany.controls.companyName)("message","Company Name")("formSubmitted",o.isFormSubmitted),t.R7$(12),t.Y8G("control",o.frmCompany.controls.address1)("message","Address Line 1")("formSubmitted",o.isFormSubmitted),t.R7$(17),t.Y8G("control",o.frmCompany.controls.pincode)("message","Pincode")("formSubmitted",o.isFormSubmitted),t.R7$(6),t.Y8G("control",o.frmCompany.controls.city)("message","City")("formSubmitted",o.isFormSubmitted),t.R7$(6),t.Y8G("control",o.frmCompany.controls.state)("message","State")("formSubmitted",o.isFormSubmitted),t.R7$(7),t.Y8G("control",o.frmCompany.controls.country)("message","Country")("formSubmitted",o.isFormSubmitted),t.R7$(6),t.Y8G("control",o.frmCompany.controls.panNo)("message","PAN No")("formSubmitted",o.isFormSubmitted),t.R7$(6),t.Y8G("control",o.frmCompany.controls.gstNo)("message","GST No")("formSubmitted",o.isFormSubmitted),t.R7$(7),t.Y8G("control",o.frmCompany.controls.emailID)("message","Email ID")("formSubmitted",o.isFormSubmitted),t.R7$(11),t.Y8G("control",o.frmCompany.controls.phoneNo)("message","Phone Number")("formSubmitted",o.isFormSubmitted),t.R7$(6),t.Y8G("documents",null==o.companyData?null:o.companyData.companyLogo)("isEditMode",o.isEditMode)("uploader",null==o.fileUploader?null:o.fileUploader.uploader)("label","")("hideUploader",o.canHideUploader()))},dependencies:[s.qT,s.me,s.BC,s.cb,s.j4,s.JD,h.It,h.$z,C.rl,C.nJ,j.fg,b.B,I.T,N.r,A.A],encapsulation:2})}return n})();var w=i(99213),p=i(33380),G=i(30932),T=i(49239),R=i(74193);let F=(()=>{class n{constructor(){this.searchChanged=new t.bkB,this.searchData=[],this.searchKey="companyName,alias,address1,pincode,city,state,country,emailID,phoneNo"}updateSearchTerms(e,a){this.searchData.isActive=this.searchInactive.searchBox.value,this.searchData[e]=a,this.searchChanged.emit(this.searchData)}static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["company-search-panel"]],viewQuery:function(a,o){if(1&a&&t.GBs(g.$A,5),2&a){let r;t.mGM(r=t.lsd())&&(o.searchInactive=r.first)}},outputs:{searchChanged:"searchChanged"},decls:5,vars:1,consts:[[1,"row"],[1,"col-lg-6"],[3,"textSearchEntered","placeHolder"],[1,"col-lg-4"],[3,"chkChanged"]],template:function(a,o){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"search-text",2),t.bIt("textSearchEntered",function(l){return o.updateSearchTerms(o.searchKey,l)}),t.k0s()(),t.j41(3,"div",3)(4,"search-inactive",4),t.bIt("chkChanged",function(l){return o.updateSearchTerms("isActive",l)}),t.k0s()()()),2&a&&(t.R7$(2),t.Y8G("placeHolder","Search Company"))},dependencies:[T.D,R.$],encapsulation:2})}return n})();const _=()=>({emptyMessage:"No Companies Found",totalMessage:"Total"}),U=()=>["../","add"],$=n=>["../","edit",n];function Y(n,d){1&n&&(t.j41(0,"a",21)(1,"span"),t.EFF(2,"Add New"),t.k0s(),t.nrm(3,"i",22),t.k0s()),2&n&&t.Y8G("routerLink",t.lJ4(1,U))}function P(n,d){1&n&&t.EFF(0),2&n&&t.SpI(" ",d.row.isActive?"Active":"Inactive"," ")}function M(n,d){if(1&n&&(t.j41(0,"a",25)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&n){const e=t.XpG().row;t.Y8G("routerLink",t.eq3(1,$,e.id))}}function B(n,d){if(1&n){const e=t.RV6();t.DNE(0,M,3,3,"a",23),t.j41(1,"a",24),t.bIt("click",function(){const o=t.eBV(e).row,r=t.XpG();return t.Njj(r.toggleActivate(o.id,!o.isActive))}),t.j41(2,"mat-icon"),t.EFF(3),t.k0s()()}if(2&n){const e=d.row;t.Y8G("authPermission","company_edit"),t.R7$(),t.FS9("title",e.isActive?"Deactivate":"Activate"),t.R7$(2),t.JRh(e.isActive?"lock":"lock_open")}}let S=(()=>{class n{constructor(e,a){this.companyService=e,this.notificationService=a,this.companyData=[],this.page=m.Wt.company,this.permissions=m.eZ,this.searchData={isActive:!1}}ngOnInit(){this.getCompanyData()}getCompanyData(){this.loading=!0,this.companyService.get().subscribe(e=>{this.loading=!1,this.companyData=e},e=>{this.loading=!1,console.log(e)})}toggleActivate(e,a){confirm(`Are you sure you want to ${a?"Activate":"Deactivate"} this company?`)&&this.companyService.toggleActivate(e,a).subscribe(r=>{r.isSuccess?this.getCompanyData():this.notificationService.warning(r.message)},r=>{this.notificationService.error("Something went wrong.")})}updateSearch(e){this.searchData=Object.assign({},e)}isActiveRow(e){return{"text-danger":!e.isActive}}static#t=this.\u0275fac=function(a){return new(a||n)(t.rXU(u),t.rXU(v.tw))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["ng-component"]],decls:24,vars:11,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","color","primary","class","app-button",3,"routerLink",4,"authPermission"],[1,"row"],[1,"col-12"],[3,"searchChanged"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","Company Name","prop","companyName"],["name","Alias","prop","alias"],["name","City","prop","city"],["name","State","prop","state"],["name","Country","prop","country"],["name","Email","prop","emailID"],["name","Status"],["ngx-datatable-cell-template",""],["name","Actions"],["mat-flat-button","","color","primary",1,"app-button",3,"routerLink"],[1,"icon-plus"],["title","Edit","class","button-padding",3,"routerLink",4,"authPermission"],["href","#",1,"button-padding",3,"click","title"],["title","Edit",1,"button-padding",3,"routerLink"]],template:function(a,o){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Company List"),t.k0s()(),t.j41(7,"div",6)(8,"div"),t.DNE(9,Y,4,2,"a",7),t.k0s()()(),t.j41(10,"div",8)(11,"div",9)(12,"company-search-panel",10),t.bIt("searchChanged",function(l){return o.updateSearch(l)}),t.k0s(),t.j41(13,"ngx-datatable",11),t.nrm(14,"ngx-datatable-column",12)(15,"ngx-datatable-column",13)(16,"ngx-datatable-column",14)(17,"ngx-datatable-column",15)(18,"ngx-datatable-column",16)(19,"ngx-datatable-column",17),t.j41(20,"ngx-datatable-column",18),t.DNE(21,P,1,1,"ng-template",19),t.k0s(),t.j41(22,"ngx-datatable-column",20),t.DNE(23,B,4,3,"ng-template",19),t.k0s()()()()()()()),2&a&&(t.R7$(9),t.Y8G("authPermission","company_create"),t.R7$(4),t.Y8G("rows",o.companyData)("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",o.loading)("scrollbarH",!0)("messages",t.lJ4(10,_)))},dependencies:[h.It,w.An,c.Wk,p.ge,p.ed,p.QI,G.a,b.B,F],encapsulation:2})}return n})();const H=[{path:"",component:(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(a,o){1&a&&t.nrm(0,"router-outlet")},dependencies:[c.n3],encapsulation:2})}return n})(),children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",canActivate:[m.LL],component:S,data:{page:m.Wt.company,action:m.eZ.list,title:"Company"}},{path:"add",canActivate:[m.LL],data:{page:m.Wt.company,action:m.eZ.create,title:"Company"},component:f},{path:"edit/:id",canActivate:[m.LL],data:{page:m.Wt.company,action:m.eZ.edit,title:"Company"},component:f}]}];let x=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.$C({type:n});static#a=this.\u0275inj=t.G2t({imports:[c.iI.forChild(H),c.iI]})}return n})(),V=(()=>{class n{static#t=this.\u0275fac=function(a){return new(a||n)};static#e=this.\u0275mod=t.$C({type:n});static#a=this.\u0275inj=t.G2t({providers:[u],imports:[g.Gg,p.Kj,x]})}return n})()}}]);