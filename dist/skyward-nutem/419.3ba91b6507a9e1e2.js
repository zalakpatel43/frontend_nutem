"use strict";(self.webpackChunkskyward_admin=self.webpackChunkskyward_admin||[]).push([[419],{22419:(Q,g,l)=>{l.r(g),l.d(g,{PermissionsModule:()=>z});var u=l(18498),e=l(54438);let f=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#s=this.\u0275cmp=e.VBU({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,n){1&i&&e.nrm(0,"router-outlet")},dependencies:[u.n3],encapsulation:2})}return t})();var _=l(2558),h=l(4434),M=l(45794),c=l(89417),y=l(3132),p=l(60177),d=l(49969);const A="400ms cubic-bezier(0.4,0.0,0.2,1)",O=[(0,d.iF)({height:0,visibility:"hidden"}),(0,d.i0)(A,(0,d.iF)({height:"*",visibility:"visible"}))],E=[(0,d.iF)({height:"*",visibility:"visible"}),(0,d.i0)(A,(0,d.iF)({height:0,visibility:"hidden"}))];let P=(()=>{class t{constructor(s,i,n){this._el=s,this._renderer=i,this.collapsed=new e.bkB,this.collapses=new e.bkB,this.expanded=new e.bkB,this.expands=new e.bkB,this.isExpanded=!0,this.collapseNewValue=!0,this.isCollapsed=!1,this.isCollapse=!0,this.isCollapsing=!1,this.isAnimated=!1,this._display="block",this._stylesLoaded=!1,this._COLLAPSE_ACTION_NAME="collapse",this._EXPAND_ACTION_NAME="expand",this._factoryCollapseAnimation=n.build(E),this._factoryExpandAnimation=n.build(O)}set display(s){this._display=s,"none"!==s?this.isAnimated?this.toggle():this.show():this.hide()}set collapse(s){this.collapseNewValue=s,(!this._player||this._isAnimationDone)&&(this.isExpanded=s,this.toggle())}get collapse(){return this.isExpanded}ngAfterViewChecked(){this._stylesLoaded=!0,this._player&&this._isAnimationDone&&(this._player.reset(),this._renderer.setStyle(this._el.nativeElement,"height","*"))}toggle(){this.isExpanded?this.hide():this.show()}hide(){this.isCollapsing=!0,this.isExpanded=!1,this.isCollapsed=!0,this.isCollapsing=!1,this.collapses.emit(this),this._isAnimationDone=!1,this.animationRun(this.isAnimated,this._COLLAPSE_ACTION_NAME)(()=>{this._isAnimationDone=!0,this.collapseNewValue!==this.isCollapsed&&this.isAnimated?this.show():(this.collapsed.emit(this),this._renderer.setStyle(this._el.nativeElement,"display","none"))})}show(){this._renderer.setStyle(this._el.nativeElement,"display",this._display),this.isCollapsing=!0,this.isExpanded=!0,this.isCollapsed=!1,this.isCollapsing=!1,this.expands.emit(this),this._isAnimationDone=!1,this.animationRun(this.isAnimated,this._EXPAND_ACTION_NAME)(()=>{this._isAnimationDone=!0,this.collapseNewValue!==this.isCollapsed&&this.isAnimated?this.hide():(this.expanded.emit(this),this._renderer.removeStyle(this._el.nativeElement,"overflow"))})}animationRun(s,i){if(!s||!this._stylesLoaded)return o=>o();this._renderer.setStyle(this._el.nativeElement,"overflow","hidden"),this._renderer.addClass(this._el.nativeElement,"collapse");const n=i===this._EXPAND_ACTION_NAME?this._factoryExpandAnimation:this._factoryCollapseAnimation;return this._player&&this._player.destroy(),this._player=n.create(this._el.nativeElement),this._player.play(),o=>this._player?.onDone(o)}}return t.\u0275fac=function(s){return new(s||t)(e.rXU(e.aKT),e.rXU(e.sFG),e.rXU(d.S6))},t.\u0275dir=e.FsC({type:t,selectors:[["","collapse",""]],hostVars:9,hostBindings:function(s,i){2&s&&(e.BMQ("aria-hidden",i.isCollapsed),e.AVh("collapse",i.isCollapse)("in",i.isExpanded)("show",i.isExpanded)("collapsing",i.isCollapsing))},inputs:{display:"display",isAnimated:"isAnimated",collapse:"collapse"},outputs:{collapsed:"collapsed",collapses:"collapses",expanded:"expanded",expands:"expands"},exportAs:["bs-collapse"]}),t})(),D=(()=>{class t{static forRoot(){return{ngModule:t,providers:[]}}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({}),t})();const F=["*"],k=[[["","accordion-heading",""]],"*"],x=["[accordion-heading]","*"],j=t=>({"text-muted":t});function R(t,a){if(1&t&&(e.j41(0,"button",7),e.EFF(1),e.k0s()),2&t){const s=e.XpG();e.Y8G("ngClass",e.eq3(2,j,s.isDisabled)),e.R7$(),e.SpI(" ",s.heading," ")}}let G=(()=>{class t{constructor(){this.closeOthers=!1,this.isAnimated=!1}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),C=(()=>{class t{constructor(s){this.isAnimated=!1,this.closeOthers=!1,this.groups=[],Object.assign(this,s)}closeOtherPanels(s){this.closeOthers&&this.groups.forEach(i=>{i!==s&&(i.isOpen=!1)})}addGroup(s){s.isAnimated=this.isAnimated,this.groups.push(s)}removeGroup(s){const i=this.groups.indexOf(s);-1!==i&&this.groups.splice(i,1)}}return t.\u0275fac=function(s){return new(s||t)(e.rXU(G))},t.\u0275cmp=e.VBU({type:t,selectors:[["accordion"]],hostAttrs:["role","tablist",1,"panel-group",2,"display","block"],hostVars:1,hostBindings:function(s,i){2&s&&e.BMQ("aria-multiselectable",i.closeOthers)},inputs:{isAnimated:"isAnimated",closeOthers:"closeOthers"},ngContentSelectors:F,decls:1,vars:0,template:function(s,i){1&s&&(e.NAR(),e.SdG(0))},encapsulation:2}),t})(),N=(()=>{class t{constructor(s){this.isAnimated=!1,this.panelClass="panel-default",this.isDisabled=!1,this.isOpenChange=new e.bkB,this._isOpen=!1,this.accordion=s}get isOpen(){return this._isOpen}set isOpen(s){s!==this.isOpen&&(s&&this.accordion.closeOtherPanels(this),this._isOpen=s,Promise.resolve(null).then(()=>{this.isOpenChange.emit(s)}))}get isBs3(){return(0,y.$w)()}ngOnInit(){this.accordion.addGroup(this)}ngOnDestroy(){this.accordion.removeGroup(this)}toggleOpen(){this.isDisabled||(this.isOpen=!this.isOpen)}}return t.\u0275fac=function(s){return new(s||t)(e.rXU(C))},t.\u0275cmp=e.VBU({type:t,selectors:[["accordion-group"],["accordion-panel"]],hostAttrs:[1,"panel",2,"display","block"],hostVars:2,hostBindings:function(s,i){2&s&&e.AVh("panel-open",i.isOpen)},inputs:{heading:"heading",panelClass:"panelClass",isDisabled:"isDisabled",isOpen:"isOpen"},outputs:{isOpenChange:"isOpenChange"},ngContentSelectors:x,decls:9,vars:6,consts:[[1,"panel","card",3,"ngClass"],["role","tab",1,"panel-heading","card-header",3,"click","ngClass"],[1,"panel-title"],["role","button",1,"accordion-toggle"],["class","btn btn-link","type","button",3,"ngClass",4,"ngIf"],["role","tabpanel",1,"panel-collapse","collapse",3,"collapse","isAnimated"],[1,"panel-body","card-block","card-body"],["type","button",1,"btn","btn-link",3,"ngClass"]],template:function(s,i){1&s&&(e.NAR(k),e.j41(0,"div",0)(1,"div",1),e.bIt("click",function(){return i.toggleOpen()}),e.j41(2,"div",2)(3,"div",3),e.DNE(4,R,2,4,"button",4),e.SdG(5),e.k0s()()(),e.j41(6,"div",5)(7,"div",6),e.SdG(8,1),e.k0s()()()),2&s&&(e.Y8G("ngClass",i.panelClass),e.R7$(),e.Y8G("ngClass",i.isDisabled?"panel-disabled":"panel-enabled"),e.R7$(2),e.BMQ("aria-expanded",i.isOpen),e.R7$(),e.Y8G("ngIf",i.heading),e.R7$(2),e.Y8G("collapse",!i.isOpen)("isAnimated",i.isAnimated))},dependencies:[p.YU,p.bT,P],styles:["[_nghost-%COMP%]   .card-header.panel-enabled[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .card-header.panel-disabled[_ngcontent-%COMP%]   .btn.btn-link[_ngcontent-%COMP%]{cursor:default;text-decoration:none}"]}),t})(),T=(()=>{class t{static forRoot(){return{ngModule:t,providers:[]}}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[[p.MD,D]]}),t})();var I=l(88834),v=l(32102),B=l(82798),S=l(86600),w=l(58777);const V=(t,a)=>({"fa-arrow-up":t,"fa-arrow-down":a}),m=()=>({standalone:!0});function $(t,a){if(1&t&&(e.j41(0,"mat-option",16),e.EFF(1),e.k0s()),2&t){const s=a.$implicit;e.Y8G("value",s.id),e.R7$(),e.SpI(" ",s.name," ")}}function Y(t,a){if(1&t){const s=e.RV6();e.j41(0,"div",9)(1,"div",31),e.EFF(2),e.k0s(),e.j41(3,"div",32)(4,"div",23)(5,"label",24)(6,"input",33),e.mxI("ngModelChange",function(n){const o=e.eBV(s).$implicit;return e.DH7(o.hasAccess,n)||(o.hasAccess=n),e.Njj(n)}),e.k0s(),e.EFF(7," Access "),e.nrm(8,"span"),e.k0s(),e.j41(9,"label",34)(10,"input",35),e.mxI("ngModelChange",function(n){const o=e.eBV(s).$implicit;return e.DH7(o.hasMasterAccess,n)||(o.hasMasterAccess=n),e.Njj(n)}),e.bIt("change",function(){const n=e.eBV(s).$implicit,o=e.XpG(3);return e.Njj(o.masterChanged(n))}),e.k0s(),e.EFF(11," All Master Access "),e.nrm(12,"span"),e.k0s()()()()}if(2&t){const s=a.$implicit;e.R7$(2),e.SpI(" ",s.name," "),e.R7$(4),e.Y8G("name","access"+s.id)("ngModelOptions",e.lJ4(7,m)),e.R50("ngModel",s.hasAccess),e.R7$(4),e.Y8G("name","masteraccess"+s.id)("ngModelOptions",e.lJ4(8,m)),e.R50("ngModel",s.hasMasterAccess)}}function X(t,a){if(1&t&&(e.j41(0,"div",29)(1,"h5")(2,"b"),e.EFF(3),e.k0s()(),e.DNE(4,Y,13,9,"div",30),e.k0s()),2&t){const s=a.$implicit;e.R7$(3),e.JRh(s.name),e.R7$(),e.Y8G("ngForOf",s.permissions)}}function U(t,a){if(1&t){const s=e.RV6();e.j41(0,"accordion-group",17,1)(2,"button",18)(3,"div",19),e.EFF(4),e.k0s(),e.j41(5,"span",20),e.nrm(6,"i",21),e.k0s()(),e.j41(7,"div",9)(8,"div",22)(9,"div",23)(10,"label",24)(11,"input",25),e.mxI("ngModelChange",function(n){const o=e.eBV(s).$implicit;return e.DH7(o.hasAllAccess,n)||(o.hasAllAccess=n),e.Njj(n)}),e.bIt("change",function(n){const o=e.eBV(s).$implicit,r=e.XpG();return e.Njj(r.chkAllAccess(o,n))}),e.k0s(),e.EFF(12," Provide Full Access "),e.nrm(13,"span"),e.k0s(),e.j41(14,"label",26)(15,"input",25),e.mxI("ngModelChange",function(n){const o=e.eBV(s).$implicit;return e.DH7(o.hasAllMasterAccess,n)||(o.hasAllMasterAccess=n),e.Njj(n)}),e.bIt("change",function(n){const o=e.eBV(s).$implicit,r=e.XpG();return e.Njj(r.chkAllMasterAccess(o,n))}),e.k0s(),e.EFF(16," All Master Access "),e.nrm(17,"span"),e.k0s()()()(),e.j41(18,"div",27),e.DNE(19,X,5,2,"div",28),e.k0s()()}if(2&t){const s=a.$implicit,i=e.sdS(1);e.Y8G("isOpen",!1),e.R7$(4),e.JRh(s.name),e.R7$(2),e.Y8G("ngClass",e.l_i(8,V,null==i?null:i.isOpen,!(null!=i&&i.isOpen))),e.R7$(5),e.R50("ngModel",s.hasAllAccess),e.Y8G("ngModelOptions",e.lJ4(11,m)),e.R7$(4),e.R50("ngModel",s.hasAllMasterAccess),e.Y8G("ngModelOptions",e.lJ4(12,m)),e.R7$(4),e.Y8G("ngForOf",s.moduleGroups)}}const L=[{path:"",component:f,children:[{path:"",redirectTo:"add-edit",pathMatch:"full"},{path:"add-edit",canActivate:[h.LL],data:{page:h.Wt.permission,action:h.eZ.edit,title:"Permissions"},component:(()=>{class t{constructor(s,i,n,o){this.roleService=s,this.listService=i,this.notificationService=n,this.formBuilder=o,this.selectedRole=0,this.createForm()}createForm(){this.frmPermission=this.formBuilder.group({roleId:[""]})}ngOnInit(){this.getRolesData()}getRolesData(){this.roleService.get().subscribe(s=>{this.roleData=s,this.roleData.length>0&&(this.frmPermission.controls.roleId.setValue(this.roleData[0].id),this.getRolePermission())},s=>{console.log(s)})}getModulePermission(){this.listService.getModulePermissionList().subscribe(s=>{this.moduleData=s})}setPermissionData(){this.moduleData.forEach(s=>{s.hasAllAccess=!1,s.hasAllMasterAccess=!1,s.moduleGroups.forEach(i=>{i.permissions=i.permissions.map(n=>(n.hasAccess=this.rolePermissionData.permissions.some(o=>o.id===n.id),n.hasMasterAccess=!!n.hasAccess&&this.rolePermissionData.permissions.find(o=>o.id===n.id).hasMasterAccess,n))})})}getRolePermission(){this.selectedRole=this.frmPermission.controls.roleId.value,this.roleService.getById(this.selectedRole).subscribe(s=>{this.rolePermissionData=s,this.setPermissionData()})}chkAllAccess(s,i){s.hasAllAccess=i.currentTarget.checked,s.moduleGroups.forEach(n=>{n.permissions=n.permissions.map(o=>(o.hasAccess=i.currentTarget.checked,o))})}chkAllMasterAccess(s,i){s.hasAllMasterAccess=i.currentTarget.checked,s.moduleGroups.forEach(n=>{n.permissions=n.permissions.map(o=>(o.hasMasterAccess=i.currentTarget.checked,o.hasAccess=o.hasMasterAccess?o.hasMasterAccess:o.hasAccess,o))})}masterChanged(s){s.hasAccess=s.hasMasterAccess?s.hasMasterAccess:s.hasAccess}save(){let s=[];this.moduleData.forEach(n=>{n.moduleGroups.forEach(o=>{o.permissions.forEach(r=>{r.hasAccess&&s.push({id:r.id,hasMasterAccess:r.hasMasterAccess})})})});let i=Object.assign({},this.rolePermissionData,{permissions:s});this.roleService.update(i.id,i).subscribe(n=>{this.notificationService.success("Saved successfully.")},n=>{this.notificationService.error("Error while saving.")})}static#e=this.\u0275fac=function(i){return new(i||t)(e.rXU(_.W),e.rXU(h.aG),e.rXU(M.tw),e.rXU(c.ze))};static#s=this.\u0275cmp=e.VBU({type:t,selectors:[["ng-component"]],decls:23,vars:3,consts:[["form","ngForm"],["myGroup",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],["novalidate","",1,"app-form",3,"formGroup"],[1,"row"],[1,"col-md-4"],["formControlName","roleId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"isOpen",4,"ngFor","ngForOf"],[1,"col-lg-12","text-center"],["type","submit","mat-flat-button","","color","primary",1,"app-button","mr-1",3,"click"],[3,"value"],[3,"isOpen"],["accordion-heading","","type","button",1,"btn","btn-link","btn-block","clearfix"],[1,"pull-left","float-left"],[1,"float-right","pull-right"],[1,"fa",3,"ngClass"],[1,"col-md-12"],[1,"m-checkbox-inline"],[1,"m-checkbox"],["type","checkbox",3,"ngModelChange","change","ngModel","ngModelOptions"],["hidden","",1,"m-checkbox"],[1,"row",2,"padding","10px"],["class","col-md-3","style","border:1px solid lightgray;border-radius: 5px;margin: 8px;padding: 10px;",4,"ngFor","ngForOf"],[1,"col-md-3",2,"border","1px solid lightgray","border-radius","5px","margin","8px","padding","10px"],["class","row",4,"ngFor","ngForOf"],[1,"col-md-5"],[1,"col-md-7"],["type","checkbox",3,"ngModelChange","name","ngModelOptions","ngModel"],[1,"m-checkbox","hidden",2,"display","none"],["type","checkbox",3,"ngModelChange","change","name","ngModelOptions","ngModel"]],template:function(i,n){if(1&i){const o=e.RV6();e.j41(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h4",7),e.EFF(6,"Permission"),e.k0s()()(),e.j41(7,"div")(8,"form",8,0)(10,"div",9)(11,"div",10)(12,"mat-form-field")(13,"mat-label"),e.EFF(14,"Role *"),e.k0s(),e.j41(15,"mat-select",11),e.bIt("selectionChange",function(){return e.eBV(o),e.Njj(n.getRolePermission())}),e.DNE(16,$,2,2,"mat-option",12),e.k0s()()()(),e.j41(17,"accordion"),e.DNE(18,U,20,13,"accordion-group",13),e.k0s(),e.j41(19,"div",9)(20,"div",14)(21,"button",15),e.bIt("click",function(){return e.eBV(o),e.Njj(n.save())}),e.EFF(22,"Save "),e.k0s()()()()()()()()}2&i&&(e.R7$(8),e.Y8G("formGroup",n.frmPermission),e.R7$(8),e.Y8G("ngForOf",n.roleData),e.R7$(2),e.Y8G("ngForOf",n.moduleData))},dependencies:[C,N,p.YU,p.Sq,c.qT,c.Zm,c.BC,c.cb,c.vS,c.j4,c.JD,I.$z,v.rl,v.nJ,B.VO,S.wT,w.T],styles:['.accordion-toggle[aria-expanded=true][_ngcontent-%COMP%]:before{content:"\\f107";font:normal normal normal 14px/1}.accordion-toggle[aria-expanded=false][_ngcontent-%COMP%]:before{content:"\\f106";font:normal normal normal 14px/1}.btn-block[_ngcontent-%COMP%]{display:block;width:100%}']})}return t})()}]}];let H=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#s=this.\u0275mod=e.$C({type:t});static#t=this.\u0275inj=e.G2t({imports:[u.iI.forChild(L),u.iI]})}return t})();var J=l(71774);let z=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#s=this.\u0275mod=e.$C({type:t});static#t=this.\u0275inj=e.G2t({providers:[_.W],imports:[T.forRoot(),J.Gg,H]})}return t})()}}]);