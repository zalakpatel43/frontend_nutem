"use strict";(self.webpackChunkskyward_admin=self.webpackChunkskyward_admin||[]).push([[25],{50025:(he,T,l)=>{l.r(T),l.d(T,{SalesOrderModule:()=>ce});var N=l(71774),h=l(18498),e=l(54438);let C=(()=>{class a{static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ng-component"]],decls:1,vars:0,template:function(r,s){1&r&&e.nrm(0,"router-outlet")},dependencies:[h.n3],encapsulation:2})}return a})();var d=l(89417),i=l(4434),y=l(80775),p=l(60177),x=l(52495);let O=(()=>{class a extends i.QP{constructor(t){super(t,"salesOrder"),this._baseService=t}generateCode(){return this._baseService.get(`${i.T6.salesOrder}/generateCode`)}getCustomerDetails(t){return this._baseService.get(`${i.T6.customer}/customerDetails/${t}`)}getProductUOMs(t){return this._baseService.get(`${i.T6.product}/productUOMs/${t}`)}getUsers(){return this._baseService.get(`${i.T6.account}`)}static#e=this.\u0275fac=function(r){return new(r||a)(e.KVO(i.dD))};static#t=this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac})}return a})();var D=l(45794),v=l(88834),_=l(32102),P=l(99631),k=l(99213),G=l(82798),R=l(86600),b=l(25084),j=l(30220),$=l(58777),V=l(67133),Y=l(71893);function w(a,n){if(1&a){const t=e.RV6();e.j41(0,"a",45),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.cancel())}),e.EFF(1," View List "),e.k0s()}}function U(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.E5c(" ",t.firstName," ",t.lastName," - ",t.email," ")}}function L(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function B(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.LHq(" ",t.location,", ",t.city,", ",t.state,", ",t.zipcode," ")}}function X(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function M(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function H(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function W(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function q(a,n){if(1&a&&(e.j41(0,"mat-option",46),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function J(a,n){if(1&a){const t=e.RV6();e.j41(0,"div",47)(1,"div",48)(2,"mat-form-field")(3,"mat-label"),e.EFF(4,"Product"),e.k0s(),e.j41(5,"mat-select",49),e.bIt("selectionChange",function(s){const o=e.eBV(t).index,u=e.XpG();return e.Njj(u.onProductChange(o,s.value))}),e.DNE(6,W,2,2,"mat-option",21),e.k0s()()(),e.j41(7,"div",50)(8,"mat-form-field")(9,"mat-label"),e.EFF(10,"UOM"),e.k0s(),e.nrm(11,"input",51),e.k0s()(),e.j41(12,"div",50)(13,"mat-form-field")(14,"mat-label"),e.EFF(15,"Qty"),e.k0s(),e.j41(16,"input",52),e.bIt("input",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.updateProductSubTotal(s))}),e.k0s()()(),e.j41(17,"div",50)(18,"mat-form-field")(19,"mat-label"),e.EFF(20,"Amount"),e.k0s(),e.j41(21,"input",53),e.bIt("input",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.updateProductSubTotal(s))}),e.k0s()()(),e.j41(22,"div",50)(23,"mat-form-field")(24,"mat-label"),e.EFF(25,"Discount Type"),e.k0s(),e.j41(26,"mat-select",54),e.bIt("selectionChange",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.updateProductSubTotal(s))}),e.DNE(27,q,2,2,"mat-option",21),e.k0s()()(),e.j41(28,"div",50)(29,"mat-form-field")(30,"mat-label"),e.EFF(31,"Discount Type Amount"),e.k0s(),e.j41(32,"input",55),e.bIt("input",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.updateProductSubTotal(s))}),e.k0s()()(),e.j41(33,"div",50)(34,"mat-form-field")(35,"mat-label"),e.EFF(36,"Discount Amount"),e.k0s(),e.nrm(37,"input",32),e.nI1(38,"number"),e.k0s()(),e.j41(39,"div",50)(40,"mat-form-field")(41,"mat-label"),e.EFF(42,"Sub Total"),e.k0s(),e.nrm(43,"input",33),e.nI1(44,"number"),e.k0s()(),e.j41(45,"div",50)(46,"mat-form-field")(47,"mat-label"),e.EFF(48,"Tax (%)"),e.k0s(),e.j41(49,"input",56),e.bIt("input",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.updateProductSubTotal(s))}),e.k0s()()(),e.j41(50,"div",50)(51,"mat-form-field")(52,"mat-label"),e.EFF(53,"Expected Delivery Date"),e.k0s(),e.nrm(54,"input",57)(55,"mat-datepicker-toggle",26)(56,"mat-datepicker",null,2),e.k0s()(),e.j41(58,"div",58)(59,"button",59),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.addProductDetail())}),e.j41(60,"mat-icon"),e.EFF(61,"add"),e.k0s()(),e.j41(62,"button",59),e.bIt("click",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.removeProductDetail(s))}),e.j41(63,"mat-icon"),e.EFF(64,"delete"),e.k0s()()(),e.nrm(65,"hr"),e.k0s()}if(2&a){const t=n.$implicit,r=n.index,s=e.sdS(57),o=e.XpG();e.Y8G("formGroupName",r),e.R7$(6),e.Y8G("ngForOf",o.products),e.R7$(21),e.Y8G("ngForOf",o.discountTypes),e.R7$(10),e.Y8G("value",e.i5U(38,7,t.get("discountAmount").value,"1.2-2")),e.R7$(6),e.Y8G("value",e.i5U(44,10,t.get("subTotal").value,"1.2-2")),e.R7$(11),e.Y8G("matDatepicker",s),e.R7$(),e.Y8G("for",s)}}function Q(a,n){if(1&a){const t=e.RV6();e.j41(0,"div",47)(1,"div",60)(2,"mat-form-field")(3,"mat-label"),e.EFF(4,"Document Name"),e.k0s(),e.nrm(5,"input",61)(6,"mat-validation-message",62),e.k0s()(),e.j41(7,"div",60),e.nrm(8,"input",63),e.j41(9,"file-uploader",64),e.bIt("removeDocument",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.removeEditFile(null==o.salesOrderData?null:o.salesOrderData.salesOrderAttachments[s]))})("selectedFile",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.selectedFile(null==o.salesOrderData?null:o.salesOrderData.salesOrderAttachments[s]))}),e.k0s()(),e.j41(10,"div",65)(11,"button",59),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.addAttachment())}),e.j41(12,"mat-icon"),e.EFF(13,"add"),e.k0s()(),e.j41(14,"button",59),e.bIt("click",function(){const s=e.eBV(t).index,o=e.XpG();return e.Njj(o.removeAttachment(s))}),e.j41(15,"mat-icon"),e.EFF(16,"delete"),e.k0s()()()()}if(2&a){const t=n.$implicit,r=n.index,s=e.XpG();e.Y8G("formGroupName",r),e.R7$(6),e.Y8G("control",t.get("documentName"))("message","Document Name")("formSubmitted",s.isFormSubmitted),e.R7$(3),e.Y8G("documents",null==s.salesOrderData||null==s.salesOrderData.salesOrderAttachments[r]?null:s.salesOrderData.salesOrderAttachments[r].picture)("isEditMode",s.isEditMode)("label","")("hideUploader",null==s.salesOrderData||null==s.salesOrderData.salesOrderAttachments[r]?null:s.salesOrderData.salesOrderAttachments[r].hideUploader)("uploader",null==s.salesOrderData||null==s.salesOrderData.salesOrderAttachments[r]||null==s.salesOrderData.salesOrderAttachments[r].uploader?null:s.salesOrderData.salesOrderAttachments[r].uploader.uploader)}}let S=(()=>{class a{constructor(t,r,s,o,u,c,m,f){this.activatedRoute=t,this.router=r,this.formBuilder=s,this.salesOrderService=o,this.notificationService=u,this.listService=c,this.authService=m,this.datePipe=f,this.page=i.Wt.salesOrder,this.permissions=i.eZ,this.uoms=[],this.uploadDocuments=[],this.uploadedCount=0,this.loggedInUserId=this.authService.getBrowserUser().id,this.createForm()}ngOnInit(){this.getSalesOrderRoute(),this.loadDropdowns(),this.isEditMode||this.generateSalesOrderCode()}createForm(){this.frmSalesOrder=this.formBuilder.group({salesOrderCode:[{value:"",disabled:!0}],revisionNo:[{value:"R00",disabled:!0}],salesPersonId:[this.loggedInUserId,[d.k0.required]],customerId:["",[d.k0.required]],customerDetailId:["",[d.k0.required]],customerPONumber:["",[d.k0.required]],date:[new Date,[d.k0.required]],salesOrderTypeId:["",[d.k0.required]],currencyId:["",[d.k0.required]],termsCondition:[""],totalProductAmount:[{value:"",disabled:!0}],discountTypeId:[""],discountTypeAmount:[""],discountAmount:[{value:"",disabled:!0}],subTotal:[{value:"",disabled:!0}],totalTaxAmount:[{value:"",disabled:!0}],totalAmount:[{value:"",disabled:!0}],salesOrderProductDetails:this.formBuilder.array([]),salesOrderAttachments:this.formBuilder.array([])}),this.frmSalesOrder.get("discountTypeId").valueChanges.subscribe(()=>{this.calculateDiscountAmount()}),this.frmSalesOrder.get("discountTypeAmount").valueChanges.subscribe(()=>{this.calculateDiscountAmount()})}get salesOrderProductDetails(){return this.frmSalesOrder.get("salesOrderProductDetails")}get salesOrderAttachments(){return this.frmSalesOrder.get("salesOrderAttachments")}getSalesOrderRoute(){this.routerSub=this.activatedRoute.params.subscribe(t=>{this.isEditMode=!i.ov.isEmpty(t.id),this.isEditMode&&(this.salesOrderId=+t.id,this.getSalesOrderDetails())})}getSalesOrderDetails(){this.salesOrderService.getById(this.salesOrderId).subscribe(t=>{this.salesOrderData=t,i.ov.isNotEmpty(this.salesOrderData.salesOrderAttachments)&&this.salesOrderData.salesOrderAttachments.forEach(r=>{r.hideUploader=r.pictureId>0,r.uniqueId=i.ov.generateUUID(),r.uploader=new i.o7({maxAllowedFile:1,completeCallback:this.uploadCompleted.bind(this,r),onWhenAddingFileFailed:this.uploadFailed.bind(this)})}),this.setSalesOrderData(t),this.updateRevisionNo()},t=>{this.error=t})}setSalesOrderData(t){this.frmSalesOrder.patchValue(t),this.onCustomerChange(t.customerId),t.salesOrderProductDetails&&t.salesOrderProductDetails.forEach((r,s)=>{this.addProductDetail(r),s===t.salesOrderProductDetails.length-1&&this.calculateTotalProductAmount()}),t.salesOrderAttachments.forEach(r=>this.addAttachment(r))}addProductDetail(t){this.salesOrderProductDetails.push(this.formBuilder.group({productId:[t?t.productId:"",[d.k0.required]],uomId:[t?t.uomId:"",[d.k0.required]],uomName:[{value:t?t.uomName:"",disabled:!0}],qty:[t?t.qty:"",[d.k0.required]],amount:[t?t.amount:"",[d.k0.required]],discountTypeId:[t?t.discountTypeId:""],discountTypeAmount:[t?t.discountTypeAmount:""],discountAmount:[{value:t?t.discountAmount:"",disabled:!0}],subTotal:[{value:t?t.subTotal:"",disabled:!0},[d.k0.required]],taxTypeAmount:[t?t.taxTypeAmount:"",[d.k0.required]],expectedDeliveryDate:[t?t.expectedDeliveryDate:""]}))}addAttachment(t){let r=!0;t||(r=!1,(t=new y.Bs).pictureId=null,t.picture=null,t.documentName="",t.hideUploader=!1,t.uniqueId=i.ov.generateUUID(),t.uploader=new i.o7({maxAllowedFile:1,completeCallback:this.uploadCompleted.bind(this,t),onWhenAddingFileFailed:this.uploadFailed.bind(this)})),this.salesOrderAttachments.push(this.formBuilder.group({documentName:[t?t.documentName:"",[d.k0.required,d.k0.maxLength(256)]],pictureId:[t?t.pictureId:null],uniqueId:[t?t.uniqueId:null]})),i.ov.isEmpty(this.salesOrderData)&&(this.salesOrderData=new y.fX),r||this.salesOrderData.salesOrderAttachments.push(t)}removeAttachment(t){this.salesOrderAttachments.removeAt(t),this.salesOrderData.salesOrderAttachments.splice(t,1)}removeProductDetail(t){this.salesOrderProductDetails.removeAt(t),this.calculateTotalProductAmount()}save(){if(this.isFormSubmitted=!0,!this.frmSalesOrder.invalid){if(this.salesOrderData.salesOrderAttachments.some(t=>!t.pictureId&&!t.uploader.hasFile()))return void this.notificationService.warning("Please upload all the required documents.");this.uploadDocuments=this.salesOrderData.salesOrderAttachments.filter(t=>t.uploader.hasFile()),this.uploadedCount=0,this.uploadDocuments.length>0?this.uploadDocuments.forEach((t,r)=>{t.uploader.hasFile()&&t.uploader.uploadFiles({uploadType:x.Sq.SalesOrder,id:"0"})}):this.saveFinal()}}saveFinal(){const t=this.frmSalesOrder.getRawValue();t.date=this.formatDate(t.date),t.salesOrderProductDetails.forEach(r=>{r.expectedDeliveryDate&&(r.expectedDeliveryDate=this.formatDate(r.expectedDeliveryDate))}),this.isEditMode?this.updateSalesOrder(t):this.createSalesOrder(t)}createSalesOrder(t){this.salesOrderService.add(t).subscribe(r=>{this.cancel(),this.notificationService.success("Sales Order saved successfully.")},r=>{this.error=r})}updateSalesOrder(t){this.salesOrderService.update(this.salesOrderId,t).subscribe(r=>{this.cancel(),this.notificationService.success("Sales Order updated successfully."),this.updateRevisionNo()},r=>{this.error=r})}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}loadDropdowns(){this.salesOrderService.getUsers().subscribe(t=>this.users=t),this.listService.getList("customers").subscribe(t=>this.customers=t),this.listService.getList("salesOrderTypes").subscribe(t=>this.salesOrderTypes=t),this.listService.getList("currencies").subscribe(t=>this.currencies=t),this.listService.getList("finishedproducts").subscribe(t=>this.products=t),this.listService.getList("discountTypes").subscribe(t=>{this.discountTypes=t,this.calculateDiscountAmount()})}onCustomerChange(t){this.salesOrderService.getCustomerDetails(t).subscribe(r=>{if(this.customerAddresses=r,this.isEditMode&&this.frmSalesOrder.get("customerDetailId").value){const s=this.customerAddresses.find(o=>o.id===this.frmSalesOrder.get("customerDetailId").value);s&&this.frmSalesOrder.get("customerDetailId").setValue(s.id)}else 1==this.customerAddresses.length&&this.frmSalesOrder.get("customerDetailId").setValue(this.customerAddresses[0].id)})}onProductChange(t,r){this.salesOrderService.getProductUOMs(r).subscribe(s=>{const o=this.salesOrderProductDetails.at(t);o.get("uomId").setValue(s.id),o.get("uomName").setValue(s.name),this.updateProductSubTotal(t)})}generateSalesOrderCode(){this.salesOrderService.generateCode().subscribe(t=>{this.frmSalesOrder.get("salesOrderCode").setValue(t)})}updateRevisionNo(){let t=this.frmSalesOrder.get("revisionNo").value,s=`R${(parseInt(t.replace("R",""),10)+1).toString().padStart(2,"0")}`;this.frmSalesOrder.get("revisionNo").setValue(s)}updateProductSubTotal(t){const r=this.salesOrderProductDetails.at(t),s=r.get("qty").value,o=r.get("amount").value,u=r.get("discountTypeId").value,c=r.get("discountTypeAmount").value;let m=0;if(u&&c){let g=this.discountTypes.find(F=>F.id===u)?.name??"";g.toLocaleLowerCase().startsWith("per")?m=o*s*(c/100):g.toLocaleLowerCase().startsWith("amount")&&(m=c)}const f=o*s-m;r.get("discountAmount").setValue(m),r.get("subTotal").setValue(f),this.calculateTotalProductAmount()}calculateTotalProductAmount(){let r=0;this.salesOrderProductDetails.controls.forEach(s=>{r+=s.get("subTotal").value}),this.frmSalesOrder.get("totalProductAmount").setValue(r),this.calculateDiscountAmount()}calculateDiscountAmount(){const t=this.frmSalesOrder.get("discountTypeId").value,r=this.frmSalesOrder.get("discountTypeAmount").value,s=this.frmSalesOrder.get("totalProductAmount").value;let o=0;if(this.discountTypes&&t&&r){let u=this.discountTypes.find(c=>c.id===t)?.name??"";u.toLocaleLowerCase().startsWith("per")?o=s*(r/100):u.toLocaleLowerCase().startsWith("amount")&&(o=r)}this.frmSalesOrder.get("discountAmount").setValue(o),this.calculateSubTotal(),this.calculateTotalTaxAmount()}calculateSubTotal(){const s=this.frmSalesOrder.get("totalProductAmount").value-this.frmSalesOrder.get("discountAmount").value;this.frmSalesOrder.get("subTotal").setValue(s)}calculateTotalTaxAmount(){const t=this.salesOrderProductDetails,r=this.frmSalesOrder.get("discountAmount").value,s=this.frmSalesOrder.get("totalProductAmount").value;let o=0;t.controls.forEach(m=>{const f=m.get("subTotal").value,g=m.get("taxTypeAmount").value,pe=this.roundToTwoDecimals(g/100*(f-f/s*r));o+=pe});const u=s-r,c=u+o;this.frmSalesOrder.get("totalTaxAmount").setValue(o),this.frmSalesOrder.get("subTotal").setValue(u),this.frmSalesOrder.get("totalAmount").setValue(c)}roundToTwoDecimals(t){return Math.round(100*t)/100}formatDate(t){return this.datePipe.transform(t,"yyyy-MM-dd")}hasFile(t){return this.isEditMode&&i.ov.isNotEmpty(t.picture)||t.uploader.hasFile()}uploadCompleted(t,r){this.uploadedCount++;const s=this.salesOrderAttachments.controls.find(o=>o.get("uniqueId").value===t.uniqueId);s&&s.get("pictureId").setValue(r.id),this.uploadedCount===this.uploadDocuments.length&&this.saveFinal()}uploadFailed(){this.notificationService.warning("You are only allowed to upload jpg/jpeg/png/pdf/doc files.")}selectedFile(t){t.hideUploader=!0}removeEditFile(t){t.pictureId=null,t.picture=null,t.hideUploader=!1,t.uploader.uploader.clearQueue()}static#e=this.\u0275fac=function(r){return new(r||a)(e.rXU(h.nX),e.rXU(h.Ix),e.rXU(d.ze),e.rXU(O),e.rXU(D.tw),e.rXU(i.aG),e.rXU(i.FJ),e.rXU(p.vh))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ng-component"]],features:[e.Jv_([p.QX,p.vh])],decls:139,vars:32,consts:[["form","ngForm"],["picker1",""],["picker2",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"click",4,"authPermission"],["novalidate","",1,"app-form",3,"submit","formGroup"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-4"],["type","text","matInput","","formControlName","salesOrderCode","readonly",""],["type","text","matInput","","formControlName","revisionNo","readonly",""],["formControlName","salesPersonId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","customerId",3,"selectionChange"],["formControlName","customerDetailId"],["type","text","matInput","","formControlName","customerPONumber"],["matInput","","formControlName","date",3,"matDatepicker"],["matSuffix","",3,"for"],["formControlName","salesOrderTypeId"],["formControlName","currencyId"],["type","text","matInput","","formControlName","totalProductAmount","readonly","",3,"value"],["formControlName","discountTypeId"],["type","number","matInput","","formControlName","discountTypeAmount"],["type","text","matInput","","formControlName","discountAmount","readonly","",3,"value"],["type","text","matInput","","formControlName","subTotal","readonly","",3,"value"],["type","text","matInput","","formControlName","totalTaxAmount","readonly","",3,"value"],["type","text","matInput","","formControlName","totalAmount","readonly","",3,"value"],[1,"col-md-12"],["matInput","","formControlName","termsCondition","rows","2"],[1,"card-header","d-flex","align-items-center","justify-content-between"],["type","button","mat-flat-button","","color","primary",3,"click"],["formArrayName","salesOrderProductDetails"],["class","row mt-3",3,"formGroupName",4,"ngFor","ngForOf"],["formArrayName","salesOrderAttachments"],[1,"col-lg-12","text-center"],["type","submit","mat-flat-button","","color","primary",1,"app-button","mr-1"],["mat-flat-button","","color","primary",1,"app-button",3,"click"],[3,"value"],[1,"row","mt-3",3,"formGroupName"],[1,"col-md-3"],["formControlName","productId",3,"selectionChange"],[1,"col-md-2"],["type","text","matInput","","formControlName","uomName","readonly",""],["type","number","matInput","","formControlName","qty",3,"input"],["type","number","matInput","","formControlName","amount",3,"input"],["formControlName","discountTypeId",3,"selectionChange"],["type","number","matInput","","formControlName","discountTypeAmount",3,"input"],["type","number","matInput","","formControlName","taxTypeAmount",3,"input"],["matInput","","formControlName","expectedDeliveryDate",3,"matDatepicker"],[1,"col-md-1","d-flex","align-items-center"],["type","button","mat-icon-button","","color","warn",3,"click"],[1,"col-md-5"],["type","text","matInput","","formControlName","documentName"],[3,"control","message","formSubmitted"],["type","hidden","formControlName","uniqueId"],[3,"removeDocument","selectedFile","documents","isEditMode","label","hideUploader","uploader"],[1,"col-md-2","d-flex","align-items-center"]],template:function(r,s){if(1&r){const o=e.RV6();e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"h4",8),e.nrm(6,"i",9),e.EFF(7," Add/Edit Sales Order"),e.k0s()(),e.j41(8,"div",10),e.DNE(9,w,2,0,"a",11),e.k0s()(),e.j41(10,"form",12,0),e.bIt("submit",function(){return e.eBV(o),e.Njj(s.save())}),e.j41(12,"div",13)(13,"div",14)(14,"h5",8),e.EFF(15,"Basic Details"),e.k0s()(),e.j41(16,"div",15)(17,"div",16)(18,"div",17)(19,"mat-form-field")(20,"mat-label"),e.EFF(21,"Sales Order Code"),e.k0s(),e.nrm(22,"input",18),e.k0s()(),e.j41(23,"div",17)(24,"mat-form-field")(25,"mat-label"),e.EFF(26,"Revision No"),e.k0s(),e.nrm(27,"input",19),e.k0s()(),e.j41(28,"div",17)(29,"mat-form-field")(30,"mat-label"),e.EFF(31,"Sales Person"),e.k0s(),e.j41(32,"mat-select",20),e.DNE(33,U,2,4,"mat-option",21),e.k0s()()(),e.j41(34,"div",17)(35,"mat-form-field")(36,"mat-label"),e.EFF(37,"Customer Name"),e.k0s(),e.j41(38,"mat-select",22),e.bIt("selectionChange",function(c){return e.eBV(o),e.Njj(s.onCustomerChange(c.value))}),e.DNE(39,L,2,2,"mat-option",21),e.k0s()()(),e.j41(40,"div",17)(41,"mat-form-field")(42,"mat-label"),e.EFF(43,"Customer Address"),e.k0s(),e.j41(44,"mat-select",23),e.DNE(45,B,2,5,"mat-option",21),e.k0s()()(),e.j41(46,"div",17)(47,"mat-form-field")(48,"mat-label"),e.EFF(49,"Customer PO Number"),e.k0s(),e.nrm(50,"input",24),e.k0s()(),e.j41(51,"div",17)(52,"mat-form-field")(53,"mat-label"),e.EFF(54,"Date"),e.k0s(),e.nrm(55,"input",25)(56,"mat-datepicker-toggle",26)(57,"mat-datepicker",null,1),e.k0s()(),e.j41(59,"div",17)(60,"mat-form-field")(61,"mat-label"),e.EFF(62,"Sales Order Type"),e.k0s(),e.j41(63,"mat-select",27),e.DNE(64,X,2,2,"mat-option",21),e.k0s()()(),e.j41(65,"div",17)(66,"mat-form-field")(67,"mat-label"),e.EFF(68,"Currency"),e.k0s(),e.j41(69,"mat-select",28),e.DNE(70,M,2,2,"mat-option",21),e.k0s()()(),e.j41(71,"div",17)(72,"mat-form-field")(73,"mat-label"),e.EFF(74,"Total Product Amount"),e.k0s(),e.nrm(75,"input",29),e.nI1(76,"number"),e.k0s()(),e.j41(77,"div",17)(78,"mat-form-field")(79,"mat-label"),e.EFF(80,"Discount Type"),e.k0s(),e.j41(81,"mat-select",30),e.DNE(82,H,2,2,"mat-option",21),e.k0s()()(),e.j41(83,"div",17)(84,"mat-form-field")(85,"mat-label"),e.EFF(86,"Discount Type Amount"),e.k0s(),e.nrm(87,"input",31),e.k0s()(),e.j41(88,"div",17)(89,"mat-form-field")(90,"mat-label"),e.EFF(91,"Discount Amount"),e.k0s(),e.nrm(92,"input",32),e.nI1(93,"number"),e.k0s()(),e.j41(94,"div",17)(95,"mat-form-field")(96,"mat-label"),e.EFF(97,"Sub Total"),e.k0s(),e.nrm(98,"input",33),e.nI1(99,"number"),e.k0s()(),e.j41(100,"div",17)(101,"mat-form-field")(102,"mat-label"),e.EFF(103,"Total Tax Amount"),e.k0s(),e.nrm(104,"input",34),e.nI1(105,"number"),e.k0s()(),e.j41(106,"div",17)(107,"mat-form-field")(108,"mat-label"),e.EFF(109,"Total Amount"),e.k0s(),e.nrm(110,"input",35),e.nI1(111,"number"),e.k0s()(),e.j41(112,"div",36)(113,"mat-form-field")(114,"mat-label"),e.EFF(115,"Terms Condition"),e.k0s(),e.nrm(116,"textarea",37),e.k0s()()()()(),e.j41(117,"div",13)(118,"div",38)(119,"h5",8),e.EFF(120,"Product Details"),e.k0s(),e.j41(121,"button",39),e.bIt("click",function(){return e.eBV(o),e.Njj(s.addProductDetail())}),e.EFF(122,"Add Product"),e.k0s()(),e.j41(123,"div",15)(124,"div",40),e.DNE(125,J,66,13,"div",41),e.k0s()()(),e.j41(126,"div",13)(127,"div",38)(128,"h5",8),e.EFF(129,"Attachments"),e.k0s(),e.j41(130,"button",39),e.bIt("click",function(){return e.eBV(o),e.Njj(s.addAttachment())}),e.EFF(131," Add Attachment "),e.k0s()(),e.j41(132,"div",15)(133,"div",42),e.DNE(134,Q,17,9,"div",41),e.k0s()()(),e.j41(135,"div",16)(136,"div",43)(137,"button",44),e.EFF(138,"Save"),e.k0s()()()()()()()}if(2&r){const o=e.sdS(58);e.R7$(9),e.Y8G("authPermission",s.page+"_"+s.permissions.list),e.R7$(),e.Y8G("formGroup",s.frmSalesOrder),e.R7$(23),e.Y8G("ngForOf",s.users),e.R7$(6),e.Y8G("ngForOf",s.customers),e.R7$(6),e.Y8G("ngForOf",s.customerAddresses),e.R7$(10),e.Y8G("matDatepicker",o),e.R7$(),e.Y8G("for",o),e.R7$(8),e.Y8G("ngForOf",s.salesOrderTypes),e.R7$(6),e.Y8G("ngForOf",s.currencies),e.R7$(5),e.Y8G("value",e.i5U(76,17,s.frmSalesOrder.get("totalProductAmount").value,"1.2-2")),e.R7$(7),e.Y8G("ngForOf",s.discountTypes),e.R7$(10),e.Y8G("value",e.i5U(93,20,s.frmSalesOrder.get("discountAmount").value,"1.2-2")),e.R7$(6),e.Y8G("value",e.i5U(99,23,s.frmSalesOrder.get("subTotal").value,"1.2-2")),e.R7$(6),e.Y8G("value",e.i5U(105,26,s.frmSalesOrder.get("totalTaxAmount").value,"1.2-2")),e.R7$(6),e.Y8G("value",e.i5U(111,29,s.frmSalesOrder.get("totalAmount").value,"1.2-2")),e.R7$(15),e.Y8G("ngForOf",s.salesOrderProductDetails.controls),e.R7$(9),e.Y8G("ngForOf",s.salesOrderAttachments.controls)}},dependencies:[p.Sq,d.qT,d.me,d.Q0,d.BC,d.cb,d.j4,d.JD,d.$R,d.v8,v.It,v.$z,v.iY,_.rl,_.nJ,_.yw,P.fg,k.An,G.VO,R.wT,b.Vh,b.bZ,b.bU,j.B,$.T,V.r,Y.A,p.QX],encapsulation:2})}return a})();var A=l(33380),Z=l(49239),z=l(74193);let E=(()=>{class a{constructor(){this.searchChanged=new e.bkB,this.searchData={},this.searchKey="salesOrderCode,customerPONumber"}updateSearchTerms(t,r){this.searchData[t]=r,this.searchChanged.emit(this.searchData)}static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["sales-order-search-panel"]],outputs:{searchChanged:"searchChanged"},decls:5,vars:1,consts:[[1,"row"],[1,"col-lg-6"],[3,"textSearchEntered","placeHolder"],[1,"col-lg-4"],[3,"chkChanged"]],template:function(r,s){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"search-text",2),e.bIt("textSearchEntered",function(u){return s.updateSearchTerms(s.searchKey,u)}),e.k0s()(),e.j41(3,"div",3)(4,"search-inactive",4),e.bIt("chkChanged",function(u){return s.updateSearchTerms("isActive",u)}),e.k0s()()()),2&r&&(e.R7$(2),e.Y8G("placeHolder","Search Sales Order Code, Customer PO Number, Revision Number"))},dependencies:[Z.D,z.$],encapsulation:2})}return a})();var K=l(96081);const ee=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),te=()=>["../","add"],re=a=>["..","edit",a];function se(a,n){1&a&&(e.j41(0,"a",19)(1,"span"),e.EFF(2,"Add New"),e.k0s(),e.nrm(3,"i",20),e.k0s()),2&a&&e.Y8G("routerLink",e.lJ4(1,te))}function ae(a,n){if(1&a&&(e.j41(0,"a",23)(1,"mat-icon"),e.EFF(2,"edit"),e.k0s()()),2&a){const t=e.XpG().row;e.Y8G("routerLink",e.eq3(1,re,t.id))}}function oe(a,n){if(1&a){const t=e.RV6();e.j41(0,"a",26),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2).row,o=e.XpG();return e.Njj(o.activateToggleSalesOrder(s,!1))}),e.j41(1,"mat-icon"),e.EFF(2,"lock"),e.k0s()()}}function ie(a,n){if(1&a){const t=e.RV6();e.j41(0,"a",26),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2).row,o=e.XpG();return e.Njj(o.activateToggleSalesOrder(s,!0))}),e.j41(1,"mat-icon"),e.EFF(2,"lock_open"),e.k0s()()}}function ne(a,n){if(1&a&&(e.qex(0,24),e.DNE(1,oe,3,0,"a",25)(2,ie,3,0,"a",25),e.bVm()),2&a){const t=e.XpG().row;e.R7$(),e.Y8G("ngIf",t.isActive),e.R7$(),e.Y8G("ngIf",!t.isActive)}}function le(a,n){if(1&a&&e.DNE(0,ae,3,3,"a",21)(1,ne,3,2,"ng-container",22),2&a){const t=e.XpG();e.Y8G("authPermission",t.page+"_"+t.permissions.edit),e.R7$(),e.Y8G("authPermission",t.page+"_"+t.permissions.active)}}const de=[{path:"",component:C,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class a{constructor(t,r,s){this.salesOrderService=t,this.notificationService=r,this.datePipe=s,this.salesOrderData=[],this.page=i.Wt.salesOrder,this.permissions=i.eZ,this.searchData={isActive:!1}}ngOnInit(){this.getSalesOrderData()}getSalesOrderData(){this.loading=!0,this.salesOrderService.get().subscribe(t=>{this.salesOrderData=t,this.loading=!1},t=>{console.log(t),this.loading=!1})}activateToggleSalesOrder(t,r){confirm(`Are you sure you want to ${r?"Activate":"Deactivate"} this sales order?`)&&this.salesOrderService.toggleActivate(t.id,r).subscribe(()=>{this.getSalesOrderData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(t){this.searchData=Object.assign({},t)}isActiveRow(t){return{"text-danger":!t.isActive}}static#e=this.\u0275fac=function(r){return new(r||a)(e.rXU(O),e.rXU(D.tw),e.rXU(p.vh))};static#t=this.\u0275cmp=e.VBU({type:a,selectors:[["ng-component"]],features:[e.Jv_([p.vh])],decls:21,vars:17,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"routerLink",4,"authPermission"],[3,"searchChanged"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","rowClass","messages"],["name","Sales Order Code","prop","salesOrderCode"],["name","Date","prop","date",3,"pipe"],["name","Customer PO Number","prop","customerPONumber"],["name","Customer Name","prop","customerName"],["name","Revision No","prop","revisionNo"],["name","Sales Person","prop","salesPersonName"],["name","Total Amount","prop","totalAmount"],["name","Actions",3,"sortable"],["ngx-datatable-cell-template",""],["mat-flat-button","","color","primary",1,"app-button",3,"routerLink"],[1,"icon-plus"],["class","button-padding","color","primary",3,"routerLink",4,"authPermission"],["class","ml-10",4,"authPermission"],["color","primary",1,"button-padding",3,"routerLink"],[1,"ml-10"],["class","button-padding","color","primary",3,"click",4,"ngIf"],["color","primary",1,"button-padding",3,"click"]],template:function(r,s){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),e.EFF(6,"Sales Order List"),e.k0s()(),e.j41(7,"div",6),e.DNE(8,se,4,2,"a",7),e.k0s()(),e.j41(9,"sales-order-search-panel",8),e.bIt("searchChanged",function(u){return s.updateSearch(u)}),e.k0s(),e.j41(10,"ngx-datatable",9),e.nI1(11,"searchtable"),e.nrm(12,"ngx-datatable-column",10)(13,"ngx-datatable-column",11)(14,"ngx-datatable-column",12)(15,"ngx-datatable-column",13)(16,"ngx-datatable-column",14)(17,"ngx-datatable-column",15)(18,"ngx-datatable-column",16),e.j41(19,"ngx-datatable-column",17),e.DNE(20,le,2,2,"ng-template",18),e.k0s()()()()()),2&r&&(e.R7$(8),e.Y8G("authPermission",s.page+"_"+s.permissions.create),e.R7$(2),e.Y8G("rows",e.i5U(11,13,s.salesOrderData,s.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",s.loading)("scrollbarH",!0)("rowClass",s.isActiveRow)("messages",e.lJ4(16,ee)),e.R7$(3),e.Y8G("pipe",s.datePipe),e.R7$(6),e.Y8G("sortable",!1))},dependencies:[p.bT,v.It,k.An,h.Wk,A.ge,A.ed,A.QI,j.B,E,K.j],encapsulation:2})}return a})(),canActivate:[i.LL],data:{page:i.Wt.salesOrder,action:i.eZ.list,title:"Sales Order"}},{path:"add",canActivate:[i.LL],data:{page:i.Wt.salesOrder,action:i.eZ.create,title:"Sales Order"},component:S},{path:"edit/:id",canActivate:[i.LL],data:{page:i.Wt.salesOrder,action:i.eZ.edit,title:"Sales Order"},component:S}]}];let ue=(()=>{class a{static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275mod=e.$C({type:a});static#r=this.\u0275inj=e.G2t({imports:[h.iI.forChild(de),h.iI]})}return a})(),ce=(()=>{class a{static#e=this.\u0275fac=function(r){return new(r||a)};static#t=this.\u0275mod=e.$C({type:a});static#r=this.\u0275inj=e.G2t({providers:[O],imports:[N.Gg,ue]})}return a})()}}]);