"use strict";(self.webpackChunkskyward_nutem=self.webpackChunkskyward_nutem||[]).push([[588],{2588:(J,y,i)=>{i.r(y),i.d(y,{CompanyModule:()=>Q});var g=i(1774),c=i(8498),r=i(4434),s=i(9417),I=i(775),v=function(e){return e[e.Company=1]="Company",e[e.Vendor=2]="Vendor",e[e.Inward=3]="Inward",e[e.Outward=4]="Outward",e[e.QualityParameter=5]="QualityParameter",e[e.Product=6]="Product",e[e.SalesOrder=7]="SalesOrder",e}(v||{}),t=i(4438);let u=(()=>{class e extends r.QP{constructor(a){super(a,"company"),this._baseService=a}static#t=this.\u0275fac=function(o){return new(o||e)(t.KVO(r.dD))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac})}return e})();var C=i(5794),h=i(8834),b=i(2102),w=i(9631),F=i(220),L=i(8777),R=i(7133),G=i(1893);function _(e,d){if(1&e){const a=t.RV6();t.j41(0,"a",37),t.bIt("click",function(){t.eBV(a);const n=t.XpG();return t.Njj(n.cancel())}),t.EFF(1," View List "),t.k0s()}}let f=(()=>{class e{constructor(a,o,n,m,l){this.activatedRoute=a,this.router=o,this.formBuilder=n,this.companyService=m,this.notificationService=l,this.page=r.Wt.company,this.permissions=r.eZ,this.fileOptions={maxAllowedFile:1,completeCallback:this.uploadCompleted.bind(this),onWhenAddingFileFailed:this.uploadFailed.bind(this)},this.fileUploader=new r.o7(this.fileOptions),this.createForm()}ngOnInit(){this.getCompanyRoute()}getCompanyRoute(){this.routerSub=this.activatedRoute.params.subscribe(a=>{this.isEditMode=!r.ov.isEmpty(a.id),this.createForm(),this.isEditMode?(this.companyId=+a.id,this.getCompanyDetails()):this.companyData=new I.CC})}getCompanyDetails(){this.companyService.getById(this.companyId).subscribe(a=>{this.companyData=a,this.setCompanyData()},a=>{console.log(a)})}setCompanyData(){this.frmCompany.patchValue(this.companyData)}createForm(){this.frmCompany=this.formBuilder.group({companyName:["",[s.k0.required,s.k0.maxLength(100)]],alias:[""],address1:["",[s.k0.required]],address2:[""],address3:[""],pincode:["",[s.k0.required,s.k0.maxLength(10)]],city:["",[s.k0.required,s.k0.maxLength(50)]],state:["",[s.k0.required,s.k0.maxLength(50)]],country:["",[s.k0.required,s.k0.maxLength(50)]],panNo:[""],gstNo:[""],emailID:["",[s.k0.email,s.k0.maxLength(50)]],website:[""],phoneNo:["",[s.k0.maxLength(15)]],isActive:[!1],companyLogoId:[""],currency:[""]})}save(){this.isFormSubmitted=!0,!this.frmCompany.invalid&&(this.isEditMode?this.updateCompany():this.createCompany())}removeFile(a){this.companyData&&(this.companyData.companyLogoId=null,this.companyData.companyLogo=null,this.frmCompany.controls.companyLogoId.setValue(null)),this.fileUploader.uploader.clearQueue()}canHideUploader(){let a=!1;return(this.companyData&&this.companyData.companyLogoId>0||this.fileUploader.hasFile())&&(a=!0),a}createCompany(){let a=Object.assign({},this.frmCompany.value);this.companyService.add(a).subscribe(o=>{o.isSuccess?this.fileUploader.hasFile()?this.uploadDocuments(o.id):(this.cancel(),this.notificationService.success("Company saved successfully.")):this.notificationService.warning(o.message)},o=>{this.error=400===o.status&&o.error.modelState?o.error.modelState[""][0]:"Something went wrong"})}updateCompany(){let a=Object.assign(this.companyData,this.frmCompany.value);this.companyService.update(this.companyId,a).subscribe(o=>{o.isSuccess?this.fileUploader.hasFile()?this.uploadDocuments(o.id):(this.cancel(),this.notificationService.success("Company updated successfully.")):this.notificationService.warning(o.message)},o=>{this.error=400===o.status&&o.error.modelState?o.error.modelState[""][0]:"Something went wrong"})}uploadDocuments(a){this.fileUploader.uploadFiles({uploadType:v.Company,id:a.toString()})}uploadCompleted(){this.cancel(),this.notificationService.success(this.isEditMode?"Company updated successfully.":"Company saved successfully.")}uploadFailed(){this.notificationService.warning("You are only allowed to upload jpg/jpeg/png/pdf/doc files.")}onSelectFile(a){}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||e)(t.rXU(c.nX),t.rXU(c.Ix),t.rXU(s.ze),t.rXU(u),t.rXU(C.tw))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["ng-component"]],decls:114,vars:37,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"click",4,"authPermission"],["novalidate","",3,"ngSubmit","formGroup"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-6"],["matInput","","formControlName","companyName"],[3,"control","message","formSubmitted"],["matInput","","formControlName","alias"],[1,"col-md-4"],["matInput","","formControlName","address1"],["matInput","","formControlName","address2"],["matInput","","formControlName","address3"],["type","text","matInput","","formControlName","pincode"],["type","text","matInput","","formControlName","city"],["type","text","matInput","","formControlName","state"],["type","text","matInput","","formControlName","country"],["type","text","matInput","","formControlName","panNo"],["type","text","matInput","","formControlName","gstNo"],["type","email","matInput","","formControlName","emailID"],["type","url","matInput","","formControlName","website"],["type","tel","matInput","","formControlName","phoneNo"],["type","hidden","formControlName","companyLogoId"],[3,"removeDocument","selectedFile","documents","isEditMode","uploader","label","hideUploader"],[1,"row","mt-3"],[1,"col-md-12","text-right"],["type","submit","mat-flat-button","","color","primary",1,"app-button","mr-5"],["type","button","mat-flat-button","","color","primary",1,"app-button",3,"click"],["mat-flat-button","","color","primary",1,"app-button",3,"click"]],template:function(o,n){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.nrm(6,"i",6),t.EFF(7," Add/Edit Company Details"),t.k0s()(),t.j41(8,"div",7),t.DNE(9,_,2,0,"a",8),t.k0s()(),t.j41(10,"div")(11,"form",9),t.bIt("ngSubmit",function(){return n.save()}),t.j41(12,"div",10)(13,"div",11)(14,"h5",5),t.EFF(15,"Basic Details"),t.k0s()(),t.j41(16,"div",12)(17,"div",13)(18,"div",14)(19,"mat-form-field")(20,"mat-label"),t.EFF(21,"Company Name *"),t.k0s(),t.nrm(22,"input",15)(23,"mat-validation-message",16),t.k0s()(),t.j41(24,"div",14)(25,"mat-form-field")(26,"mat-label"),t.EFF(27,"Alias"),t.k0s(),t.nrm(28,"input",17),t.k0s()()(),t.j41(29,"div",13)(30,"div",18)(31,"mat-form-field")(32,"mat-label"),t.EFF(33,"Address Line 1"),t.k0s(),t.nrm(34,"input",19)(35,"mat-validation-message",16),t.k0s()(),t.j41(36,"div",18)(37,"mat-form-field")(38,"mat-label"),t.EFF(39,"Address Line 2"),t.k0s(),t.nrm(40,"input",20),t.k0s()(),t.j41(41,"div",18)(42,"mat-form-field")(43,"mat-label"),t.EFF(44,"Address Line 3"),t.k0s(),t.nrm(45,"input",21),t.k0s()()(),t.j41(46,"div",13)(47,"div",18)(48,"mat-form-field")(49,"mat-label"),t.EFF(50,"Pincode"),t.k0s(),t.nrm(51,"input",22)(52,"mat-validation-message",16),t.k0s()(),t.j41(53,"div",18)(54,"mat-form-field")(55,"mat-label"),t.EFF(56,"City"),t.k0s(),t.nrm(57,"input",23)(58,"mat-validation-message",16),t.k0s()(),t.j41(59,"div",18)(60,"mat-form-field")(61,"mat-label"),t.EFF(62,"State"),t.k0s(),t.nrm(63,"input",24)(64,"mat-validation-message",16),t.k0s()()(),t.j41(65,"div",13)(66,"div",18)(67,"mat-form-field")(68,"mat-label"),t.EFF(69,"Country"),t.k0s(),t.nrm(70,"input",25)(71,"mat-validation-message",16),t.k0s()(),t.j41(72,"div",18)(73,"mat-form-field")(74,"mat-label"),t.EFF(75,"PAN No"),t.k0s(),t.nrm(76,"input",26)(77,"mat-validation-message",16),t.k0s()(),t.j41(78,"div",18)(79,"mat-form-field")(80,"mat-label"),t.EFF(81,"GST No"),t.k0s(),t.nrm(82,"input",27)(83,"mat-validation-message",16),t.k0s()()(),t.j41(84,"div",13)(85,"div",18)(86,"mat-form-field")(87,"mat-label"),t.EFF(88,"Email ID"),t.k0s(),t.nrm(89,"input",28)(90,"mat-validation-message",16),t.k0s()(),t.j41(91,"div",18)(92,"mat-form-field")(93,"mat-label"),t.EFF(94,"Website"),t.k0s(),t.nrm(95,"input",29),t.k0s()(),t.j41(96,"div",18)(97,"mat-form-field")(98,"mat-label"),t.EFF(99,"Phone Number"),t.k0s(),t.nrm(100,"input",30)(101,"mat-validation-message",16),t.k0s()()(),t.j41(102,"div",13)(103,"div",18)(104,"label"),t.EFF(105,"Company Logo"),t.k0s(),t.nrm(106,"input",31),t.j41(107,"file-uploader",32),t.bIt("removeDocument",function(l){return n.removeFile(l)})("selectedFile",function(l){return n.onSelectFile(l)}),t.k0s()()()()(),t.j41(108,"div",33)(109,"div",34)(110,"button",35),t.EFF(111,"Save"),t.k0s(),t.j41(112,"button",36),t.bIt("click",function(){return n.cancel()}),t.EFF(113,"Cancel"),t.k0s()()()()()()()()),2&o&&(t.R7$(9),t.Y8G("authPermission",n.page+"_"+n.permissions.list),t.R7$(2),t.Y8G("formGroup",n.frmCompany),t.R7$(12),t.Y8G("control",n.frmCompany.controls.companyName)("message","Company Name")("formSubmitted",n.isFormSubmitted),t.R7$(12),t.Y8G("control",n.frmCompany.controls.address1)("message","Address Line 1")("formSubmitted",n.isFormSubmitted),t.R7$(17),t.Y8G("control",n.frmCompany.controls.pincode)("message","Pincode")("formSubmitted",n.isFormSubmitted),t.R7$(6),t.Y8G("control",n.frmCompany.controls.city)("message","City")("formSubmitted",n.isFormSubmitted),t.R7$(6),t.Y8G("control",n.frmCompany.controls.state)("message","State")("formSubmitted",n.isFormSubmitted),t.R7$(7),t.Y8G("control",n.frmCompany.controls.country)("message","Country")("formSubmitted",n.isFormSubmitted),t.R7$(6),t.Y8G("control",n.frmCompany.controls.panNo)("message","PAN No")("formSubmitted",n.isFormSubmitted),t.R7$(6),t.Y8G("control",n.frmCompany.controls.gstNo)("message","GST No")("formSubmitted",n.isFormSubmitted),t.R7$(7),t.Y8G("control",n.frmCompany.controls.emailID)("message","Email ID")("formSubmitted",n.isFormSubmitted),t.R7$(11),t.Y8G("control",n.frmCompany.controls.phoneNo)("message","Phone Number")("formSubmitted",n.isFormSubmitted),t.R7$(6),t.Y8G("documents",null==n.companyData?null:n.companyData.companyLogo)("isEditMode",n.isEditMode)("uploader",null==n.fileUploader?null:n.fileUploader.uploader)("label","")("hideUploader",n.canHideUploader()))},dependencies:[s.qT,s.me,s.BC,s.cb,s.j4,s.JD,h.It,h.$z,b.rl,b.nJ,w.fg,F.B,L.T,R.r,G.A],encapsulation:2})}return e})();var P=i(9213),p=i(3380),$=i(932),Y=i(9239),O=i(4193);let S=(()=>{class e{constructor(){this.searchChanged=new t.bkB,this.searchData=[],this.searchKey="companyName,alias,address1,pincode,city,state,country,emailID,phoneNo"}updateSearchTerms(a,o){this.searchData.isActive=this.searchInactive.searchBox.value,this.searchData[a]=o,this.searchChanged.emit(this.searchData)}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["company-search-panel"]],viewQuery:function(o,n){if(1&o&&t.GBs(g.$A,5),2&o){let m;t.mGM(m=t.lsd())&&(n.searchInactive=m.first)}},outputs:{searchChanged:"searchChanged"},decls:5,vars:1,consts:[[1,"row"],[1,"col-lg-6"],[3,"textSearchEntered","placeHolder"],[1,"col-lg-4"],[3,"chkChanged"]],template:function(o,n){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"search-text",2),t.bIt("textSearchEntered",function(l){return n.updateSearchTerms(n.searchKey,l)}),t.k0s()(),t.j41(3,"div",3)(4,"search-inactive",4),t.bIt("chkChanged",function(l){return n.updateSearchTerms("isActive",l)}),t.k0s()()()),2&o&&(t.R7$(2),t.Y8G("placeHolder","Search Company"))},dependencies:[Y.D,O.$],encapsulation:2})}return e})();const M=()=>({emptyMessage:"No Companies Found",totalMessage:"Total"}),B=()=>["../","add"],V=e=>["../","edit",e];function H(e,d){1&e&&(t.j41(0,"a",21)(1,"span"),t.EFF(2,"Add New"),t.k0s(),t.nrm(3,"i",22),t.k0s()),2&e&&t.Y8G("routerLink",t.lJ4(1,B))}function x(e,d){1&e&&t.EFF(0),2&e&&t.SpI(" ",d.row.isActive?"Active":"Inactive"," ")}function U(e,d){if(1&e&&(t.j41(0,"a",25)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&e){const a=t.XpG().row;t.Y8G("routerLink",t.eq3(1,V,a.id))}}function X(e,d){if(1&e){const a=t.RV6();t.DNE(0,U,3,3,"a",23),t.j41(1,"a",24),t.bIt("click",function(){const n=t.eBV(a).row,m=t.XpG();return t.Njj(m.toggleActivate(n.id,!n.isActive))}),t.j41(2,"mat-icon"),t.EFF(3),t.k0s()()}if(2&e){const a=d.row;t.Y8G("authPermission","company_edit"),t.R7$(),t.FS9("title",a.isActive?"Deactivate":"Activate"),t.R7$(2),t.JRh(a.isActive?"lock":"lock_open")}}let k=(()=>{class e{constructor(a,o){this.companyService=a,this.notificationService=o,this.companyData=[],this.page=r.Wt.company,this.permissions=r.eZ,this.searchData={isActive:!1}}ngOnInit(){this.getCompanyData()}getCompanyData(){this.loading=!0,this.companyService.get().subscribe(a=>{this.loading=!1,this.companyData=a},a=>{this.loading=!1,console.log(a)})}toggleActivate(a,o){confirm(`Are you sure you want to ${o?"Activate":"Deactivate"} this company?`)&&this.companyService.toggleActivate(a,o).subscribe(m=>{m.isSuccess?this.getCompanyData():this.notificationService.warning(m.message)},m=>{this.notificationService.error("Something went wrong.")})}updateSearch(a){this.searchData=Object.assign({},a)}isActiveRow(a){return{"text-danger":!a.isActive}}static#t=this.\u0275fac=function(o){return new(o||e)(t.rXU(u),t.rXU(C.tw))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["ng-component"]],decls:24,vars:11,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","color","primary","class","app-button",3,"routerLink",4,"authPermission"],[1,"row"],[1,"col-12"],[3,"searchChanged"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","Company Name","prop","companyName"],["name","Alias","prop","alias"],["name","City","prop","city"],["name","State","prop","state"],["name","Country","prop","country"],["name","Email","prop","emailID"],["name","Status"],["ngx-datatable-cell-template",""],["name","Actions"],["mat-flat-button","","color","primary",1,"app-button",3,"routerLink"],[1,"icon-plus"],["title","Edit","class","button-padding",3,"routerLink",4,"authPermission"],["href","#",1,"button-padding",3,"click","title"],["title","Edit",1,"button-padding",3,"routerLink"]],template:function(o,n){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Company List"),t.k0s()(),t.j41(7,"div",6)(8,"div"),t.DNE(9,H,4,2,"a",7),t.k0s()()(),t.j41(10,"div",8)(11,"div",9)(12,"company-search-panel",10),t.bIt("searchChanged",function(l){return n.updateSearch(l)}),t.k0s(),t.j41(13,"ngx-datatable",11),t.nrm(14,"ngx-datatable-column",12)(15,"ngx-datatable-column",13)(16,"ngx-datatable-column",14)(17,"ngx-datatable-column",15)(18,"ngx-datatable-column",16)(19,"ngx-datatable-column",17),t.j41(20,"ngx-datatable-column",18),t.DNE(21,x,1,1,"ng-template",19),t.k0s(),t.j41(22,"ngx-datatable-column",20),t.DNE(23,X,4,3,"ng-template",19),t.k0s()()()()()()()),2&o&&(t.R7$(9),t.Y8G("authPermission","company_create"),t.R7$(4),t.Y8G("rows",n.companyData)("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",n.loading)("scrollbarH",!0)("messages",t.lJ4(10,M)))},dependencies:[h.It,P.An,c.Wk,p.ge,p.ed,p.QI,$.a,F.B,S],encapsulation:2})}return e})();const T=[{path:"",component:(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(o,n){1&o&&t.nrm(0,"router-outlet")},dependencies:[c.n3],encapsulation:2})}return e})(),children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",canActivate:[r.LL],component:k,data:{page:r.Wt.company,action:r.eZ.list,title:"Company"}},{path:"add",canActivate:[r.LL],data:{page:r.Wt.company,action:r.eZ.create,title:"Company"},component:f},{path:"edit/:id",canActivate:[r.LL],data:{page:r.Wt.company,action:r.eZ.edit,title:"Company"},component:f}]}];let W=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.$C({type:e});static#a=this.\u0275inj=t.G2t({imports:[c.iI.forChild(T),c.iI]})}return e})(),Q=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.$C({type:e});static#a=this.\u0275inj=t.G2t({providers:[u],imports:[g.Gg,p.Kj,W]})}return e})()}}]);