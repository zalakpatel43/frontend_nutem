"use strict";(self.webpackChunkskyward_nutem=self.webpackChunkskyward_nutem||[]).push([[956],{8956:(Vt,L,l)=>{l.r(L),l.d(L,{LiquidPreparationModule:()=>Bt});var p=l(177),h=l(8498),t=l(4438);let S=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-liquid-preparation"]],decls:1,vars:0,template:function(n,i){1&n&&t.nrm(0,"router-outlet")},dependencies:[h.n3]})}return a})();var m=l(4434),q=l(1626);let I=(()=>{class a{constructor(e,n){this.http=e,this._baseService=n}getStartEndBatchCheckList(){return this.http.get(`${m.T6.StartEndBatchChecklist}`)}getTankMasterList(){return this.http.get(`${m.T6.GetAllTankMaster}`)}getMaterialMasterList(){return this.http.get(`${m.T6.GetAllMaterialMaster}`)}getProductInstructionDetailsList(){return this.http.get(`${m.T6.GetAllProductInstructionDetails}`)}getQCTSpecificationMasterList(){return this.http.get(`${m.T6.GetAllQCTSpecificationMaster}`)}getliquidPreparationList(){return this.http.get(`${m.T6.LiquidPreparationList}`)}addLiquidPreparation(e){return this.http.post(`${m.T6.LiquidPreparationAdd}`,e)}updateLiquidPreparation(e){return this.http.post(`${m.T6.LiquidPreparationEdit}`,e)}getByIdLiquidPreparation(e){return this.http.get(`${m.T6.LiquidPreparationGetById}?id=`+e)}DeleteLiquidPreparation(e){return this.http.get(`${m.T6.LiquidPreparationDelete}?id=`+e)}static#t=this.\u0275fac=function(n){return new(n||a)(t.KVO(q.Qq),t.KVO(m.dD))};static#e=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var D=l(5794),T=l(4532),_=l(8834),P=l(9213),k=l(3380),N=l(6081);const R=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),x=()=>["../","add"],G=a=>["..","edit",a];function B(a,s){1&a&&(t.j41(0,"a",16)(1,"span"),t.EFF(2,"Add New"),t.k0s(),t.nrm(3,"i",17),t.k0s()),2&a&&t.Y8G("routerLink",t.lJ4(1,x))}function $(a,s){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const e=s.value;t.R7$(),t.JRh(t.i5U(2,1,e,"MM/dd/yyyy hh:mm a"))}}function V(a,s){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const e=s.value;t.R7$(),t.JRh(t.i5U(2,1,e,"MM/dd/yyyy hh:mm a"))}}function M(a,s){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const e=s.value;t.R7$(),t.JRh(e)}}function Q(a,s){if(1&a&&(t.j41(0,"a",21)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&a){const e=t.XpG().row;t.Y8G("routerLink",t.eq3(1,G,e.id))}}function Y(a,s){if(1&a){const e=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(e);const i=t.XpG().row,o=t.XpG(2);return t.Njj(o.removeliquidPreparation(i.id))}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function w(a,s){if(1&a&&t.DNE(0,Q,3,3,"a",19)(1,Y,3,0,"button",20),2&a){const e=t.XpG(2);t.Y8G("ngIf",e.IsEditPermission),t.R7$(),t.Y8G("ngIf",e.IsDeletePermission)}}function O(a,s){1&a&&(t.j41(0,"ngx-datatable-column",18),t.DNE(1,w,2,2,"ng-template",12),t.k0s()),2&a&&t.Y8G("sortable",!1)}let C=(()=>{class a{constructor(e,n,i){this.liquidPreparationService=e,this.notificationService=n,this.permissionService=i,this.liquidPreparationData=[],this.page=m.Wt.liquidPreparation,this.permissions=m.eZ,this.searchData={},this.IsAddPemission=!1,this.IsEditPermission=!1,this.IsDeletePermission=!1}ngOnInit(){this.IsAddPemission=this.permissionService.hasPermission("Liquid Preparation (PER_LIQUIDPREPARATION) - Add"),this.IsEditPermission=this.permissionService.hasPermission("Liquid Preparation (PER_LIQUIDPREPARATION) - Edit"),this.IsDeletePermission=this.permissionService.hasPermission("Liquid Preparation (PER_LIQUIDPREPARATION) - Delete"),this.getliquidPreparationData()}getliquidPreparationData(){this.loading=!0,this.liquidPreparationService.getliquidPreparationList().subscribe(e=>{this.liquidPreparationData=e,console.log("liquidPreparationData list",this.liquidPreparationData),this.loading=!1},e=>{this.error=e,this.loading=!1})}removeliquidPreparation(e){confirm("Are you sure, you want to delete this Liquid Preparation?")&&this.liquidPreparationService.DeleteLiquidPreparation(e).subscribe(()=>{this.getliquidPreparationData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(e){this.searchData=Object.assign({},e),console.log("serach data",this.searchData)}isActiveRow(e){return{"text-danger":!e.isActive}}static#t=this.\u0275fac=function(n){return new(n||a)(t.rXU(I),t.rXU(D.tw),t.rXU(T.n))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-list"]],decls:20,vars:15,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","class","app-button btn",3,"routerLink",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","StartDate","prop","startDateTime"],["ngx-datatable-cell-template",""],["name","End Date","prop","endDateTime"],["name","Shift","prop","shiftName"],["name","Actions",3,"sortable",4,"ngIf"],["mat-flat-button","",1,"app-button","btn",3,"routerLink"],[1,"icon-plus"],["name","Actions",3,"sortable"],["class","button-padding icon-green",3,"routerLink",4,"ngIf"],["type","button","style","border: none; background-color: white; color: red;",3,"click",4,"ngIf"],[1,"button-padding","icon-green",3,"routerLink"],["type","button",2,"border","none","background-color","white","color","red",3,"click"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Liquid Preparation List"),t.k0s()(),t.j41(7,"div",6),t.DNE(8,B,4,2,"a",7),t.k0s()(),t.j41(9,"div",8)(10,"div",9)(11,"ngx-datatable",10),t.nI1(12,"searchtable"),t.j41(13,"ngx-datatable-column",11),t.DNE(14,$,3,4,"ng-template",12),t.k0s(),t.j41(15,"ngx-datatable-column",13),t.DNE(16,V,3,4,"ng-template",12),t.k0s(),t.j41(17,"ngx-datatable-column",14),t.DNE(18,M,2,1,"ng-template",12),t.k0s(),t.DNE(19,O,2,1,"ngx-datatable-column",15),t.k0s()()()()()()),2&n&&(t.R7$(8),t.Y8G("ngIf",i.IsAddPemission),t.R7$(3),t.Y8G("rows",t.i5U(12,11,i.liquidPreparationData,i.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",i.loading)("scrollbarH",!0)("messages",t.lJ4(14,R)),t.R7$(8),t.Y8G("ngIf",i.IsEditPermission||i.IsDeletePermission))},dependencies:[p.bT,h.Wk,_.It,P.An,k.ge,k.ed,k.QI,p.vh,N.j],styles:[".ngx-datatable .datatable-header-cell{background-color:#17bb58!important;color:#fff!important}.icon-green[_ngcontent-%COMP%]{color:green}.btn[_ngcontent-%COMP%]{background-color:#17bb58!important;color:#fff!important}  .ngx-datatable.material .datatable-body .progress-linear .container{background-color:#90ee90}  .ngx-datatable.material .datatable-body .progress-linear .container .bar{background-color:green}"]})}return a})();var d=l(9417),W=l(1528),b=l(2102),y=l(9631),X=l(2798),j=l(6600),A=l(5951),f=l(6850),U=l(7133),g=l(8910);function H(a,s){if(1&a){const e=t.RV6();t.j41(0,"a",24),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.cancel())}),t.EFF(1," View List "),t.k0s()}}function J(a,s){1&a&&(t.j41(0,"mat-icon",25),t.EFF(1,"work"),t.k0s(),t.EFF(2," Basic "))}function z(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.poNumber," ")}}function K(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.productName," ")}}function Z(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.shiftName," ")}}function tt(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.tankName," ")}}function et(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function it(a,s){if(1&a){const e=t.RV6();t.j41(0,"form",26,0)(2,"div",27)(3,"div",28)(4,"div",29)(5,"div",30)(6,"mat-form-field",31)(7,"input",32),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onStartDateChange())}),t.k0s(),t.j41(8,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.sdS(12);return t.Njj(i.open())}),t.j41(9,"mat-icon"),t.EFF(10,"calendar_today"),t.k0s()(),t.nrm(11,"ngx-mat-datetime-picker",34,1),t.k0s()(),t.j41(13,"div",30)(14,"mat-form-field",31)(15,"input",35),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onEndDateChange())}),t.k0s(),t.j41(16,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.sdS(20);return t.Njj(i.open())}),t.j41(17,"mat-icon"),t.EFF(18,"calendar_today"),t.k0s()(),t.nrm(19,"ngx-mat-datetime-picker",34,2),t.k0s()(),t.j41(21,"div",30)(22,"mat-form-field",36)(23,"mat-label"),t.EFF(24,"Production Order"),t.k0s(),t.j41(25,"mat-select",37),t.DNE(26,z,2,2,"mat-option",38),t.k0s(),t.nrm(27,"mat-validation-message",39),t.k0s()(),t.j41(28,"div",30)(29,"mat-form-field",36)(30,"mat-label"),t.EFF(31,"Product"),t.k0s(),t.j41(32,"mat-select",40),t.DNE(33,K,2,2,"mat-option",38),t.k0s(),t.nrm(34,"mat-validation-message",39),t.k0s()(),t.j41(35,"div",30)(36,"mat-form-field",36)(37,"mat-label"),t.EFF(38,"Shift"),t.k0s(),t.j41(39,"mat-select",41),t.DNE(40,Z,2,2,"mat-option",38),t.k0s(),t.nrm(41,"mat-validation-message",39),t.k0s()(),t.j41(42,"div",30)(43,"mat-form-field",36)(44,"mat-label"),t.EFF(45,"Batch Lot Number"),t.k0s(),t.nrm(46,"input",42)(47,"mat-validation-message",39),t.k0s()(),t.j41(48,"div",30)(49,"mat-form-field",36)(50,"mat-label"),t.EFF(51,"Tank"),t.k0s(),t.j41(52,"mat-select",43),t.DNE(53,tt,2,2,"mat-option",38),t.k0s(),t.nrm(54,"mat-validation-message",39),t.k0s()(),t.j41(55,"div",30)(56,"mat-form-field",36)(57,"mat-label"),t.EFF(58,"Compounder"),t.k0s(),t.j41(59,"mat-select",44),t.DNE(60,et,2,2,"mat-option",38),t.k0s(),t.nrm(61,"mat-validation-message",39),t.k0s()(),t.j41(62,"div",30)(63,"mat-form-field",36)(64,"mat-label"),t.EFF(65,"Standard Batch Weight"),t.k0s(),t.nrm(66,"input",45)(67,"mat-validation-message",39),t.k0s()()()()()()}if(2&a){const e=t.sdS(12),n=t.sdS(20),i=t.XpG();t.Y8G("formGroup",i.basicForm),t.R7$(7),t.Y8G("ngxMatDatetimePicker",e),t.R7$(8),t.Y8G("ngxMatDatetimePicker",n),t.R7$(10),t.Y8G("disabled",i.isEditMode),t.R7$(),t.Y8G("ngForOf",i.productionOrderList),t.R7$(),t.Y8G("control",i.basicForm.get("SAPProductionOrderId"))("message","Production Order")("formSubmitted",i.isBasicFormSubmitted),t.R7$(5),t.Y8G("disabled",i.isEditMode),t.R7$(),t.Y8G("ngForOf",i.productList),t.R7$(),t.Y8G("control",i.basicForm.controls.ProductId)("message","Product")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.shiftList),t.R7$(),t.Y8G("control",i.basicForm.controls.ShiftId)("message","Shift")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("control",i.basicForm.controls.BatchLotNumber)("message","Batch Lot Number")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.tankList),t.R7$(),t.Y8G("control",i.basicForm.controls.TankId)("message","Tank")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.usersList),t.R7$(),t.Y8G("control",i.basicForm.controls.CompounderUserId)("message","Compounder")("formSubmitted",i.isBasicFormSubmitted),t.R7$(6),t.Y8G("control",i.basicForm.controls.StandardBatchWeight)("message","Standard Batch Weight")("formSubmitted",i.isBasicFormSubmitted)}}function at(a,s){1&a&&(t.j41(0,"mat-icon",25),t.EFF(1,"check_circle_outline"),t.k0s(),t.EFF(2," Start Checklist "))}function nt(a,s){1&a&&(t.j41(0,"mat-form-field",36)(1,"mat-label"),t.EFF(2,"Reason"),t.k0s(),t.nrm(3,"input",58),t.k0s())}function ot(a,s){if(1&a){const e=t.RV6();t.j41(0,"div",49)(1,"div",29)(2,"div",50)(3,"mat-label"),t.EFF(4),t.k0s()(),t.j41(5,"div",51)(6,"mat-radio-group",52),t.bIt("change",function(i){const o=t.eBV(e).index,r=t.XpG(2);return t.Njj(r.onAnswerChange(i,o))}),t.j41(7,"mat-radio-button",53),t.EFF(8,"Yes"),t.k0s(),t.j41(9,"mat-radio-button",54),t.EFF(10,"No"),t.k0s(),t.j41(11,"mat-radio-button",55),t.EFF(12,"NA"),t.k0s()()(),t.j41(13,"div",56),t.DNE(14,nt,4,0,"mat-form-field",57),t.k0s()()()}if(2&a){const e=s.$implicit;t.Y8G("formGroupName",s.index),t.R7$(4),t.JRh(e.get("question").value),t.R7$(10),t.Y8G("ngIf","NA"===e.get("answer").value)}}function st(a,s){if(1&a&&(t.j41(0,"form",26,0)(2,"div",27)(3,"div",28)(4,"div",29)(5,"div",47),t.DNE(6,ot,15,3,"div",48),t.k0s()()()()()),2&a){const e=t.XpG();t.Y8G("formGroup",e.StartCheckListForm),t.R7$(6),t.Y8G("ngForOf",e.questionsArray.controls)}}function rt(a,s){1&a&&(t.j41(0,"mat-icon",25),t.EFF(1,"format_list_bulleted"),t.k0s(),t.EFF(2," Instructions "))}function dt(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.instruction," ")}}function lt(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.materialName," ")}}function ct(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function mt(a,s){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"date"),t.k0s(),t.j41(16,"td")(17,"button",79),t.bIt("click",function(){const i=t.eBV(e),o=i.$implicit,r=i.index,u=t.XpG(2);return t.Njj(u.onEditDetail(o,r))}),t.nrm(18,"i",80),t.k0s(),t.j41(19,"button",81),t.bIt("click",function(){const i=t.eBV(e).index,o=t.XpG(2);return t.Njj(o.removeDetail(i))}),t.nrm(20,"i",82),t.k0s()()()}if(2&a){const e=s.$implicit;t.R7$(2),t.SpI(" ",e.InstructionName," "),t.R7$(2),t.SpI(" ",e.MaterialName," "),t.R7$(2),t.SpI(" ",e.LotNumber," "),t.R7$(2),t.SpI(" ",e.Weight," "),t.R7$(2),t.SpI(" ",e.WeightAdded," "),t.R7$(2),t.SpI(" ",e.DoneByNames," "),t.R7$(2),t.SpI(" ",t.i5U(15,7,e.AddedTime,"yyyy-MM-dd HH:mm:ss")," ")}}function ut(a,s){if(1&a){const e=t.RV6();t.j41(0,"form",26,0)(2,"div",59)(3,"div",60)(4,"h5",11),t.EFF(5,"Instruction Details"),t.k0s()(),t.j41(6,"div",28)(7,"div",29)(8,"div",30)(9,"mat-form-field",36)(10,"mat-label"),t.EFF(11,"Instruction"),t.k0s(),t.j41(12,"mat-select",61),t.bIt("selectionChange",function(i){t.eBV(e);const o=t.XpG();return t.Njj(o.onInstructionChange(i))}),t.DNE(13,dt,2,2,"mat-option",38),t.k0s(),t.nrm(14,"mat-validation-message",39),t.k0s()(),t.j41(15,"div",30)(16,"mat-form-field",36)(17,"mat-label"),t.EFF(18,"Material"),t.k0s(),t.j41(19,"mat-select",62),t.DNE(20,lt,2,2,"mat-option",38),t.k0s(),t.nrm(21,"mat-validation-message",39),t.k0s()(),t.j41(22,"div",30)(23,"mat-form-field",36)(24,"mat-label"),t.EFF(25,"Lot Number"),t.k0s(),t.nrm(26,"input",63)(27,"mat-validation-message",39),t.k0s()(),t.j41(28,"div",30)(29,"mat-form-field",36)(30,"mat-label"),t.EFF(31,"Weight"),t.k0s(),t.nrm(32,"input",64)(33,"mat-validation-message",39),t.k0s()(),t.j41(34,"div",30)(35,"mat-form-field",36)(36,"mat-label"),t.EFF(37,"Weight Added"),t.k0s(),t.nrm(38,"input",65)(39,"mat-validation-message",39),t.k0s()(),t.j41(40,"div",30)(41,"mat-form-field",36)(42,"mat-label"),t.EFF(43,"Done By"),t.k0s(),t.j41(44,"mat-select",66),t.DNE(45,ct,2,2,"mat-option",38),t.k0s(),t.nrm(46,"mat-validation-message",39),t.k0s()(),t.j41(47,"div",30)(48,"mat-form-field",36)(49,"mat-label"),t.EFF(50,"Added Time"),t.k0s(),t.nrm(51,"input",67)(52,"mat-validation-message",39),t.k0s()(),t.j41(53,"div",68)(54,"button",69),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addInstruction())}),t.j41(55,"mat-icon"),t.EFF(56,"add"),t.k0s()()()()()(),t.j41(57,"div",29)(58,"div",70)(59,"div",71)(60,"table",72)(61,"thead",73)(62,"tr")(63,"th",74),t.EFF(64,"Instruction"),t.k0s(),t.j41(65,"th",75),t.EFF(66,"Material & Part Code"),t.k0s(),t.j41(67,"th",75),t.EFF(68,"Lot Number "),t.k0s(),t.j41(69,"th",75),t.EFF(70,"Weight (kg)"),t.k0s(),t.j41(71,"th",75),t.EFF(72,"Weight Added (kg)"),t.k0s(),t.j41(73,"th",75),t.EFF(74,"Done By"),t.k0s(),t.j41(75,"th",75),t.EFF(76," Added Time "),t.k0s(),t.j41(77,"th",75),t.EFF(78,"Action"),t.k0s()()(),t.j41(79,"tbody"),t.DNE(80,mt,21,10,"tr",76),t.j41(81,"tr")(82,"td",77)(83,"strong"),t.EFF(84,"Total"),t.k0s()(),t.j41(85,"td")(86,"strong"),t.EFF(87),t.k0s()(),t.j41(88,"td")(89,"strong"),t.EFF(90),t.k0s()(),t.nrm(91,"td",78),t.k0s()()()()()()()}if(2&a){const e=t.XpG();t.Y8G("formGroup",e.InstructionForm),t.R7$(13),t.Y8G("ngForOf",e.productInstructionDetailsList),t.R7$(),t.Y8G("control",e.InstructionForm.controls.InstructionId)("message","Instruction")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.materialMasterList),t.R7$(),t.Y8G("control",e.InstructionForm.controls.MaterialId)("message","Material")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.LotNumber)("message","Lot Number")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.Weight)("message","Weight")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.WeightAdded)("message","Weight Added")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.usersList),t.R7$(),t.Y8G("control",e.InstructionForm.controls.DoneByIds)("message","Done By")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",e.InstructionForm.controls.AddedTime)("message","Added Time")("formSubmitted",e.isInstructionFormSubmitted),t.R7$(28),t.Y8G("ngForOf",e.AddedInstructionList),t.R7$(7),t.JRh(e.totalWeight),t.R7$(3),t.JRh(e.totalWeightAdded)}}function pt(a,s){1&a&&(t.j41(0,"mat-icon",25),t.EFF(1,"check_circle_outline"),t.k0s(),t.EFF(2," End Checklist "))}function ht(a,s){1&a&&(t.j41(0,"mat-form-field",36)(1,"mat-label"),t.EFF(2,"Reason"),t.k0s(),t.nrm(3,"input",58),t.k0s())}function ft(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.tankName," ")}}function gt(a,s){if(1&a&&(t.j41(0,"mat-form-field",36)(1,"mat-label"),t.EFF(2,"Tank"),t.k0s(),t.j41(3,"mat-select",83),t.DNE(4,ft,2,2,"mat-option",38),t.k0s()()),2&a){const e=t.XpG(3);t.R7$(4),t.Y8G("ngForOf",e.tankList)}}function _t(a,s){if(1&a){const e=t.RV6();t.j41(0,"div",49)(1,"div",29)(2,"div",50)(3,"mat-label"),t.EFF(4),t.k0s()(),t.j41(5,"div",51)(6,"mat-radio-group",52),t.bIt("change",function(i){const o=t.eBV(e).index,r=t.XpG(2);return t.Njj(r.onAnswerChange(i,o))}),t.j41(7,"mat-radio-button",53),t.EFF(8,"Yes"),t.k0s(),t.j41(9,"mat-radio-button",54),t.EFF(10,"No"),t.k0s(),t.j41(11,"mat-radio-button",55),t.EFF(12,"NA"),t.k0s()()(),t.j41(13,"div",56),t.DNE(14,ht,4,0,"mat-form-field",57)(15,gt,5,1,"mat-form-field",57),t.k0s()()()}if(2&a){const e=s.$implicit;t.Y8G("formGroupName",s.index),t.R7$(4),t.JRh(e.get("question").value),t.R7$(10),t.Y8G("ngIf","NA"===e.get("answer").value),t.R7$(),t.Y8G("ngIf",27==e.get("id").value&&"Yes"===e.get("answer").value)}}function bt(a,s){if(1&a&&(t.j41(0,"form",26,0)(2,"div",27)(3,"div",28)(4,"div",29)(5,"div",47),t.DNE(6,_t,16,4,"div",48),t.k0s()()()()()),2&a){const e=t.XpG();t.Y8G("formGroup",e.EndCheckListForm),t.R7$(6),t.Y8G("ngForOf",e.EndquestionsArray.controls)}}function It(a,s){1&a&&(t.j41(0,"mat-icon",25),t.EFF(1,"push_pin"),t.k0s(),t.EFF(2," Quality "))}function kt(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function Ft(a,s){if(1&a&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&a){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.specificationName," ")}}function vt(a,s){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.nI1(10,"date"),t.k0s(),t.j41(11,"td"),t.EFF(12),t.nI1(13,"date"),t.k0s(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.j41(18,"td"),t.EFF(19),t.k0s(),t.j41(20,"td")(21,"button",93),t.bIt("click",function(){const i=t.eBV(e),o=i.$implicit,r=i.index,u=t.XpG(2);return t.Njj(u.onEditQualityDetail(o,r))}),t.nrm(22,"i",80),t.k0s(),t.j41(23,"button",81),t.bIt("click",function(){const i=t.eBV(e).index,o=t.XpG(2);return t.Njj(o.removeQualityDetail(i))}),t.nrm(24,"i",82),t.k0s()()()}if(2&a){const e=s.$implicit,n=s.index;t.R7$(2),t.SpI(" ",n+1," "),t.R7$(2),t.SpI(" ",t.i5U(5,8,e.TestingDateTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",e.DoneByNames," "),t.R7$(2),t.SpI(" ",t.i5U(10,11,e.SampleReceivedTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",t.i5U(13,14,e.SampleTestedTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",e.SpecificationLimitName," "),t.R7$(2),t.SpI(" ",e.Test1," "),t.R7$(2),t.SpI(" ",e.Test2," ")}}function Et(a,s){if(1&a){const e=t.RV6();t.j41(0,"form",26,0)(2,"div",59)(3,"div",60)(4,"h5",11),t.EFF(5,"Quality Details"),t.k0s()(),t.j41(6,"div",28)(7,"div",29)(8,"div",30)(9,"mat-form-field",31)(10,"input",84),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onTestingDateTimeChange())}),t.k0s(),t.j41(11,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.sdS(15);return t.Njj(i.open())}),t.j41(12,"mat-icon"),t.EFF(13,"calendar_today"),t.k0s()(),t.nrm(14,"ngx-mat-datetime-picker",34,3),t.k0s()(),t.j41(16,"div",30)(17,"mat-form-field",36)(18,"mat-label"),t.EFF(19,"Analysis Done By"),t.k0s(),t.j41(20,"mat-select",85),t.DNE(21,kt,2,2,"mat-option",38),t.k0s(),t.nrm(22,"mat-validation-message",39),t.k0s()(),t.j41(23,"div",30)(24,"mat-form-field",31)(25,"input",86),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onRecieveDateChange())}),t.k0s(),t.j41(26,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.sdS(30);return t.Njj(i.open())}),t.j41(27,"mat-icon"),t.EFF(28,"calendar_today"),t.k0s()(),t.nrm(29,"ngx-mat-datetime-picker",34,4),t.k0s()(),t.j41(31,"div",30)(32,"mat-form-field",31)(33,"input",87),t.bIt("dateChange",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.onTestedDateChange())}),t.k0s(),t.j41(34,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.sdS(38);return t.Njj(i.open())}),t.j41(35,"mat-icon"),t.EFF(36,"calendar_today"),t.k0s()(),t.nrm(37,"ngx-mat-datetime-picker",34,5),t.k0s()(),t.j41(39,"div",30)(40,"mat-form-field",36)(41,"mat-label"),t.EFF(42,"Specification Limit"),t.k0s(),t.j41(43,"mat-select",88),t.DNE(44,Ft,2,2,"mat-option",38),t.k0s(),t.nrm(45,"mat-validation-message",39),t.k0s()(),t.j41(46,"div",30)(47,"mat-form-field",36)(48,"mat-label"),t.EFF(49,"Result"),t.k0s(),t.nrm(50,"input",89),t.k0s()(),t.j41(51,"div",30)(52,"mat-form-field",36)(53,"mat-label"),t.EFF(54," Comments"),t.k0s(),t.nrm(55,"input",90),t.k0s()(),t.j41(56,"div",68)(57,"button",69),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.addQuality())}),t.j41(58,"mat-icon"),t.EFF(59,"add"),t.k0s()()()()()(),t.j41(60,"div",29)(61,"div",91)(62,"div",71)(63,"table",92)(64,"thead",73)(65,"tr")(66,"th",75),t.EFF(67,"Id"),t.k0s(),t.j41(68,"th",75),t.EFF(69,"Date Tested"),t.k0s(),t.j41(70,"th",75),t.EFF(71,"Analysis Done By"),t.k0s(),t.j41(72,"th",75),t.EFF(73,"Sample Received At"),t.k0s(),t.j41(74,"th",75),t.EFF(75,"Sample Tested At"),t.k0s(),t.j41(76,"th",75),t.EFF(77,"Specification Limit"),t.k0s(),t.j41(78,"th",75),t.EFF(79,"Result"),t.k0s(),t.j41(80,"th",75),t.EFF(81,"Comments"),t.k0s(),t.j41(82,"th",75),t.EFF(83,"Action"),t.k0s()()(),t.j41(84,"tbody"),t.DNE(85,vt,25,17,"tr",76),t.k0s()()()()()()}if(2&a){const e=t.sdS(15),n=t.sdS(30),i=t.sdS(38),o=t.XpG();t.Y8G("formGroup",o.QualityForm),t.R7$(10),t.Y8G("ngxMatDatetimePicker",e),t.R7$(11),t.Y8G("ngForOf",o.usersList),t.R7$(),t.Y8G("control",o.QualityForm.controls.AnalysisDoneByIds)("message","Analysis Done By")("formSubmitted",o.isQualityFormSubmitted),t.R7$(3),t.Y8G("ngxMatDatetimePicker",n),t.R7$(8),t.Y8G("ngxMatDatetimePicker",i),t.R7$(11),t.Y8G("ngForOf",o.qCTSpecificationMasterList),t.R7$(),t.Y8G("control",o.QualityForm.controls.SpecificationLimitId)("message","Material")("formSubmitted",o.isQualityFormSubmitted),t.R7$(40),t.Y8G("ngForOf",o.AddedQualityList)}}function Lt(a,s){1&a&&(t.j41(0,"mat-icon",25),t.EFF(1,"settings"),t.k0s(),t.EFF(2," Adjustment "))}function St(a,s){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"number"),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s()()),2&a){const e=s.$implicit;t.R7$(2),t.SpI(" ",e.MaterialName," "),t.R7$(2),t.SpI(" ",e.Weight," "),t.R7$(2),t.SpI(" ",t.i5U(7,4,e.diffWeight,"1.2-2")," "),t.R7$(3),t.SpI(" ",e.WeightAdded," ")}}function Dt(a,s){if(1&a&&(t.j41(0,"div",59)(1,"div",60)(2,"h5",11),t.EFF(3,"Adjustment Details"),t.k0s()(),t.j41(4,"div",28)(5,"div",29)(6,"div",70)(7,"div",71)(8,"table",94)(9,"thead",73)(10,"tr",95)(11,"th",96),t.EFF(12,"Material & Part Code"),t.k0s(),t.j41(13,"th",96),t.EFF(14,"Weight "),t.k0s(),t.j41(15,"th",74),t.EFF(16,"Adjustment"),t.k0s(),t.j41(17,"th",96),t.EFF(18,"Total"),t.k0s()()(),t.j41(19,"tbody"),t.DNE(20,St,10,7,"tr",76),t.k0s()()()()()()()),2&a){const e=t.XpG();t.R7$(20),t.Y8G("ngForOf",e.DiffWghInstructionList)}}function Tt(a,s){if(1&a){const e=t.RV6();t.j41(0,"button",97),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.goToNextTab())}),t.EFF(1,"Draft &Next"),t.k0s()}if(2&a){const e=t.XpG();t.Y8G("disabled",e.selectedIndex===e.tabCount-1)}}function Pt(a,s){if(1&a){const e=t.RV6();t.j41(0,"button",98),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.Submit())}),t.EFF(1,"Submit"),t.k0s()}}let F=(()=>{class a{constructor(e,n,i,o,r,u,c,E){this.activatedRoute=e,this.router=n,this.formBuilder=i,this.liquidPreparationService=o,this.notificationService=r,this.weightCheckService=u,this.cdr=c,this.permissionService=E,this.selectedIndex=0,this.tabCount=6,this.isstartChecklistDisable=!0,this.isInstructionsDisable=!0,this.isEndChecklistDisable=!0,this.isQualityDisable=!0,this.isAdjustmentDisable=!0,this.page=m.Wt.liquidPreparation,this.permissions=m.eZ,this.isEndDateOk=!0,this.StartCheckListQueList=[],this.AddedInstructionList=[],this.DiffWghInstructionList=[],this.EditInstructionId=-1,this.totalWeight=0,this.totalWeightAdded=0,this.EndCheckListQueList=[],this.AddedQualityList=[],this.EditQualityId=-1,this.shiftList=[],this.productionOrderList=[],this.productList=[],this.usersList=[],this.startEndBatchChecklist=[],this.materialMasterList=[],this.productInstructionDetailsList=[],this.qCTSpecificationMasterList=[],this.tankList=[],this.IsValidTestedDate=!0,this.IsValidQualitydDate=!0,this.IsViewPermission=!1,this.createForm()}ngOnInit(){this.loadDropdowns(),this.getRoute(),this.IsViewPermission=this.permissionService.hasPermission("Liquid Preparation (PER_LIQUIDPREPARATION) - View")}getRoute(){this.routerSub=this.activatedRoute.params.subscribe(e=>{this.isEditMode=!m.ov.isEmpty(e.id),this.createForm(),this.isEditMode&&(this.liquidPreparationId=e.id,this.getLiquidPreparationById())})}goToPreviousTab(){this.selectedIndex>0&&this.selectedIndex--}goToNextTab(){if(0===this.selectedIndex)this.isBasicFormSubmitted=!0,console.log("basic form value",this.basicForm.value),this.basicForm.valid&&this.isEndDateOk&&(this.draftBasicFormValue=this.basicForm.value,this.isstartChecklistDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++);else if(1===this.selectedIndex){this.isStartCheckListFormSubmitted=!0,console.log("start check form value",this.StartCheckListForm.value);let e=this.StartCheckListValidation();this.StartCheckListForm.valid&&e&&(this.draftStartCheckListFormValue=this.StartCheckListForm.value,this.isInstructionsDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++)}else if(2===this.selectedIndex){if(this.AddedInstructionList.length<=0)return void this.notificationService.error("select at least one instruction");this.DiffWghInstructionList=[],this.AddedInstructionList.forEach(e=>{(e.diffWeight>0||e.diffWeight<0)&&this.DiffWghInstructionList.push(e)}),this.isEndChecklistDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++}else if(3===this.selectedIndex){this.isEndCheckListFormSubmitted=!0,console.log("end check form value",this.EndCheckListForm.value);let e=this.EndCheckListValidation();this.EndCheckListForm.valid&&e&&(this.draftEndCheckListFormValue=this.EndCheckListForm.value,this.isQualityDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++)}else if(4===this.selectedIndex){if(this.AddedQualityList.length<=0)return void this.notificationService.error("select at least one Quality");this.isAdjustmentDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++}else 5===this.selectedIndex&&console.log("added adjustment",this.DiffWghInstructionList)}onEndDateChange(){const e=this.basicForm.get("EndDateTime")?.value,n=this.basicForm.get("StartDateTime")?.value;n||(this.notificationService.error("please select Start date"),this.isEndDateOk=!1),n&&e&&new Date(e)<=new Date(n)?(this.notificationService.error("End date should be greated than Start date"),this.isEndDateOk=!1):(this.basicForm.get("EndDateTime")?.updateValueAndValidity(),this.isEndDateOk=!0)}getLiquidPreparationById(){this.liquidPreparationService.getByIdLiquidPreparation(this.liquidPreparationId).subscribe(e=>{this.liquidPreparationData=e,this.setLiquidPreparationkData(),console.log("get by id data",e)},e=>{console.log(e)})}setLiquidPreparationkData(){this.basicForm.patchValue({StartDateTime:this.liquidPreparationData.startDateTime,EndDateTime:this.liquidPreparationData.endDateTime,SAPProductionOrderId:this.liquidPreparationData.sapProductionOrderId,ProductId:this.liquidPreparationData.productId,ShiftId:this.liquidPreparationData.shiftId,BatchLotNumber:parseInt(this.liquidPreparationData.batchLotNumber),TankId:this.liquidPreparationData.tankId,CompounderUserId:this.liquidPreparationData.compounderUserId,StandardBatchWeight:parseInt(this.liquidPreparationData.standardBatchWeight)}),this.basicForm.get("SAPProductionOrderId").disable(),this.basicForm.get("ProductId").disable(),setTimeout(()=>{let e=[],n=[];this.liquidPreparationData.liquidPreparationChecklistDetails.forEach(i=>{"1"===i.type?e.push(i):n.push(i)}),e.forEach(i=>{const o=this.StartCheckListForm.get("questions")?.value.find(r=>r.id===i.questionId);if(o){const r=this.StartCheckListForm.get("questions")?.value.indexOf(o);-1!==r&&this.StartCheckListForm.get("questions").at(r).patchValue({answer:i.answer,tankId:i.tankId?i.tankId:"",tankNo:i.tankNo?i.tankNo:"",reason:i.reason})}}),n.forEach(i=>{const o=this.EndCheckListForm.get("questions")?.value.find(r=>r.id===i.questionId);if(o){const r=this.EndCheckListForm.get("questions")?.value.indexOf(o);-1!==r&&this.EndCheckListForm.get("questions").at(r).patchValue({answer:i.answer,tankId:i.tankId?i.tankId:"",tankNo:i.tankNo?i.tankNo:"",reason:i.reason})}}),this.liquidPreparationData.liquidPreparationInstructionDetails.forEach(i=>{let o=i.weightAdded-i.weight;console.log("difference",o);let r=this.usersList.filter(c=>i.doneByIds?.includes(c.id)).map(c=>c.name).join(", "),u={InstructionId:i.instructionId,MaterialId:i.materialId,LotNumber:parseInt(i.lotNumber),Weight:i.weight,WeightAdded:i.weightAdded,DoneByIds:i.doneByIds.split(",").map(c=>parseInt(c,10)),AddedTime:i.addedTime,diffWeight:o,DoneByNames:r,InstructionName:this.productInstructionDetailsList.find(c=>c.id==i.instructionId)?.instruction,MaterialName:this.materialMasterList.find(c=>c.id==i.materialId)?.materialName};this.AddedInstructionList.push(u)}),this.calculateTotals(),this.liquidPreparationData.liquidPreparationSpecificationDetails.forEach(i=>{let r=this.usersList.filter(c=>i.analysisDoneByIds?.includes(c.id)).map(c=>c.name).join(", "),u={TestingDateTime:i.testingDateTime,AnalysisDoneByIds:i.analysisDoneByIds.split(",").map(c=>parseInt(c,10)),SampleReceivedTime:i.sampleReceivedTime,SampleTestedTime:i.sampleTestedTime,SpecificationLimitId:i.specificationLimitId,Test1:i.test1,Test2:i.test2,DoneByNames:r,SpecificationLimitName:this.qCTSpecificationMasterList.find(c=>c.id==i.specificationLimitId)?.specificationName};this.AddedQualityList.push(u)}),console.log("EditPrechecklistData",e)},1e3)}loadDropdowns(){this.weightCheckService.getProductionOrderList().subscribe(e=>{this.productionOrderList=e}),this.weightCheckService.getProductList().subscribe(e=>{this.productList=e}),this.weightCheckService.getUserList().subscribe(e=>{this.usersList=e}),this.weightCheckService.getShiftList().subscribe(e=>{this.shiftList=e}),this.liquidPreparationService.getTankMasterList().subscribe(e=>{this.tankList=e}),this.liquidPreparationService.getStartEndBatchCheckList().subscribe(e=>{this.startEndBatchChecklist=e,this.StartCheckListQueList=e.filter(n=>"1"===n.type),this.EndCheckListQueList=e.filter(n=>"2"===n.type),this.CreateStartChecklIstForm(),this.CreateEndChecklIstForm()}),this.liquidPreparationService.getMaterialMasterList().subscribe(e=>{this.materialMasterList=e}),this.liquidPreparationService.getQCTSpecificationMasterList().subscribe(e=>{this.qCTSpecificationMasterList=e}),this.liquidPreparationService.getProductInstructionDetailsList().subscribe(e=>{this.productInstructionDetailsList=e})}createForm(){this.basicForm=this.formBuilder.group({Id:[{value:"",disabled:!0}],Code:["",""],StartDateTime:["",[d.k0.required]],EndDateTime:["",[d.k0.required]],SAPProductionOrderId:["",[d.k0.required]],ProductId:["",[d.k0.required]],ShiftId:["",[d.k0.required]],BatchLotNumber:["",[d.k0.required]],TankId:["",[d.k0.required]],CompounderUserId:["",[d.k0.required]],StandardBatchWeight:["",[d.k0.required]]}),this.basicForm.controls.StartDateTime.setValue((new Date).toISOString().split("T")[0]),this.CreateInstructionForm(),this.CreateQualityForm()}CreateStartChecklIstForm(){this.StartCheckListForm=this.formBuilder.group({questions:this.formBuilder.array(this.createQuestionControls())})}CreateInstructionForm(){this.EditInstructionId=-1,this.InstructionForm=this.formBuilder.group({InstructionId:["",[d.k0.required]],MaterialId:["",[d.k0.required]],LotNumber:["",[d.k0.required]],Weight:["",[d.k0.required]],WeightAdded:["",[d.k0.required]],DoneByIds:["",[d.k0.required]],AddedTime:["",[d.k0.required]]})}CreateEndChecklIstForm(){this.EndCheckListForm=this.formBuilder.group({questions:this.formBuilder.array(this.createEndQuestionControls())})}CreateQualityForm(){this.EditQualityId=-1,this.QualityForm=this.formBuilder.group({TestingDateTime:["",[d.k0.required]],AnalysisDoneByIds:["",[d.k0.required]],SampleReceivedTime:["",[d.k0.required]],SampleTestedTime:["",[d.k0.required]],SpecificationLimitId:["",[d.k0.required]],Test1:[""],Test2:[""]})}createQuestionControls(){return this.StartCheckListQueList.map(e=>this.formBuilder.group({id:[e.id],question:[e.question],answer:["Yes",d.k0.required],tankNo:[""],tankId:[""],reason:[""]}))}get questionsArray(){return this.StartCheckListForm.get("questions")}onAnswerChange(e,n){if(console.log("ebent & i",e,n),"No"===e.value){this.notificationService.error("You can't select NO");const i=this.StartCheckListForm.get("questions");if(n>=0){const o=i?.at(n);console.log("questiongroup",o),o&&(o.controls.answer?.setValue("Yes",{emitEvent:!0}),this.cdr.detectChanges())}else console.error("Index out of bounds")}}StartCheckListValidation(){const e=this.StartCheckListForm.get("questions");if(!e)return this.notificationService.error("Form is not initialized correctly."),!1;let n=!0;return e.controls.forEach((i,o)=>{const r=i,u=r.get("answer")?.value,c=r.get("reason")?.value;"NA"===u&&(!c||0===c.trim().length)&&(this.notificationService.error("Reason is mandatory when answer is 'NA'."),n=!1)}),n}createEndQuestionControls(){return this.EndCheckListQueList.map(e=>this.formBuilder.group({id:[e.id],question:[e.question],answer:["Yes",d.k0.required],tankNo:[""],tankId:[""],reason:[""]}))}get EndquestionsArray(){return this.EndCheckListForm.get("questions")}onEndAnswerChange(e,n){if(console.log("ebent & i",e,n),"No"===e.value){this.notificationService.error("You can't select NO");const i=this.EndCheckListForm.get("questions");if(n>=0){const o=i?.at(n);console.log("questiongroup",o),o&&(o.controls.answer?.setValue("Yes",{emitEvent:!0}),this.cdr.detectChanges())}else console.error("Index out of bounds")}}EndCheckListValidation(){const e=this.EndCheckListForm.get("questions");if(!e)return this.notificationService.error("Form is not initialized correctly."),!1;let n=!0;return e.controls.forEach((i,o)=>{const r=i,u=r.get("answer")?.value,c=r.get("reason")?.value,E=r.get("id")?.value,$t=r.get("tankId")?.value;"NA"===u&&(!c||0===c.trim().length)&&(this.notificationService.error("Reason is mandatory when answer is 'NA'."),n=!1),"Yes"===u&&27==E&&!$t&&(this.notificationService.error("Tank is mandatory when Storage tank available 'Yes' ."),n=!1)}),n}onInstructionChange(e){console.log("inst change",e);let n=this.productInstructionDetailsList.find(r=>r.id==e.value).weight;this.InstructionForm.controls.Weight.setValue(n),(new Date).toISOString(),this.InstructionForm.get("AddedTime")?.setValue(new Date)}addInstruction(){if(this.isInstructionFormSubmitted=!0,this.InstructionForm.valid){let e=this.InstructionForm.value;e.diffWeight=e.Weight!=e.WeightAdded?e.WeightAdded-e.Weight:0;let n=this.usersList.filter(o=>e.DoneByIds.includes(o.id)).map(o=>o.name).join(", ");e.DoneByNames=n,e.InstructionName=this.productInstructionDetailsList.find(o=>o.id==e.InstructionId).instruction,e.MaterialName=this.materialMasterList.find(o=>o.id==e.MaterialId).materialName,e.AddedTime=(new Date).toISOString(),console.log("Instruction form value",e),this.EditInstructionId>=0?(this.AddedInstructionList[this.EditInstructionId]=e,this.calculateTotals(),this.InstructionForm.reset(),this.isInstructionFormSubmitted=!1,this.CreateInstructionForm()):(this.AddedInstructionList.push(e),this.calculateTotals(),this.InstructionForm.reset(),this.isInstructionFormSubmitted=!1,this.CreateInstructionForm())}console.log("AddedInstructionList",this.AddedInstructionList)}calculateTotals(){this.totalWeight=this.AddedInstructionList.reduce((e,n)=>e+(n.Weight||0),0),this.totalWeightAdded=this.AddedInstructionList.reduce((e,n)=>e+(n.WeightAdded||0),0)}onEditDetail(e,n){console.log("details selected for edit",this.AddedInstructionList[n]);let i=this.AddedInstructionList[n];this.InstructionForm.patchValue({InstructionId:i.InstructionId,MaterialId:i.MaterialId,LotNumber:i.LotNumber,Weight:i.Weight,WeightAdded:i.WeightAdded,DoneByIds:i.DoneByIds,AddedTime:(new Date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),this.EditInstructionId=n}removeDetail(e){this.AddedInstructionList.splice(e,1),console.log("AddedInstructionList",this.AddedInstructionList)}onStartDateChange(){const e=this.basicForm.get("StartDateTime")?.value;this.StartDateOfBasicForm=new Date(e)}onTestingDateTimeChange(){const e=this.QualityForm.get("TestingDateTime")?.value,n=new Date(e);n&&n<this.StartDateOfBasicForm?(this.notificationService.error("Test date should be greated than Basic Start date"),this.QualityForm.get("TestingDateTime")?.reset(),this.IsValidQualitydDate=!1):(this.QualityForm.get("TestingDateTime")?.updateValueAndValidity(),this.IsValidQualitydDate=!0)}onRecieveDateChange(){const e=this.QualityForm.get("SampleReceivedTime")?.value,n=new Date(e);n&&n<this.StartDateOfBasicForm?(this.notificationService.error("Sample received date should be greated than Basic Start date"),this.QualityForm.get("SampleReceivedTime")?.reset(),this.IsValidQualitydDate=!1):(this.QualityForm.get("SampleReceivedTime")?.updateValueAndValidity(),this.IsValidQualitydDate=!0)}onTestedDateChange(){const e=this.QualityForm.get("SampleTestedTime")?.value,n=this.QualityForm.get("SampleReceivedTime")?.value,i=new Date(e),o=new Date(n);n?n&&e&&i<o?(this.notificationService.error("Sample tested date should be greated than sample recieved date"),this.QualityForm.get("SampleTestedTime")?.reset(),this.IsValidTestedDate=!1):(this.QualityForm.get("SampleTestedTime")?.updateValueAndValidity(),this.IsValidTestedDate=!0):(this.notificationService.error("please select Sample recieved date"),this.QualityForm.get("SampleTestedTime")?.reset(),this.IsValidTestedDate=!1)}addQuality(){if(this.isQualityFormSubmitted=!0,this.IsValidTestedDate)if(this.QualityForm.valid){let e=this.QualityForm.value;console.log("quality formvalue",e);let n=this.usersList.filter(i=>e.AnalysisDoneByIds.includes(i.id)).map(i=>i.name).join(", ");e.DoneByNames=n,e.SpecificationLimitName=this.qCTSpecificationMasterList.find(i=>i.id==e.SpecificationLimitId).specificationName,this.EditQualityId>=0?(this.AddedQualityList[this.EditQualityId]=e,this.QualityForm.reset(),this.isQualityFormSubmitted=!1,this.CreateQualityForm()):(this.AddedQualityList.push(e),this.QualityForm.reset(),this.isQualityFormSubmitted=!1,this.CreateQualityForm())}else this.notificationService.error("Invalid Data");else this.notificationService.error("Pl correct tested Date");console.log("AddedQualityList",this.AddedQualityList)}onEditQualityDetail(e,n){console.log("Quaitydetails selected for edit",this.AddedQualityList[n]);let i=this.AddedQualityList[n];this.QualityForm.patchValue({TestingDateTime:i.TestingDateTime,AnalysisDoneByIds:i.AnalysisDoneByIds,SampleReceivedTime:i.SampleReceivedTime,SampleTestedTime:i.SampleTestedTime,SpecificationLimitId:i.SpecificationLimitId,Test1:i.Test1,Test2:i.Test2}),this.EditQualityId=n}removeQualityDetail(e){this.AddedQualityList.splice(e,1),console.log("AddedQualityList",this.AddedQualityList)}getToday(){return(new Date).toISOString().split("T")[0]}createliquidPreparation(e){this.liquidPreparationService.addLiquidPreparation(e).subscribe(()=>{this.cancel(),this.notificationService.success("Liquid Preparation created successfully.")},n=>{this.error=n})}updateliquidPreparation(e){this.liquidPreparationService.updateLiquidPreparation(e).subscribe(()=>{this.cancel(),this.notificationService.success("Liquid Preparation updated successfully.")},n=>{this.error=n})}Submit(){console.log("draftBasicFormValue",this.draftBasicFormValue),console.log("draftStartCheckListFormValue",this.draftStartCheckListFormValue),console.log("AddedInstructionList",this.AddedInstructionList),console.log("draftEndCheckListFormValue",this.draftEndCheckListFormValue),console.log("AddedQualityList",this.AddedQualityList),console.log("DiffWghInstructionList",this.DiffWghInstructionList);let e=this.TransFormData();console.log("Playload",e),this.isEditMode?this.updateliquidPreparation(e):this.createliquidPreparation(e)}formatDateForSQL(e){return e&&e.isValid()?e.format("YYYY-MM-DDTHH:mm:ss"):null}TransFormData(){const e=[...this.draftStartCheckListFormValue.questions.map(i=>({...i,type:1})),...this.draftEndCheckListFormValue.questions.map(i=>({...i,type:2}))];return{Id:this.isEditMode?this.liquidPreparationId:0,Code:this.isEditMode?this.liquidPreparationData.code:"",StartDateTime:this.draftBasicFormValue.StartDateTime,EndDateTime:this.draftBasicFormValue.EndDateTime,SAPProductionOrderId:this.isEditMode?this.liquidPreparationData.sapProductionOrderId:this.draftBasicFormValue.SAPProductionOrderId,ProductId:this.isEditMode?this.liquidPreparationData.ProductId:this.draftBasicFormValue.ProductId,ShiftId:this.draftBasicFormValue.ShiftId,BatchLotNumber:this.draftBasicFormValue.BatchLotNumber.toString(),TankId:this.draftBasicFormValue.TankId,CompounderUserId:this.draftBasicFormValue.CompounderUserId,StandardBatchWeight:this.draftBasicFormValue.StandardBatchWeight.toString(),TestingDateTime:null,AnalysisDoneByIds:"",AnalysisDoneByList:null,SampleReceivedTime:null,SampleTestedTime:null,IsActive:!0,liquidPreparationAdjustmentDetails:this.DiffWghInstructionList.map(i=>({Id:0,LiquidPreparationId:0,MaterialId:i.MaterialId,LiquidPreparationInstructionId:i.InstructionId,Weight:i.WeightAdded,Adjustment:i.diffWeight,Total:i.Weight,IsActive:!0})),liquidPreparationChecklistDetails:e.map(i=>({Id:0,LiquidPreparationId:0,Type:i.type.toString(),QuestionId:i.id,Answer:i.answer,TankNo:i.tankNo||null,IsActive:!0,TankId:i.tankId||null,Reason:i.reason||""})),liquidPreparationInstructionDetails:this.AddedInstructionList.map(i=>({Id:0,LiquidPreparationId:0,InstructionId:i.InstructionId,MaterialId:i.MaterialId,LotNumber:i.LotNumber.toString(),Weight:i.Weight,WeightAdded:i.WeightAdded,DoneByList:i.DoneByIds.map(o=>`${o}`),AddedTime:i.AddedTime,IsActive:!0})),liquidPreparationSpecificationDetails:this.AddedQualityList.map(i=>({Id:0,LiquidPreparationId:0,SpecificationLimitId:i.SpecificationLimitId,Test1:i.Test1||"",Test2:i.Test2||"",TestingDateTime:i.TestingDateTime,AnalysisDoneByList:i.AnalysisDoneByIds.map(o=>`${o}`),SampleReceivedTime:i.SampleReceivedTime,SampleTestedTime:i.SampleTestedTime,IsActive:!0}))}}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(n){return new(n||a)(t.rXU(h.nX),t.rXU(h.Ix),t.rXU(d.ze),t.rXU(I),t.rXU(D.tw),t.rXU(W.Q),t.rXU(t.gRc),t.rXU(T.n))};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-add-edit"]],decls:35,vars:10,consts:[["form","ngForm"],["pickerStartDate",""],["pickerEndDate",""],["pickerTestingDateTime",""],["pickerSampleReceivedTime",""],["pickerSampleTestedTime",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","class","app-button back-Green",3,"click",4,"ngIf"],[1,"tab-group-container"],[1,"tab-group-bordered",3,"selectedIndexChange","selectedIndex"],["mat-tab-label",""],["matTabContent",""],[3,"disabled"],[1,"d-flex","justify-content-end",2,"margin-top","20px"],["mat-raised-button","",1,"back-Green",3,"click","disabled"],["mat-raised-button","","class","ms-4 back-Green",3,"disabled","click",4,"ngIf"],["mat-raised-button","","class","ms-4 back-Green",3,"click",4,"ngIf"],["mat-flat-button","",1,"app-button","back-Green",3,"click"],[1,"me-2"],["novalidate","",1,"app-form",3,"formGroup"],[1,"card","mb-4"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","mb-3"],["appearance","fill"],["matInput","","placeholder","Start Date","formControlName","StartDateTime","required","",3,"dateChange","ngxMatDatetimePicker"],["type","button","mat-icon-button","","matSuffix","",3,"click"],["apperance","fill"],["matInput","","placeholder","End Date","formControlName","EndDateTime","required","",3,"dateChange","ngxMatDatetimePicker"],["appearance","fill",1,"full-width"],["formControlName","SAPProductionOrderId",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"control","message","formSubmitted"],["formControlName","ProductId",3,"disabled"],["formControlName","ShiftId"],["matInput","","formControlName","BatchLotNumber","type","number"],["formControlName","TankId"],["formControlName","CompounderUserId"],["matInput","","formControlName","StandardBatchWeight","type","number"],[3,"value"],["formArrayName","questions"],["class","mb-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mb-3",3,"formGroupName"],[1,"col-12","col-sm-12","col-md-5","col-lg-5","mb-3"],[1,"col-12","col-sm-12","col-md-3","col-lg-3","mb-3"],["formControlName","answer",3,"change"],["value","Yes"],["value","No","disabled","true"],["value","NA"],[1,"col-12","col-sm-12","col-md-4","col-lg-4","mb-3"],["appearance","fill","class","full-width",4,"ngIf"],["matInput","","formControlName","reason"],[1,"card","mb-4","mt-4"],[1,"card-header"],["formControlName","InstructionId",3,"selectionChange"],["formControlName","MaterialId"],["matInput","","formControlName","LotNumber"],["matInput","","formControlName","Weight","type","number"],["matInput","","formControlName","WeightAdded","type","number"],["formControlName","DoneByIds","multiple",""],["matInput","","formControlName","AddedTime","readonly",""],[1,"col-12","col-sm-12","col-md-1","col-lg-1","mb-3","p-1","d-flex","align-items-center"],["type","button","mat-icon-button","",1,"icon-green",3,"click"],[1,"col-md-12"],[1,"table-responsive"],["id","gridNozzlewiseWeight",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner"],[1,"bg-primary","text-primary","text-center"],[1,"back-Green",2,"width","20%"],[1,"back-Green"],[4,"ngFor","ngForOf"],["colspan","3",1,"text-center"],["colspan","3"],["type","button",1,"btn","btn-success","back-Green","btn-sm","btnModifyRow",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-danger","btn-sm","btnRemoveRow","ms-1",3,"click"],[1,"fa","fa-close"],["formControlName","tankId"],["matInput","","placeholder","Date Tested","formControlName","TestingDateTime","required","",3,"dateChange","ngxMatDatetimePicker"],["formControlName","AnalysisDoneByIds","multiple",""],["matInput","","placeholder","Sample Received At","formControlName","SampleReceivedTime","required","",3,"dateChange","ngxMatDatetimePicker"],["matInput","","placeholder","Sample Tested At","formControlName","SampleTestedTime","required","",3,"dateChange","ngxMatDatetimePicker"],["formControlName","SpecificationLimitId"],["matInput","","formControlName","Test1"],["matInput","","formControlName","Test2"],[1,"col-md-12","full-width"],["id","gridQualityList",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner"],["type","button",1,"btn","btn-success","btn-sm","btnModifyRow","back-Green",3,"click"],["id","gridAdjustment",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner",2,"overflow","scroll","width","auto"],[1,"full-width"],[1,"back-Green",2,"width","25%"],["mat-raised-button","",1,"ms-4","back-Green",3,"click","disabled"],["mat-raised-button","",1,"ms-4","back-Green",3,"click"]],template:function(n,i){1&n&&(t.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h4",11),t.nrm(6,"i",12),t.EFF(7," Add/Edit Liquid Preparation"),t.k0s()(),t.j41(8,"div",13),t.DNE(9,H,2,0,"a",14),t.k0s()(),t.j41(10,"div",15)(11,"mat-tab-group",16),t.mxI("selectedIndexChange",function(r){return t.DH7(i.selectedIndex,r)||(i.selectedIndex=r),r}),t.j41(12,"mat-tab"),t.DNE(13,J,3,0,"ng-template",17)(14,it,68,31,"ng-template",18),t.k0s(),t.j41(15,"mat-tab",19),t.DNE(16,at,3,0,"ng-template",17)(17,st,7,2,"ng-template",18),t.k0s(),t.j41(18,"mat-tab",19),t.DNE(19,rt,3,0,"ng-template",17)(20,ut,92,28,"ng-template",18),t.k0s(),t.j41(21,"mat-tab",19),t.DNE(22,pt,3,0,"ng-template",17)(23,bt,7,2,"ng-template",18),t.k0s(),t.j41(24,"mat-tab",19),t.DNE(25,It,3,0,"ng-template",17)(26,Et,86,13,"ng-template",18),t.k0s(),t.j41(27,"mat-tab",19),t.DNE(28,Lt,3,0,"ng-template",17)(29,Dt,21,1,"ng-template",18),t.k0s()(),t.j41(30,"div",20)(31,"button",21),t.bIt("click",function(){return i.goToPreviousTab()}),t.EFF(32,"Previous"),t.k0s(),t.DNE(33,Tt,2,1,"button",22)(34,Pt,2,0,"button",23),t.k0s()()()()()),2&n&&(t.R7$(9),t.Y8G("ngIf",i.IsViewPermission),t.R7$(2),t.R50("selectedIndex",i.selectedIndex),t.R7$(4),t.Y8G("disabled",i.isstartChecklistDisable),t.R7$(3),t.Y8G("disabled",i.isInstructionsDisable),t.R7$(3),t.Y8G("disabled",i.isEndChecklistDisable),t.R7$(3),t.Y8G("disabled",i.isQualityDisable),t.R7$(3),t.Y8G("disabled",i.isAdjustmentDisable),t.R7$(4),t.Y8G("disabled",0===i.selectedIndex),t.R7$(2),t.Y8G("ngIf",5!=i.selectedIndex),t.R7$(),t.Y8G("ngIf",5===i.selectedIndex))},dependencies:[p.Sq,p.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.j4,d.JD,d.$R,d.v8,_.It,_.$z,_.iY,b.rl,b.nJ,b.yw,y.fg,P.An,X.VO,j.wT,A.VT,A._g,f.$L,f.ES,f.mq,f.T8,U.r,g.m7,g.yF,p.QX,p.vh],styles:["mat-tab-group[_ngcontent-%COMP%]{margin:20px}.tab-group-bordered[_ngcontent-%COMP%]{border:2px solid var(--bs-border-color)!important;border-radius:8px;padding:10px;margin-bottom:20px}.card[_ngcontent-%COMP%]{margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:.75rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.full-width[_ngcontent-%COMP%]{width:100%}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.readonly-input[_ngcontent-%COMP%]{color:#000;background-color:#f5f5f5;cursor:not-allowed;border:1px solid #dcdcdc}  .mat-calendar{background-color:#d3d3d3}  .time-container{background-color:#d3d3d3}  .mat-calendar-body-selected{background-color:#1976d2!important;color:#fff!important;border-radius:50%!important}  .mat-calendar-body-active{background-color:#42a5f5!important;border-radius:50%!important}  .mat-calendar-body-today{border-color:#ff9800!important;border-width:2px;border-style:solid;border-radius:50%}.card-header[_ngcontent-%COMP%]{background-color:#17bb58!important;border-bottom:1px solid rgb(23,187,88)!important;padding:.75rem 1.25rem;color:#fff}.back-Green[_ngcontent-%COMP%]{background-color:#17bb58!important;color:#fff!important}.icon-green[_ngcontent-%COMP%]{color:green}  .mat-mdc-tab-labels{background-color:#17bb58!important;color:#fff!important}  .mat-mdc-tab .mdc-tab__text-label{color:#fff!important}  .mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:#e91e63!important}  .mat-mdc-tab-group, .mat-mdc-tab-nav-bar[_ngcontent-%COMP%]{--mdc-tab-indicator-active-indicator-color: #E91E63 !important}"]})}return a})();l(9239);var v=l(6441);const jt=[{path:"",component:S,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:C,canActivate:[v.L],data:{permission:"Liquid Preparation (PER_LIQUIDPREPARATION) - View"}},{path:"add",canActivate:[v.L],data:{permission:"Liquid Preparation (PER_LIQUIDPREPARATION) - Add"},component:F},{path:"edit/:id",canActivate:[v.L],data:{permission:"Liquid Preparation (PER_LIQUIDPREPARATION) - Edit"},component:F}]}];let At=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.$C({type:a});static#i=this.\u0275inj=t.G2t({imports:[h.iI.forChild(jt),h.iI]})}return a})();var qt=l(1774),Nt=l(2356),Rt=l(9830),xt=l(40),Gt=l(5263);let Bt=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.$C({type:a});static#i=this.\u0275inj=t.G2t({providers:[I,(0,Rt._c)()],imports:[p.MD,At,qt.Gg,Nt.c9,f.RI,g.Hw,g.Xg,g.T_,j.WX,Gt.ZG,xt.Yr,b.RG,y.fS]})}return a})()}}]);