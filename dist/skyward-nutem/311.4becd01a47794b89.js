"use strict";(self.webpackChunkskyward_admin=self.webpackChunkskyward_admin||[]).push([[311],{97311:(it,v,r)=>{r.r(v),r.d(v,{LocationModule:()=>q});var E=r(71774),u=r(18498),t=r(54438);let L=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,a){1&i&&t.nrm(0,"router-outlet")},dependencies:[u.n3],encapsulation:2})}return o})();var n=r(89417),c=r(4434),d=r(60177);let h=(()=>{class o extends c.QP{constructor(e){super(e,"location"),this._baseService=e}generateCode(){return this._baseService.get(`${c.T6.location}/generateCode`)}getCompanies(){return this._baseService.get(`${c.T6.company}`)}getStates(){return this._baseService.get(`${c.T6.state}`)}getCountries(){return this._baseService.get(`${c.T6.country}`)}static#t=this.\u0275fac=function(i){return new(i||o)(t.KVO(c.dD))};static#e=this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac})}return o})();var k=r(45794),p=r(88834),_=r(32102),N=r(99631),b=r(99213),D=r(82798),S=r(86600),y=r(30220),x=r(58777);function I(o,l){if(1&o){const e=t.RV6();t.j41(0,"a",33),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.cancel())}),t.EFF(1," View List "),t.k0s()}}function T(o,l){if(1&o&&(t.j41(0,"mat-option",34),t.EFF(1),t.k0s()),2&o){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function A(o,l){if(1&o&&(t.j41(0,"mat-option",34),t.EFF(1),t.k0s()),2&o){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function G(o,l){if(1&o&&(t.j41(0,"mat-option",34),t.EFF(1),t.k0s()),2&o){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function w(o,l){if(1&o&&(t.j41(0,"mat-option",34),t.EFF(1),t.k0s()),2&o){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function R(o,l){if(1&o&&(t.j41(0,"mat-option",34),t.EFF(1),t.k0s()),2&o){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function $(o,l){if(1&o){const e=t.RV6();t.j41(0,"div",35)(1,"div",15)(2,"mat-form-field"),t.nrm(3,"input",36),t.j41(4,"mat-label"),t.EFF(5,"Warehouse Name"),t.k0s(),t.nrm(6,"input",37),t.k0s()(),t.j41(7,"div",15)(8,"mat-form-field")(9,"mat-label"),t.EFF(10,"Address Line 1"),t.k0s(),t.nrm(11,"input",20),t.k0s()(),t.j41(12,"div",15)(13,"mat-form-field")(14,"mat-label"),t.EFF(15,"Address Line 2"),t.k0s(),t.nrm(16,"input",21),t.k0s()(),t.j41(17,"div",15)(18,"mat-form-field")(19,"mat-label"),t.EFF(20,"Address Line 3"),t.k0s(),t.nrm(21,"input",22),t.k0s()(),t.j41(22,"div",15)(23,"mat-form-field")(24,"mat-label"),t.EFF(25,"City"),t.k0s(),t.nrm(26,"input",23),t.k0s()(),t.j41(27,"div",15)(28,"mat-form-field")(29,"mat-label"),t.EFF(30,"State"),t.k0s(),t.j41(31,"mat-select",24),t.DNE(32,w,2,2,"mat-option",19),t.k0s()()(),t.j41(33,"div",15)(34,"mat-form-field")(35,"mat-label"),t.EFF(36,"Country"),t.k0s(),t.j41(37,"mat-select",25),t.DNE(38,R,2,2,"mat-option",19),t.k0s()()(),t.j41(39,"div",15)(40,"mat-form-field")(41,"mat-label"),t.EFF(42,"Pincode"),t.k0s(),t.nrm(43,"input",26),t.k0s()(),t.j41(44,"div",38)(45,"button",39),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.addWarehouseDetail())}),t.j41(46,"mat-icon"),t.EFF(47,"add"),t.k0s()(),t.j41(48,"button",39),t.bIt("click",function(){const a=t.eBV(e).index,s=t.XpG();return t.Njj(s.removeWarehouseDetail(a))}),t.j41(49,"mat-icon"),t.EFF(50,"delete"),t.k0s()()(),t.nrm(51,"hr"),t.k0s()}if(2&o){const e=l.index,i=t.XpG();t.Y8G("formGroupName",e),t.R7$(32),t.Y8G("ngForOf",i.states),t.R7$(6),t.Y8G("ngForOf",i.countries)}}let f=(()=>{class o{constructor(e,i,a,s,m,tt,et,ot){this.activatedRoute=e,this.router=i,this.formBuilder=a,this.locationService=s,this.notificationService=m,this.listService=tt,this.authService=et,this.datePipe=ot,this.page=c.Wt.location,this.permissions=c.eZ,this.loggedInUserId=this.authService.getBrowserUser().id,this.createForm()}ngOnInit(){this.getLocationRoute(),this.loadDropdowns(),this.isEditMode||this.generateLocationCode()}createForm(){this.frmLocation=this.formBuilder.group({locationCode:[{value:"",disabled:!0},[n.k0.required,n.k0.maxLength(32)]],locationName:["",[n.k0.required,n.k0.maxLength(255)]],companyId:["",[n.k0.required]],addressLine1:["",[n.k0.required,n.k0.maxLength(128)]],addressLine2:["",[n.k0.maxLength(128)]],addressLine3:["",[n.k0.maxLength(128)]],city:["",[n.k0.required,n.k0.maxLength(128)]],stateId:["",[n.k0.required]],countryId:["",[n.k0.required]],pincode:["",[n.k0.required,n.k0.maxLength(32)]],locationWarehouseDetails:this.formBuilder.array([])})}generateLocationCode(){this.locationService.generateCode().subscribe(e=>{this.frmLocation.get("locationCode").setValue(e)})}get locationWarehouseDetails(){return this.frmLocation.get("locationWarehouseDetails")}getLocationRoute(){this.routerSub=this.activatedRoute.params.subscribe(e=>{this.isEditMode=!c.ov.isEmpty(e.id),this.isEditMode&&(this.locationId=+e.id,this.getLocationDetails())})}getLocationDetails(){this.locationService.getById(this.locationId).subscribe(e=>{this.locationData=e,this.setLocationData(e)},e=>{this.error=e})}setLocationData(e){this.frmLocation.patchValue(e),e.locationWarehouseDetails&&e.locationWarehouseDetails.forEach(i=>{this.addWarehouseDetail(i)})}addWarehouseDetail(e){this.locationWarehouseDetails.push(this.formBuilder.group({id:[e?e.id:0],warehouseName:[e?e.warehouseName:"",[n.k0.required,n.k0.maxLength(255)]],addressLine1:[e?e.addressLine1:"",[n.k0.required,n.k0.maxLength(128)]],addressLine2:[e?e.addressLine2:"",[n.k0.maxLength(128)]],addressLine3:[e?e.addressLine3:"",[n.k0.maxLength(128)]],city:[e?e.city:"",[n.k0.required,n.k0.maxLength(128)]],stateId:[e?e.stateId:"",[n.k0.required]],countryId:[e?e.countryId:"",[n.k0.required]],pincode:[e?e.pincode:"",[n.k0.required,n.k0.maxLength(32)]]}))}removeWarehouseDetail(e){this.locationWarehouseDetails.removeAt(e)}loadDropdowns(){this.listService.getList("companies").subscribe(e=>{this.companies=e}),this.listService.getAllStates().subscribe(e=>{this.states=e}),this.listService.getCountries().subscribe(e=>{this.countries=e})}save(){if(this.isFormSubmitted=!0,this.frmLocation.invalid)return;const e=this.frmLocation.getRawValue();0!==e.locationWarehouseDetails.length?this.isEditMode?this.updateLocation(e):this.createLocation(e):this.notificationService.warning("Please add at least one warehouse detail.")}createLocation(e){this.locationService.add(e).subscribe(i=>{this.cancel(),this.notificationService.success("Location saved successfully.")},i=>{this.error=i})}updateLocation(e){this.locationService.update(this.locationId,e).subscribe(i=>{this.cancel(),this.notificationService.success("Location updated successfully.")},i=>{this.error=i})}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(i){return new(i||o)(t.rXU(u.nX),t.rXU(u.Ix),t.rXU(n.ze),t.rXU(h),t.rXU(k.tw),t.rXU(c.aG),t.rXU(c.FJ),t.rXU(d.vh))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["ng-component"]],features:[t.Jv_([d.QX,d.vh])],decls:86,vars:6,consts:[["form","ngForm"],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"click",4,"authPermission"],["novalidate","",1,"app-form",3,"submit","formGroup"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-4"],["type","text","matInput","","formControlName","locationCode"],["type","text","matInput","","formControlName","locationName"],["formControlName","companyId"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","formControlName","addressLine1"],["type","text","matInput","","formControlName","addressLine2"],["type","text","matInput","","formControlName","addressLine3"],["type","text","matInput","","formControlName","city"],["formControlName","stateId"],["formControlName","countryId"],["type","text","matInput","","formControlName","pincode"],[1,"card-header","d-flex","align-items-center","justify-content-between"],["type","button","mat-flat-button","","color","primary",3,"click"],["formArrayName","locationWarehouseDetails"],["class","row mt-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-lg-12","text-center"],["type","submit","mat-flat-button","","color","primary",1,"app-button","mr-1"],["mat-flat-button","","color","primary",1,"app-button",3,"click"],[3,"value"],[1,"row","mt-3",3,"formGroupName"],["type","hidden","formControlName","id"],["type","text","matInput","","formControlName","warehouseName"],[1,"col-md-1","d-flex","align-items-center"],["type","button","mat-icon-button","","color","warn",3,"click"]],template:function(i,a){if(1&i){const s=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h4",6),t.nrm(6,"i",7),t.EFF(7," Add/Edit Location"),t.k0s()(),t.j41(8,"div",8),t.DNE(9,I,2,0,"a",9),t.k0s()(),t.j41(10,"form",10,0),t.bIt("submit",function(){return t.eBV(s),t.Njj(a.save())}),t.j41(12,"div",11)(13,"div",12)(14,"h5",6),t.EFF(15,"Basic Details"),t.k0s()(),t.j41(16,"div",13)(17,"div",14)(18,"div",15)(19,"mat-form-field")(20,"mat-label"),t.EFF(21,"Location Code"),t.k0s(),t.nrm(22,"input",16),t.k0s()(),t.j41(23,"div",15)(24,"mat-form-field")(25,"mat-label"),t.EFF(26,"Location Name"),t.k0s(),t.nrm(27,"input",17),t.k0s()(),t.j41(28,"div",15)(29,"mat-form-field")(30,"mat-label"),t.EFF(31,"Company"),t.k0s(),t.j41(32,"mat-select",18),t.DNE(33,T,2,2,"mat-option",19),t.k0s()()()(),t.j41(34,"div",14)(35,"div",15)(36,"mat-form-field")(37,"mat-label"),t.EFF(38,"Address Line 1"),t.k0s(),t.nrm(39,"input",20),t.k0s()(),t.j41(40,"div",15)(41,"mat-form-field")(42,"mat-label"),t.EFF(43,"Address Line 2"),t.k0s(),t.nrm(44,"input",21),t.k0s()(),t.j41(45,"div",15)(46,"mat-form-field")(47,"mat-label"),t.EFF(48,"Address Line 3"),t.k0s(),t.nrm(49,"input",22),t.k0s()()(),t.j41(50,"div",14)(51,"div",15)(52,"mat-form-field")(53,"mat-label"),t.EFF(54,"City"),t.k0s(),t.nrm(55,"input",23),t.k0s()(),t.j41(56,"div",15)(57,"mat-form-field")(58,"mat-label"),t.EFF(59,"State"),t.k0s(),t.j41(60,"mat-select",24),t.DNE(61,A,2,2,"mat-option",19),t.k0s()()(),t.j41(62,"div",15)(63,"mat-form-field")(64,"mat-label"),t.EFF(65,"Country"),t.k0s(),t.j41(66,"mat-select",25),t.DNE(67,G,2,2,"mat-option",19),t.k0s()()(),t.j41(68,"div",15)(69,"mat-form-field")(70,"mat-label"),t.EFF(71,"Pincode"),t.k0s(),t.nrm(72,"input",26),t.k0s()()()()(),t.j41(73,"div",11)(74,"div",27)(75,"h5",6),t.EFF(76,"Warehouse Details"),t.k0s(),t.j41(77,"button",28),t.bIt("click",function(){return t.eBV(s),t.Njj(a.addWarehouseDetail())}),t.EFF(78,"Add Warehouse"),t.k0s()(),t.j41(79,"div",13)(80,"div",29),t.DNE(81,$,52,3,"div",30),t.k0s()()(),t.j41(82,"div",14)(83,"div",31)(84,"button",32),t.EFF(85,"Save"),t.k0s()()()()()()()}2&i&&(t.R7$(9),t.Y8G("authPermission",a.page+"_"+a.permissions.list),t.R7$(),t.Y8G("formGroup",a.frmLocation),t.R7$(23),t.Y8G("ngForOf",a.companies),t.R7$(28),t.Y8G("ngForOf",a.states),t.R7$(6),t.Y8G("ngForOf",a.countries),t.R7$(14),t.Y8G("ngForOf",a.locationWarehouseDetails.controls))},dependencies:[d.Sq,n.qT,n.me,n.BC,n.cb,n.j4,n.JD,n.$R,n.v8,p.It,p.$z,p.iY,_.rl,_.nJ,N.fg,b.An,D.VO,S.wT,y.B,x.T],encapsulation:2})}return o})();var C=r(62288),g=r(33380),W=r(49239),Y=r(74193);let F=(()=>{class o{constructor(){this.searchChanged=new t.bkB,this.searchData={},this.searchKey="locationCode,locationName,companyName,city,stateName,countryName,pincode"}updateSearchTerms(e,i){this.searchData[e]=i,this.searchChanged.emit(this.searchData)}static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["location-search-panel"]],outputs:{searchChanged:"searchChanged"},decls:5,vars:1,consts:[[1,"row"],[1,"col-lg-6"],[3,"textSearchEntered","placeHolder"],[1,"col-lg-4"],[3,"chkChanged"]],template:function(i,a){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"search-text",2),t.bIt("textSearchEntered",function(m){return a.updateSearchTerms(a.searchKey,m)}),t.k0s()(),t.j41(3,"div",3)(4,"search-inactive",4),t.bIt("chkChanged",function(m){return a.updateSearchTerms("isActive",m)}),t.k0s()()()),2&i&&(t.R7$(2),t.Y8G("placeHolder","Search Location Code, Location Name, Company, City, State, Country, Pincode"))},dependencies:[W.D,Y.$],encapsulation:2})}return o})();var X=r(96081);const V=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),B=()=>["../","add"],P=o=>["..","edit",o];function U(o,l){1&o&&(t.j41(0,"a",25)(1,"span"),t.EFF(2,"Add New"),t.k0s(),t.nrm(3,"i",26),t.k0s()),2&o&&t.Y8G("routerLink",t.lJ4(1,B))}function O(o,l){if(1&o&&(t.j41(0,"a",29)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&o){const e=t.XpG().row;t.Y8G("routerLink",t.eq3(1,P,e.id))}}function M(o,l){if(1&o){const e=t.RV6();t.j41(0,"a",32),t.bIt("click",function(){t.eBV(e);const a=t.XpG(2).row,s=t.XpG();return t.Njj(s.activateToggleLocation(a,!1))}),t.j41(1,"mat-icon"),t.EFF(2,"lock"),t.k0s()()}}function H(o,l){if(1&o){const e=t.RV6();t.j41(0,"a",32),t.bIt("click",function(){t.eBV(e);const a=t.XpG(2).row,s=t.XpG();return t.Njj(s.activateToggleLocation(a,!0))}),t.j41(1,"mat-icon"),t.EFF(2,"lock_open"),t.k0s()()}}function J(o,l){if(1&o&&(t.qex(0,30),t.DNE(1,M,3,0,"a",31)(2,H,3,0,"a",31),t.bVm()),2&o){const e=t.XpG().row;t.R7$(),t.Y8G("ngIf",e.isActive),t.R7$(),t.Y8G("ngIf",!e.isActive)}}function Z(o,l){if(1&o&&t.DNE(0,O,3,3,"a",27)(1,J,3,2,"ng-container",28),2&o){const e=t.XpG();t.Y8G("authPermission",e.page+"_"+e.permissions.edit),t.R7$(),t.Y8G("authPermission",e.page+"_"+e.permissions.active)}}const z=[{path:"",component:L,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class o{constructor(e,i,a){this.locationService=e,this.notificationService=i,this.datePipe=a,this.locationData=[],this.page=c.Wt.location,this.permissions=c.eZ,this.searchData={isActive:!1}}ngOnInit(){this.getLocationData()}getLocationData(){this.loading=!0,this.locationService.get().subscribe(e=>{this.locationData=e,this.loading=!1},e=>{console.log(e),this.loading=!1})}exportToExcel(){let e=this.locationData.map(s=>({Id:s.id,"Location Code":s.locationCode,"Location Name":s.locationName,Company:s.companyName,"Address Line 1":s.addressLine1,"Address Line 2":s.addressLine2,"Address Line 3":s.addressLine3,City:s.city,State:s.stateName,Country:s.countryName,Pincode:s.pincode,Active:s.isActive?"Yes":"No"}));const a={Sheets:{data:C.Wp.json_to_sheet(e)},SheetNames:["data"]};C._h(a,"Locations.xlsx")}activateToggleLocation(e,i){confirm(`Are you sure you want to ${i?"Activate":"Deactivate"} this location?`)&&this.locationService.toggleActivate(e.id,i).subscribe(()=>{this.getLocationData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(e){this.searchData=Object.assign({},e)}isActiveRow(e){return{"text-danger":!e.isActive}}static#t=this.\u0275fac=function(i){return new(i||o)(t.rXU(h),t.rXU(k.tw),t.rXU(d.vh))};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["ng-component"]],features:[t.Jv_([d.vh])],decls:28,vars:16,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"routerLink",4,"authPermission"],[1,"row","mb-3"],[1,"col-lg-9"],[3,"searchChanged"],[1,"col-lg-3"],["mat-flat-button","","color","primary",1,"app-button",2,"float","right",3,"click"],[1,"row"],[1,"col-12"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","rowClass","messages"],["name","Location Code","prop","locationCode"],["name","Location Name","prop","locationName"],["name","Company","prop","companyName"],["name","City","prop","city"],["name","State","prop","stateName"],["name","Country","prop","countryName"],["name","Pincode","prop","pincode"],["name","Actions",3,"sortable"],["ngx-datatable-cell-template",""],["mat-flat-button","","color","primary",1,"app-button",3,"routerLink"],[1,"icon-plus"],["class","button-padding","color","primary",3,"routerLink",4,"authPermission"],["class","ml-10",4,"authPermission"],["color","primary",1,"button-padding",3,"routerLink"],[1,"ml-10"],["class","button-padding","color","primary",3,"click",4,"ngIf"],["color","primary",1,"button-padding",3,"click"]],template:function(i,a){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Location List"),t.k0s()(),t.j41(7,"div",6),t.DNE(8,U,4,2,"a",7),t.k0s()(),t.j41(9,"div",8)(10,"div",9)(11,"location-search-panel",10),t.bIt("searchChanged",function(m){return a.updateSearch(m)}),t.k0s()(),t.j41(12,"div",11)(13,"button",12),t.bIt("click",function(){return a.exportToExcel()}),t.EFF(14," Export to Excel "),t.k0s()()(),t.j41(15,"div",13)(16,"div",14)(17,"ngx-datatable",15),t.nI1(18,"searchtable"),t.nrm(19,"ngx-datatable-column",16)(20,"ngx-datatable-column",17)(21,"ngx-datatable-column",18)(22,"ngx-datatable-column",19)(23,"ngx-datatable-column",20)(24,"ngx-datatable-column",21)(25,"ngx-datatable-column",22),t.j41(26,"ngx-datatable-column",23),t.DNE(27,Z,2,2,"ng-template",24),t.k0s()()()()()()()),2&i&&(t.R7$(8),t.Y8G("authPermission",a.page+"_"+a.permissions.create),t.R7$(9),t.Y8G("rows",t.i5U(18,12,a.locationData,a.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",a.loading)("scrollbarH",!0)("rowClass",a.isActiveRow)("messages",t.lJ4(15,V)),t.R7$(9),t.Y8G("sortable",!1))},dependencies:[d.bT,p.It,p.$z,b.An,u.Wk,g.ge,g.ed,g.QI,y.B,F,X.j],encapsulation:2})}return o})(),canActivate:[c.LL],data:{page:c.Wt.location,action:c.eZ.list,title:"Location"}},{path:"add",canActivate:[c.LL],data:{page:c.Wt.location,action:c.eZ.create,title:"Location"},component:f},{path:"edit/:id",canActivate:[c.LL],data:{page:c.Wt.location,action:c.eZ.edit,title:"Location"},component:f}]}];let K=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.$C({type:o});static#o=this.\u0275inj=t.G2t({imports:[u.iI.forChild(z),u.iI]})}return o})();var Q=r(77048);let q=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.$C({type:o});static#o=this.\u0275inj=t.G2t({providers:[h,Q.C],imports:[E.Gg,K]})}return o})()}}]);