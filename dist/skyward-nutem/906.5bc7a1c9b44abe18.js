"use strict";(self.webpackChunkskyward_nutem=self.webpackChunkskyward_nutem||[]).push([[906],{6441:(M,v,n)=>{n.d(v,{L:()=>t});var h=n(4438),p=n(4532),c=n(8498);let t=(()=>{class f{constructor(b,g){this.permissionService=b,this.router=g}canActivate(b,g){return!!this.permissionService.hasPermission(b.data.permission)||(this.router.navigate(["/unauthorized"]),!1)}static#t=this.\u0275fac=function(g){return new(g||f)(h.KVO(p.n),h.KVO(c.Ix))};static#e=this.\u0275prov=h.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}return f})()},6906:(M,v,n)=>{n.r(v),n.d(v,{LaborVarianceModule:()=>bt});var h=n(177),p=n(8498),c=n(4434),t=n(4438),f=n(1626);let k=(()=>{class r{constructor(e,o){this.http=e,this._baseService=o}getLaborVarianceList(){return this.http.get(`${c.T6.laborVarinceList}`)}addLaborVariance(e){return this.http.post(`${c.T6.laborVarinceAdd}`,e)}updateLaborVariance(e){return this.http.post(`${c.T6.laborVarinceEdit}`,e)}getByIdLaborVariance(e){return this.http.get(`${c.T6.laborVarinceGetById}?id=`+e)}DeleteLaborVariance(e){return this.http.get(`${c.T6.laborVarinceDelete}?id=`+e)}static#t=this.\u0275fac=function(o){return new(o||r)(t.KVO(f.Qq),t.KVO(c.dD))};static#e=this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var b=n(5794),g=n(7936),C=n(8834),_=n(9213),V=n(3380),N=n(6081);const $=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),w=()=>["../","add"],G=r=>["..","edit",r];function O(r,l){1&r&&(t.j41(0,"a",17)(1,"span"),t.EFF(2,"Add New"),t.k0s(),t.nrm(3,"i",18),t.k0s()),2&r&&t.Y8G("routerLink",t.lJ4(1,w))}function x(r,l){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&r){const e=l.value;t.R7$(),t.JRh(t.i5U(2,1,e,"dd/MM/yyyy hh:mm a"))}}function Y(r,l){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&r){const e=l.value;t.R7$(),t.JRh(e)}}function H(r,l){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&r){const e=l.value;t.R7$(),t.JRh(e)}}function J(r,l){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&r){const e=l.value;t.R7$(),t.JRh(e)}}function U(r,l){if(1&r&&(t.j41(0,"a",22)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&r){const e=t.XpG().row;t.Y8G("routerLink",t.eq3(1,G,e.id))}}function X(r,l){if(1&r){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const a=t.XpG().row,i=t.XpG(2);return t.Njj(i.removeLaborVarince(a.id))}),t.j41(1,"mat-icon"),t.EFF(2,"close"),t.k0s()()}}function W(r,l){if(1&r&&t.DNE(0,U,3,3,"a",20)(1,X,3,0,"button",21),2&r){const e=t.XpG(2);t.Y8G("ngIf",e.IsEditPermission),t.R7$(),t.Y8G("ngIf",e.IsDeletePermission)}}function K(r,l){1&r&&(t.j41(0,"ngx-datatable-column",19),t.DNE(1,W,2,2,"ng-template",12),t.k0s()),2&r&&t.Y8G("sortable",!1)}let A=(()=>{class r{constructor(e,o,a){this.laborVarinaceService=e,this.notificationService=o,this.permissionService=a,this.LaborVarianceData=[],this.page=c.Wt.laborVariance,this.permissions=c.eZ,this.IsAddPemission=!0,this.IsEditPermission=!0,this.IsDeletePermission=!0,this.searchData={},this.showDeleteModal=!1}ngOnInit(){this.getLaborVarinceData()}getLaborVarinceData(){this.loading=!0,this.laborVarinaceService.getLaborVarianceList().subscribe(e=>{this.LaborVarianceData=e,this.loading=!1},e=>{this.error=e,this.loading=!1})}removeLaborVarince(e){confirm("Are you sure, you want to delete this Weight Check?")&&this.laborVarinaceService.DeleteLaborVariance(e).subscribe(()=>{this.getLaborVarinceData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(e){this.searchData=Object.assign({},e)}isActiveRow(e){return{"text-danger":!e.isActive}}static#t=this.\u0275fac=function(o){return new(o||r)(t.rXU(k),t.rXU(b.tw),t.rXU(g.n))};static#e=this.\u0275cmp=t.VBU({type:r,selectors:[["app-list"]],decls:22,vars:15,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","class","app-button btn",3,"routerLink",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","Date","prop","dateTime"],["ngx-datatable-cell-template",""],["name","Product Line","prop","productLineName"],["name","Shift","prop","shiftName"],["name","Total Employee","prop","totalEmployee"],["name","Actions",3,"sortable",4,"ngIf"],["mat-flat-button","",1,"app-button","btn",3,"routerLink"],[1,"icon-plus"],["name","Actions",3,"sortable"],["class","button-padding icon-green",3,"routerLink",4,"ngIf"],["type","button","style","border: none; background-color: white; color: red;",3,"click",4,"ngIf"],[1,"button-padding","icon-green",3,"routerLink"],["type","button",2,"border","none","background-color","white","color","red",3,"click"]],template:function(o,a){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Labor Varince List"),t.k0s()(),t.j41(7,"div",6),t.DNE(8,O,4,2,"a",7),t.k0s()(),t.j41(9,"div",8)(10,"div",9)(11,"ngx-datatable",10),t.nI1(12,"searchtable"),t.j41(13,"ngx-datatable-column",11),t.DNE(14,x,3,4,"ng-template",12),t.k0s(),t.j41(15,"ngx-datatable-column",13),t.DNE(16,Y,2,1,"ng-template",12),t.k0s(),t.j41(17,"ngx-datatable-column",14),t.DNE(18,H,2,1,"ng-template",12),t.k0s(),t.j41(19,"ngx-datatable-column",15),t.DNE(20,J,2,1,"ng-template",12),t.k0s(),t.DNE(21,K,2,1,"ngx-datatable-column",16),t.k0s()()()()()()),2&o&&(t.R7$(8),t.Y8G("ngIf",a.IsAddPemission),t.R7$(3),t.Y8G("rows",t.i5U(12,11,a.LaborVarianceData,a.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",a.loading)("scrollbarH",!0)("messages",t.lJ4(14,$)),t.R7$(10),t.Y8G("ngIf",a.IsEditPermission||a.IsDeletePermission))},dependencies:[h.bT,p.Wk,C.It,_.An,V.ge,V.ed,V.QI,h.vh,N.j],styles:[".ngx-datatable .datatable-header-cell{background-color:#17bb58!important;color:#fff!important}.icon-green[_ngcontent-%COMP%]{color:green}.btn[_ngcontent-%COMP%]{background-color:#17bb58!important;color:#fff!important}  .ngx-datatable.material .datatable-body .progress-linear .container{background-color:#90ee90}  .ngx-datatable.material .datatable-body .progress-linear .container .bar{background-color:green}"]})}return r})();var D=n(6441),m=n(9417),z=n(1528),Q=n(4480),L=n(2102),Z=n(9631),q=n(2798),tt=n(6600),S=n(5084),et=n(8777),ot=n(7133),I=n(2356);function at(r,l){if(1&r){const e=t.RV6();t.j41(0,"a",46),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.cancel())}),t.EFF(1," View List "),t.k0s()}}function rt(r,l){if(1&r&&(t.j41(0,"mat-option",47),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.shiftName," ")}}function it(r,l){if(1&r&&(t.j41(0,"mat-option",47),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.name," ")}}function nt(r,l){if(1&r&&(t.j41(0,"mat-option",47),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.poNumber," ")}}function st(r,l){if(1&r&&(t.j41(0,"mat-option",47),t.EFF(1),t.k0s()),2&r){const e=l.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.productName," ")}}function lt(r,l){if(1&r){const e=t.RV6();t.j41(0,"div",48)(1,"div",18)(2,"div",19)(3,"mat-form-field",20)(4,"mat-label"),t.EFF(5,"Production Order"),t.k0s(),t.j41(6,"mat-select",49),t.DNE(7,nt,2,2,"mat-option",25),t.k0s()()(),t.j41(8,"div",19)(9,"mat-form-field",20)(10,"mat-label"),t.EFF(11,"Product"),t.k0s(),t.j41(12,"mat-select",50),t.DNE(13,st,2,2,"mat-option",25),t.k0s()()(),t.j41(14,"div",19)(15,"mat-form-field",20)(16,"mat-label"),t.EFF(17,"Start Time"),t.k0s(),t.nrm(18,"input",51)(19,"ngx-material-timepicker",null,2),t.k0s()(),t.j41(21,"div",19)(22,"mat-form-field",20)(23,"mat-label"),t.EFF(24,"End Time"),t.k0s(),t.nrm(25,"input",52)(26,"ngx-material-timepicker",null,3),t.k0s()(),t.j41(28,"div",19)(29,"mat-form-field",20)(30,"mat-label"),t.EFF(31,"Late Start Reason"),t.k0s(),t.nrm(32,"input",53),t.k0s()(),t.j41(33,"div",19)(34,"mat-form-field",20)(35,"mat-label"),t.EFF(36,"Change Over Time"),t.k0s(),t.nrm(37,"input",54)(38,"ngx-material-timepicker",null,4),t.k0s()(),t.j41(40,"div",19)(41,"mat-form-field",20)(42,"mat-label"),t.EFF(43,"Actual Bottle Produced"),t.k0s(),t.nrm(44,"input",55),t.k0s()(),t.j41(45,"div",19)(46,"mat-form-field",20)(47,"mat-label"),t.EFF(48,"Total Run Time(Mins)"),t.k0s(),t.nrm(49,"input",56),t.k0s()(),t.j41(50,"div",19)(51,"mat-form-field",20)(52,"mat-label"),t.EFF(53,"Shift Comments"),t.k0s(),t.nrm(54,"input",57),t.k0s()(),t.j41(55,"div",19)(56,"mat-form-field",20)(57,"mat-label"),t.EFF(58,"Downtime (Mins)"),t.k0s(),t.nrm(59,"input",58),t.k0s()(),t.j41(60,"div",19)(61,"mat-form-field",20)(62,"mat-label"),t.EFF(63,"Downtime Comments"),t.k0s(),t.nrm(64,"input",59),t.k0s()(),t.j41(65,"div",19)(66,"mat-form-field",20)(67,"mat-label"),t.EFF(68,"HC"),t.k0s(),t.nrm(69,"input",60),t.k0s()(),t.j41(70,"div",19)(71,"mat-form-field",20)(72,"mat-label"),t.EFF(73,"Case Attainment"),t.k0s(),t.nrm(74,"input",61),t.k0s()(),t.j41(75,"div",19)(76,"mat-form-field",20)(77,"mat-label"),t.EFF(78,"Case Target"),t.k0s(),t.nrm(79,"input",62),t.k0s()(),t.j41(80,"div",19)(81,"mat-form-field",20)(82,"mat-label"),t.EFF(83,"%"),t.k0s(),t.nrm(84,"input",63),t.k0s()(),t.j41(85,"div",19)(86,"mat-form-field",20)(87,"mat-label"),t.EFF(88,"Bottle Target"),t.k0s(),t.nrm(89,"input",64),t.k0s()(),t.j41(90,"div",19)(91,"mat-form-field",20)(92,"mat-label"),t.EFF(93,"Shift Index"),t.k0s(),t.nrm(94,"input",65),t.k0s()(),t.j41(95,"div",19)(96,"mat-form-field",20)(97,"mat-label"),t.EFF(98,"Criteria"),t.k0s(),t.nrm(99,"input",66),t.k0s()(),t.j41(100,"div",19)(101,"mat-form-field",20)(102,"mat-label"),t.EFF(103,"Missing FG Items"),t.k0s(),t.nrm(104,"input",67),t.k0s()(),t.j41(105,"div",19)(106,"mat-form-field",20)(107,"mat-label"),t.EFF(108,"Non Production Time"),t.k0s(),t.nrm(109,"input",68),t.k0s()(),t.j41(110,"div",19)(111,"mat-form-field",20)(112,"mat-label"),t.EFF(113,"Additional Comments"),t.k0s(),t.nrm(114,"input",69),t.k0s()(),t.j41(115,"div",19)(116,"mat-form-field",20)(117,"mat-label"),t.EFF(118,"Time Per Person "),t.k0s(),t.nrm(119,"input",70),t.k0s()(),t.j41(120,"div",19)(121,"mat-form-field",20)(122,"mat-label"),t.EFF(123,"Total Mins"),t.k0s(),t.nrm(124,"input",71),t.k0s()(),t.j41(125,"div",19)(126,"mat-form-field",20)(127,"mat-label"),t.EFF(128,"Description"),t.k0s(),t.nrm(129,"input",72),t.k0s()(),t.j41(130,"div",73)(131,"button",74),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.addFinallaborVarianceDetail())}),t.j41(132,"mat-icon"),t.EFF(133,"add"),t.k0s()()()()()}if(2&r){const e=l.index,o=t.sdS(20),a=t.sdS(27),i=t.sdS(39),u=t.XpG();t.Y8G("formGroupName",e),t.R7$(7),t.Y8G("ngForOf",u.productionOrderList),t.R7$(6),t.Y8G("ngForOf",u.productList),t.R7$(5),t.Y8G("ngxTimepicker",o),t.R7$(7),t.Y8G("ngxTimepicker",a),t.R7$(12),t.Y8G("ngxTimepicker",i)}}function mt(r,l){if(1&r){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.k0s(),t.j41(15,"td"),t.EFF(16),t.k0s(),t.j41(17,"td"),t.EFF(18),t.k0s(),t.j41(19,"td"),t.EFF(20),t.k0s(),t.j41(21,"td"),t.EFF(22),t.k0s(),t.j41(23,"td"),t.EFF(24),t.k0s(),t.j41(25,"td"),t.EFF(26),t.k0s(),t.j41(27,"td"),t.EFF(28),t.k0s(),t.j41(29,"td"),t.EFF(30),t.k0s(),t.j41(31,"td"),t.EFF(32),t.k0s(),t.j41(33,"td"),t.EFF(34),t.k0s(),t.j41(35,"td"),t.EFF(36),t.k0s(),t.j41(37,"td"),t.EFF(38),t.k0s(),t.j41(39,"td"),t.EFF(40),t.k0s(),t.j41(41,"td"),t.EFF(42),t.k0s(),t.j41(43,"td"),t.EFF(44),t.k0s(),t.j41(45,"td"),t.EFF(46),t.k0s(),t.j41(47,"td"),t.EFF(48),t.k0s(),t.j41(49,"td")(50,"button",75),t.bIt("click",function(){const a=t.eBV(e),i=a.$implicit,u=a.index,s=t.XpG();return t.Njj(s.onEditDetail(i,u))}),t.nrm(51,"i",76),t.k0s(),t.j41(52,"button",77),t.bIt("click",function(){const a=t.eBV(e).index,i=t.XpG();return t.Njj(i.removeLaborVarianceDetail(a))}),t.nrm(53,"i",78),t.k0s()()()}if(2&r){const e=l.$implicit;t.R7$(2),t.JRh(e.SAPProductionOrderId),t.R7$(2),t.JRh(e.ProductId),t.R7$(2),t.JRh(e.StartDateTime),t.R7$(2),t.JRh(e.EndDateTime),t.R7$(2),t.JRh(e.LateStartReason),t.R7$(2),t.JRh(e.ChangeOverTime),t.R7$(2),t.JRh(e.ActualBottleProduced),t.R7$(2),t.JRh(e.TotalRunTImeMins),t.R7$(2),t.JRh(e.ShiftComments),t.R7$(2),t.JRh(e.DownTimeMins),t.R7$(2),t.JRh(e.DownTImeComments),t.R7$(2),t.JRh(e.HC),t.R7$(2),t.JRh(e.CaseAttainment),t.R7$(2),t.JRh(e.CaseTarget),t.R7$(2),t.SpI("",e.Percentage," %"),t.R7$(2),t.JRh(e.BottleTarget),t.R7$(2),t.JRh(e.ShiftIndex),t.R7$(2),t.JRh(e.Criteria),t.R7$(2),t.JRh(e.MissingFGItems),t.R7$(2),t.JRh(e.NonProductionTime),t.R7$(2),t.JRh(e.AdditionalComments),t.R7$(2),t.JRh(e.TimePerPerson),t.R7$(2),t.JRh(e.TotalMins),t.R7$(2),t.JRh(e.Description)}}let y=(()=>{class r{constructor(e,o,a,i,u,s,d,T){this.activatedRoute=e,this.router=o,this.formBuilder=a,this.laborVarinceService=i,this.notificationService=u,this.weightCheckService=s,this.permissionService=d,this.downtimeTrackingService=T,this.page=c.Wt.laborVariance,this.permissions=c.eZ,this.shiftList=[],this.productionOrderList=[],this.productList=[],this.fillingLineList=[],this.usersList=[],this.AddedlaborVarianceDetailsList=[],this.EditDetailsId=-1,this.minEndDate=null,this.IsViewPermission=!0,this.TotalEmployee=0,this.createForm()}ngOnInit(){this.getRoute(),this.loadDropdowns()}getRoute(){this.routerSub=this.activatedRoute.params.subscribe(e=>{this.isEditMode=!c.ov.isEmpty(e.id),this.createForm(),this.addlaborDetail(),this.isEditMode&&(this.laborVarianceId=e.id,this.getlaborVarianceById())})}getlaborVarianceById(){this.laborVarinceService.getByIdLaborVariance(this.laborVarianceId).subscribe(e=>{this.laborVarianceData=e,this.setlaborVariancekData()},e=>{console.log(e)})}setlaborVariancekData(){this.laborVarianceForm.patchValue({Code:this.laborVarianceData.code,DateTime:this.laborVarianceData.dateTime,ShiftId:this.laborVarianceData.shiftId,ProductLineId:this.laborVarianceData.productLineId,Employees:this.laborVarianceData.employees,TempEmployee:this.laborVarianceData.tempEmployee,TotalEmployee:this.laborVarianceData.totalEmployee,Note:this.laborVarianceData.note});const e=o=>new Date(o).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});setTimeout(()=>{this.laborVarianceData.laborVarianceDetails?.forEach(o=>{let a={SAPProductionOrderId:o.sapProductionOrderId,ProductId:o.productId,StartDateTime:e(o.startDateTime),EndDateTime:e(o.endDateTime),LateStartReason:o.lateStartReason,ChangeOverTime:e(o.changeOverTime),ActualBottleProduced:o.actualBottleProduced,TotalRunTImeMins:o.totalRunTImeMins,ShiftComments:o.shiftComments,DownTimeMins:o.downTimeMins,DownTImeComments:o.downTImeComments,HC:o.hc,CaseAttainment:o.caseAttainment,CaseTarget:o.caseTarget,Percentage:o.percentage,BottleTarget:o.bottleTarget,ShiftIndex:o.shiftIndex,Criteria:o.criteria,MissingFGItems:o.missingFGItems,NonProductionTime:o.nonProductionTime,AdditionalComments:o.additionalComments,TimePerPerson:o.timePerPerson,TotalMins:o.totalMins,Description:o.description};this.AddedlaborVarianceDetailsList.push(a)})},500)}loadDropdowns(){this.weightCheckService.getShiftList().subscribe(e=>{this.shiftList=e}),this.weightCheckService.getProductionOrderList().subscribe(e=>{this.productionOrderList=e}),this.weightCheckService.getProductList().subscribe(e=>{this.productList=e}),this.downtimeTrackingService.getMaster().subscribe(e=>{this.fillingLineList=this.filterFillingLines(e)})}filterFillingLines(e){return e.filter(o=>o.categoryName&&-1!==o.categoryName.toLowerCase().indexOf("fill"))}createForm(){this.laborVarianceForm=this.formBuilder.group({Code:[{value:"",disabled:!0},[m.k0.required]],DateTime:["",[m.k0.required]],ShiftId:["",[m.k0.required]],ProductLineId:["",[m.k0.required]],Employees:["",[m.k0.required]],TempEmployee:["",[m.k0.required]],TotalEmployee:["",""],Note:["",""],LaborVarianceDetails:this.formBuilder.array([])}),this.laborVarianceForm.controls.DateTime.setValue((new Date).toISOString().split("T")[0]),this.laborVarianceForm.get("Employees")?.valueChanges.subscribe(()=>{this.updateTotalEmployees()}),this.laborVarianceForm.get("TempEmployee")?.valueChanges.subscribe(()=>{this.updateTotalEmployees()})}updateTotalEmployees(){const e=this.laborVarianceForm.get("Employees")?.value||0,o=this.laborVarianceForm.get("TempEmployee")?.value||0;this.TotalEmployee=e+o,this.laborVarianceForm.get("TotalEmployee")?.setValue(this.TotalEmployee,{emitEvent:!1}),this.LaborVarianceDetails.at(0).get("HC")?.setValue(this.TotalEmployee,{emitEvent:!1})}getToday(){return(new Date).toISOString().split("T")[0]}addlaborDetail(){this.LaborVarianceDetails?.clear(),this.EditDetailsId=-1;const e=this.formBuilder.group({});e.addControl("SAPProductionOrderId",this.formBuilder.control("")),e.addControl("ProductId",this.formBuilder.control("")),e.addControl("StartDateTime",this.formBuilder.control("")),e.addControl("EndDateTime",this.formBuilder.control("")),e.addControl("LateStartReason",this.formBuilder.control("")),e.addControl("ChangeOverTime",this.formBuilder.control("")),e.addControl("ActualBottleProduced",this.formBuilder.control("")),e.addControl("TotalRunTImeMins",this.formBuilder.control("")),e.addControl("ShiftComments",this.formBuilder.control("")),e.addControl("DownTimeMins",this.formBuilder.control("")),e.addControl("DownTImeComments",this.formBuilder.control("")),e.addControl("HC",this.formBuilder.control(this.TotalEmployee||"")),e.addControl("CaseAttainment",this.formBuilder.control("")),e.addControl("CaseTarget",this.formBuilder.control("")),e.addControl("Percentage",this.formBuilder.control("")),e.addControl("BottleTarget",this.formBuilder.control("")),e.addControl("ShiftIndex",this.formBuilder.control("")),e.addControl("Criteria",this.formBuilder.control("")),e.addControl("MissingFGItems",this.formBuilder.control("")),e.addControl("NonProductionTime",this.formBuilder.control("")),e.addControl("AdditionalComments",this.formBuilder.control("")),e.addControl("TimePerPerson",this.formBuilder.control("")),e.addControl("TotalMins",this.formBuilder.control("")),e.addControl("Description",this.formBuilder.control("")),this.LaborVarianceDetails=this.laborVarianceForm?.get("LaborVarianceDetails"),this.LaborVarianceDetails.push(e),this.LaborVarianceDetails.at(0).get("CaseAttainment")?.valueChanges.subscribe(()=>{this.updatePercentage()}),this.LaborVarianceDetails.at(0).get("HC")?.valueChanges.subscribe(()=>{this.updatePercentage()})}updatePercentage(){const e=this.LaborVarianceDetails.at(0).get("CaseAttainment")?.value||0,o=this.TotalEmployee||0,a=o?(e/o).toFixed(2):0;this.LaborVarianceDetails.at(0).get("Percentage")?.setValue(a)}addFinallaborVarianceDetail(){const e=this.LaborVarianceDetails.at(0).value;console.log("details",this.LaborVarianceDetails.at(0)),e.SAPProductionOrderId?e.ProductId?this.EditDetailsId>=0?(this.AddedlaborVarianceDetailsList[this.EditDetailsId]=e,this.addlaborDetail()):(this.AddedlaborVarianceDetailsList.push(e),this.addlaborDetail(),console.log("Added lavbor details:",this.AddedlaborVarianceDetailsList)):this.notificationService.error("please select product"):this.notificationService.error("please select production order")}onEditDetail(e,o){this.populateFormWithValues(this.AddedlaborVarianceDetailsList[o]),this.EditDetailsId=o}populateFormWithValues(e){const o=Array.isArray(e)?e:[e];this.LaborVarianceDetails=this.laborVarianceForm.get("LaborVarianceDetails"),this.LaborVarianceDetails.clear(),o.forEach(a=>{const i=this.formBuilder.group({});i.addControl("SAPProductionOrderId",this.formBuilder.control(a.SAPProductionOrderId||"")),i.addControl("ProductId",this.formBuilder.control(a.ProductId||"")),i.addControl("StartDateTime",this.formBuilder.control(a.StartDateTime||"")),i.addControl("EndDateTime",this.formBuilder.control(a.EndDateTime||"")),i.addControl("LateStartReason",this.formBuilder.control(a.LateStartReason||"")),i.addControl("ChangeOverTime",this.formBuilder.control(a.ChangeOverTime||"")),i.addControl("ActualBottleProduced",this.formBuilder.control(a.ActualBottleProduced||"")),i.addControl("TotalRunTImeMins",this.formBuilder.control(a.TotalRunTImeMins||"")),i.addControl("ShiftComments",this.formBuilder.control(a.ShiftComments||"")),i.addControl("DownTimeMins",this.formBuilder.control(a.DownTimeMins||"")),i.addControl("DownTImeComments",this.formBuilder.control(a.DownTImeComments||"")),i.addControl("HC",this.formBuilder.control(a.HC||"")),i.addControl("CaseAttainment",this.formBuilder.control(a.CaseAttainment||"")),i.addControl("CaseTarget",this.formBuilder.control(a.CaseTarget||"")),i.addControl("Percentage",this.formBuilder.control(a.Percentage||"")),i.addControl("BottleTarget",this.formBuilder.control(a.BottleTarget||"")),i.addControl("ShiftIndex",this.formBuilder.control(a.ShiftIndex||"")),i.addControl("Criteria",this.formBuilder.control(a.Criteria||"")),i.addControl("MissingFGItems",this.formBuilder.control(a.MissingFGItems||"")),i.addControl("NonProductionTime",this.formBuilder.control(a.NonProductionTime||"")),i.addControl("AdditionalComments",this.formBuilder.control(a.AdditionalComments||"")),i.addControl("TimePerPerson",this.formBuilder.control(a.TimePerPerson||"")),i.addControl("TotalMins",this.formBuilder.control(a.TotalMins||"")),i.addControl("Description",this.formBuilder.control(a.Description||"")),this.LaborVarianceDetails.push(i),this.LaborVarianceDetails.at(0).get("CaseAttainment")?.valueChanges.subscribe(()=>{this.updatePercentage()}),this.LaborVarianceDetails.at(0).get("HC")?.valueChanges.subscribe(()=>{this.updatePercentage()})})}removeLaborVarianceDetail(e){this.AddedlaborVarianceDetailsList.splice(e,1),console.log("control",this.AddedlaborVarianceDetailsList)}createLaborVariance(e){this.laborVarinceService.addLaborVariance(e).subscribe(()=>{this.cancel(),this.notificationService.success("Labor Variance created successfully.")},o=>{this.error=o})}updateLaborVariance(e){this.laborVarinceService.updateLaborVariance(e).subscribe(()=>{this.cancel(),this.notificationService.success("Labor  Variance updated successfully.")},o=>{this.error=o})}save(){if(this.isFormSubmitted=!0,this.laborVarianceForm.invalid)this.notificationService.error("Invalid form data");else if(this.AddedlaborVarianceDetailsList.length<1)this.notificationService.error("at lease one labor variance deatils required");else{let e=this.laborVarianceForm.value;e.LaborVarianceDetails=this.AddedlaborVarianceDetailsList,console.log("formvalue",e);let o=this.transformData(e);console.log("Playload",o),this.isEditMode?this.updateLaborVariance(o):this.createLaborVariance(o)}}transformData(e){function a(s){const T=s.match(/(\d{1,2}):(\d{2}) (AM|PM)/i);if(!T)throw new Error("Invalid time format");let[,P,j,E]=T,F=parseInt(P,10);const gt=parseInt(j,10);"AM"===E.toUpperCase()?12===F&&(F=0):"PM"===E.toUpperCase()&&12!==F&&(F+=12);const Ft=F.toString().padStart(2,"0"),Ct=gt.toString().padStart(2,"0"),R=new Date;return`${R.getFullYear()}-${(R.getMonth()+1).toString().padStart(2,"0")}-${R.getDate().toString().padStart(2,"0")}T${Ft}:${Ct}`}const i=Array.isArray(e.LaborVarianceDetails)?e.LaborVarianceDetails:Object.values(e.LaborVarianceDetails||{});return{Id:this.isEditMode?this.laborVarianceData.id:0,Code:this.isEditMode?this.laborVarianceData.code:"",DateTime:function o(s){const d=new Date(s);if(isNaN(d.getTime()))throw new Error("Invalid date string provided");return`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}T${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`}(e.DateTime),ShiftId:e.ShiftId,ProductLineId:e.ProductLineId,Employees:e.Employees,TempEmployee:e.TempEmployee,TotalEmployee:e.TotalEmployee,Note:e.Note,LaborVarianceDetails:Array.isArray(i)?i.map((s,d)=>({id:0,headerId:0,SAPProductionOrderId:s.SAPProductionOrderId,ProductId:s.ProductId,StartDateTime:a(s.StartDateTime),EndDateTime:a(s.EndDateTime),LateStartReason:s.LateStartReason,ChangeOverTime:a(s.ChangeOverTime),ActualBottleProduced:s.ActualBottleProduced,TotalRunTImeMins:s.TotalRunTImeMins,ShiftComments:s.ShiftComments,DownTimeMins:s.DownTimeMins,DownTImeComments:s.DownTImeComments,HC:s.HC,CaseAttainment:s.CaseAttainment,CaseTarget:s.CaseTarget,Percentage:Number(s.Percentage),BottleTarget:s.BottleTarget,ShiftIndex:s.ShiftIndex,Criteria:s.Criteria,MissingFGItems:s.MissingFGItems,NonProductionTime:s.NonProductionTime,AdditionalComments:s.AdditionalComments,TimePerPerson:s.TimePerPerson,TotalMins:s.TotalMins,Description:s.Description})):[]}}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||r)(t.rXU(p.nX),t.rXU(p.Ix),t.rXU(m.ze),t.rXU(k),t.rXU(b.tw),t.rXU(z.Q),t.rXU(g.n),t.rXU(Q.q))};static#e=this.\u0275cmp=t.VBU({type:r,selectors:[["app-add-edit"]],decls:134,vars:30,consts:[["form","ngForm"],["pickerStart",""],["Starttimepicker",""],["Endtimepicker",""],["changetimepicker",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button back-Green",3,"click",4,"ngIf"],["novalidate","",1,"app-form",3,"submit","formGroup"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","mb-3"],["appearance","fill",1,"full-width"],["matInput","","formControlName","DateTime",3,"matDatepicker","max"],["matSuffix","",3,"for"],[3,"control","message","formSubmitted"],["formControlName","ShiftId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","ProductLineId"],["matInput","","formControlName","Employees","type","number"],["matInput","","formControlName","TempEmployee","type","number"],["matInput","","formControlName","TotalEmployee","type","number","readonly",""],[1,"col-12","col-sm-12","col-md-12","col-lg-12","mb-3"],["matInput","","formControlName","Note"],[1,"card-header","d-flex","align-items-center","justify-content-between"],["formArrayName","LaborVarianceDetails"],["class","row mt-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-md-12"],[1,"table-responsive"],["id","gridLaborVarince",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner"],[1,"bg-primary","text-primary","text-center"],[1,"back-Green"],[1,"back-Green",2,"width","10%"],[1,"back-Green",2,"width","15%"],[1,"back-Green",2,"width","8%"],[4,"ngFor","ngForOf"],[1,"col-lg-12","text-center"],["type","submit","mat-flat-button","",1,"app-button","mr-1","back-Green"],["mat-flat-button","","color","primary",1,"app-button","back-Green",3,"click"],[3,"value"],[1,"row","mt-3",3,"formGroupName"],["formControlName","SAPProductionOrderId"],["formControlName","ProductId"],["matInput","","placeholder","Select time","formControlName","StartDateTime",3,"ngxTimepicker"],["matInput","","placeholder","Select time","formControlName","EndDateTime",3,"ngxTimepicker"],["matInput","","formControlName","LateStartReason"],["matInput","","placeholder","Select time","formControlName","ChangeOverTime",3,"ngxTimepicker"],["matInput","","formControlName","ActualBottleProduced","type","number"],["matInput","","formControlName","TotalRunTImeMins","type","number"],["matInput","","formControlName","ShiftComments"],["matInput","","formControlName","DownTimeMins","type","number"],["matInput","","formControlName","DownTImeComments"],["matInput","","formControlName","HC","type","number","readonly",""],["matInput","","formControlName","CaseAttainment","type","number"],["matInput","","formControlName","CaseTarget","type","number"],["matInput","","formControlName","Percentage","type","number","readonly",""],["matInput","","formControlName","BottleTarget","type","number"],["matInput","","formControlName","ShiftIndex"],["matInput","","formControlName","Criteria"],["matInput","","formControlName","MissingFGItems","type","number"],["matInput","","formControlName","NonProductionTime","type","number"],["matInput","","formControlName","AdditionalComments"],["matInput","","formControlName","TimePerPerson","type","number"],["matInput","","formControlName","TotalMins","type","number"],["matInput","","formControlName","Description"],[1,"col-12","col-sm-12","col-md-2","col-lg-2","mb-3","p-1","d-flex","align-items-center"],["type","button","mat-icon-button","",1,"icon-green",3,"click"],["type","button",1,"btn","btn-success","btn-sm","btnModifyRow","back-Green",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-danger","btn-sm","btnRemoveRow","ms-1",3,"click"],[1,"fa","fa-close"]],template:function(o,a){if(1&o){const i=t.RV6();t.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"h4",10),t.nrm(6,"i",11),t.EFF(7," Add/Edit Labor Variance"),t.k0s()(),t.j41(8,"div",12),t.DNE(9,at,2,0,"a",13),t.k0s()(),t.j41(10,"form",14,0),t.bIt("submit",function(){return t.eBV(i),t.Njj(a.save())}),t.j41(12,"div",15)(13,"div",16)(14,"h5",10),t.EFF(15,"Basic Details"),t.k0s()(),t.j41(16,"div",17)(17,"div",18)(18,"div",19)(19,"mat-form-field",20)(20,"mat-label"),t.EFF(21,"Date"),t.k0s(),t.nrm(22,"input",21)(23,"mat-datepicker-toggle",22)(24,"mat-datepicker",null,1)(26,"mat-validation-message",23),t.k0s()(),t.j41(27,"div",19)(28,"mat-form-field",20)(29,"mat-label"),t.EFF(30,"Shift"),t.k0s(),t.j41(31,"mat-select",24),t.DNE(32,rt,2,2,"mat-option",25),t.k0s(),t.nrm(33,"mat-validation-message",23),t.k0s()(),t.j41(34,"div",19)(35,"mat-form-field",20)(36,"mat-label"),t.EFF(37,"Product Line"),t.k0s(),t.j41(38,"mat-select",26),t.DNE(39,it,2,2,"mat-option",25),t.k0s(),t.nrm(40,"mat-validation-message",23),t.k0s()(),t.j41(41,"div",19)(42,"mat-form-field",20)(43,"mat-label"),t.EFF(44,"Employees "),t.k0s(),t.nrm(45,"input",27)(46,"mat-validation-message",23),t.k0s()(),t.j41(47,"div",19)(48,"mat-form-field",20)(49,"mat-label"),t.EFF(50,"Temporary "),t.k0s(),t.nrm(51,"input",28)(52,"mat-validation-message",23),t.k0s()(),t.j41(53,"div",19)(54,"mat-form-field",20)(55,"mat-label"),t.EFF(56,"Total"),t.k0s(),t.nrm(57,"input",29)(58,"mat-validation-message",23),t.k0s()(),t.j41(59,"div",30)(60,"mat-form-field",20)(61,"mat-label"),t.EFF(62,"Note"),t.k0s(),t.nrm(63,"textarea",31)(64,"mat-validation-message",23),t.k0s()()()()(),t.j41(65,"div",15)(66,"div",32)(67,"h5",10),t.EFF(68,"Labor Variance Details"),t.k0s()(),t.j41(69,"div",17)(70,"div",33),t.DNE(71,lt,134,6,"div",34),t.k0s()()(),t.j41(72,"div",18)(73,"div",35)(74,"div",36)(75,"table",37)(76,"thead",38)(77,"tr")(78,"th",39),t.EFF(79,"PO No"),t.k0s(),t.j41(80,"th",39),t.EFF(81,"Item no"),t.k0s(),t.j41(82,"th",40),t.EFF(83,"Start Time"),t.k0s(),t.j41(84,"th",40),t.EFF(85,"End Time"),t.k0s(),t.j41(86,"th",41),t.EFF(87,"Late Start Reason"),t.k0s(),t.j41(88,"th",40),t.EFF(89,"Change Over Time"),t.k0s(),t.j41(90,"th",39),t.EFF(91,"Actual Bottle Produced"),t.k0s(),t.j41(92,"th",39),t.EFF(93,"Total Run Time (Mins)"),t.k0s(),t.j41(94,"th",39),t.EFF(95,"Shift Comments"),t.k0s(),t.j41(96,"th",39),t.EFF(97,"Down Time (Mins)"),t.k0s(),t.j41(98,"th",39),t.EFF(99,"DT Comments"),t.k0s(),t.j41(100,"th",39),t.EFF(101,"HC"),t.k0s(),t.j41(102,"th",39),t.EFF(103,"Case Attainment"),t.k0s(),t.j41(104,"th",39),t.EFF(105,"Case Target"),t.k0s(),t.j41(106,"th",39),t.EFF(107,"%"),t.k0s(),t.j41(108,"th",39),t.EFF(109,"Bottle Target"),t.k0s(),t.j41(110,"th",39),t.EFF(111,"Shift Index"),t.k0s(),t.j41(112,"th",39),t.EFF(113,"Criteria"),t.k0s(),t.j41(114,"th",39),t.EFF(115,"Missing FG Items"),t.k0s(),t.j41(116,"th",39),t.EFF(117,"Non Production Time"),t.k0s(),t.j41(118,"th",39),t.EFF(119,"Additional Comments"),t.k0s(),t.j41(120,"th",39),t.EFF(121,"Time Per Person"),t.k0s(),t.j41(122,"th",39),t.EFF(123,"Total Mins"),t.k0s(),t.j41(124,"th",39),t.EFF(125,"Description"),t.k0s(),t.j41(126,"th",42),t.EFF(127,"Action"),t.k0s()()(),t.j41(128,"tbody"),t.DNE(129,mt,54,24,"tr",43),t.k0s()()()()(),t.j41(130,"div",18)(131,"div",44)(132,"button",45),t.EFF(133,"Save"),t.k0s()()()()()()()}if(2&o){const i=t.sdS(25);t.R7$(9),t.Y8G("ngIf",a.IsViewPermission),t.R7$(),t.Y8G("formGroup",a.laborVarianceForm),t.R7$(12),t.Y8G("matDatepicker",i)("max",a.getToday()),t.R7$(),t.Y8G("for",i),t.R7$(3),t.Y8G("control",a.laborVarianceForm.controls.DateTime)("message","Date Time")("formSubmitted",a.isFormSubmitted),t.R7$(6),t.Y8G("ngForOf",a.shiftList),t.R7$(),t.Y8G("control",a.laborVarianceForm.controls.ShiftId)("message","Shift")("formSubmitted",a.isFormSubmitted),t.R7$(6),t.Y8G("ngForOf",a.fillingLineList),t.R7$(),t.Y8G("control",a.laborVarianceForm.controls.ProductLineId)("message","Product Line")("formSubmitted",a.isFormSubmitted),t.R7$(6),t.Y8G("control",a.laborVarianceForm.controls.Employees)("message","Employees")("formSubmitted",a.isFormSubmitted),t.R7$(6),t.Y8G("control",a.laborVarianceForm.controls.TempEmployee)("message","Temp Employee")("formSubmitted",a.isFormSubmitted),t.R7$(6),t.Y8G("control",a.laborVarianceForm.controls.TotalEmployee)("message","Total Employee")("formSubmitted",a.isFormSubmitted),t.R7$(6),t.Y8G("control",a.laborVarianceForm.controls.Note)("message","Note")("formSubmitted",a.isFormSubmitted),t.R7$(7),t.Y8G("ngForOf",null==a.LaborVarianceDetails?null:a.LaborVarianceDetails.controls),t.R7$(58),t.Y8G("ngForOf",a.AddedlaborVarianceDetailsList)}},dependencies:[h.Sq,h.bT,m.qT,m.me,m.Q0,m.BC,m.cb,m.j4,m.JD,m.$R,m.v8,C.It,C.$z,C.iY,L.rl,L.nJ,L.yw,Z.fg,_.An,q.VO,tt.wT,S.Vh,S.bZ,S.bU,et.T,ot.r,I.zk,I.v2],styles:[".card[_ngcontent-%COMP%]{margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:.75rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.full-width[_ngcontent-%COMP%]{width:100%}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.card-header[_ngcontent-%COMP%]{background-color:#17bb58!important;border-bottom:1px solid rgb(23,187,88)!important;padding:.75rem 1.25rem;color:#fff}.back-Green[_ngcontent-%COMP%]{background-color:#17bb58!important;color:#fff!important}.icon-green[_ngcontent-%COMP%]{color:green}"]})}return r})();n(9239);const ut=[{path:"",component:(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275cmp=t.VBU({type:r,selectors:[["app-labor-variance"]],decls:1,vars:0,template:function(o,a){1&o&&t.nrm(0,"router-outlet")},dependencies:[p.n3]})}return r})(),children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:A,canActivate:[D.L],data:{permission:"Production Order (PER_PURCHASEORDER) - View"}},{path:"add",canActivate:[D.L],data:{permission:"Production Order (PER_PURCHASEORDER) - View"},component:y},{path:"edit/:id",canActivate:[D.L],data:{permission:"Production Order (PER_PURCHASEORDER) - View"},component:y}]}];let ht=(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275mod=t.$C({type:r});static#o=this.\u0275inj=t.G2t({imports:[p.iI.forChild(ut),p.iI]})}return r})();var pt=n(1774),ft=n(9830);let bt=(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275mod=t.$C({type:r});static#o=this.\u0275inj=t.G2t({providers:[k,(0,ft._c)()],imports:[h.MD,ht,pt.Gg,I.c9]})}return r})()}}]);