"use strict";(self.webpackChunkskyward_admin=self.webpackChunkskyward_admin||[]).push([[956],{38956:(Pt,L,l)=>{l.r(L),l.d(L,{LiquidPreparationModule:()=>Tt});var h=l(60177),p=l(18498),m=l(4434),t=l(54438);let v=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-liquid-preparation"]],decls:1,vars:0,template:function(o,e){1&o&&t.nrm(0,"router-outlet")},dependencies:[p.n3]})}return a})();var q=l(21626);let k=(()=>{class a{constructor(i,o){this.http=i,this._baseService=o}getStartEndBatchCheckList(){return this.http.get(`${m.T6.StartEndBatchChecklist}`)}getTankMasterList(){return this.http.get(`${m.T6.GetAllTankMaster}`)}getMaterialMasterList(){return this.http.get(`${m.T6.GetAllMaterialMaster}`)}getProductInstructionDetailsList(){return this.http.get(`${m.T6.GetAllProductInstructionDetails}`)}getQCTSpecificationMasterList(){return this.http.get(`${m.T6.GetAllQCTSpecificationMaster}`)}getliquidPreparationList(){return this.http.get(`${m.T6.LiquidPreparationList}`)}addLiquidPreparation(i){return this.http.post(`${m.T6.LiquidPreparationAdd}`,i)}updateLiquidPreparation(i){return this.http.post(`${m.T6.LiquidPreparationEdit}`,i)}getByIdLiquidPreparation(i){return this.http.get(`${m.T6.LiquidPreparationGetById}?id=`+i)}DeleteLiquidPreparation(i){return this.http.get(`${m.T6.LiquidPreparationDelete}?id=`+i)}static#t=this.\u0275fac=function(o){return new(o||a)(t.KVO(q.Qq),t.KVO(m.dD))};static#i=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var E=l(45794),g=l(88834),S=l(99213),b=l(33380),D=l(30220),A=l(49239);let T=(()=>{class a{constructor(){this.searchChanged=new t.bkB,this.searchData={},this.searchKey="startDateTime , endDateTime, shiftName"}updateSearchTerms(i,o){this.searchData[i]=o,this.searchChanged.emit(this.searchData)}static#t=this.\u0275fac=function(o){return new(o||a)};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["liquid-preparation-search-panel"]],outputs:{searchChanged:"searchChanged"},decls:3,vars:1,consts:[[1,"row"],[1,"col-lg-6"],[3,"textSearchEntered","placeHolder"]],template:function(o,e){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"search-text",2),t.bIt("textSearchEntered",function(r){return e.updateSearchTerms(e.searchKey,r)}),t.k0s()()()),2&o&&(t.R7$(2),t.Y8G("placeHolder","Search Shift"))},dependencies:[A.D]})}return a})();var N=l(96081);const R=()=>["../","add"],x=()=>({emptyMessage:"No Data to Display",totalMessage:"Total"}),G=a=>["..","edit",a];function $(a,s){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const i=s.value;t.R7$(),t.JRh(t.i5U(2,1,i,"MM/dd/yyyy hh:mm a"))}}function B(a,s){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&a){const i=s.value;t.R7$(),t.JRh(t.i5U(2,1,i,"MM/dd/yyyy hh:mm a"))}}function Y(a,s){if(1&a&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&a){const i=s.value;t.R7$(),t.JRh(i)}}function M(a,s){if(1&a&&(t.j41(0,"a",20)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s()()),2&a){const i=t.XpG().row;t.Y8G("routerLink",t.eq3(1,G,i.id))}}function w(a,s){if(1&a){const i=t.RV6();t.DNE(0,M,3,3,"a",18),t.j41(1,"button",19),t.bIt("click",function(){const e=t.eBV(i).row,n=t.XpG();return t.Njj(n.removeliquidPreparation(e.id))}),t.j41(2,"mat-icon"),t.EFF(3,"close"),t.k0s()()}if(2&a){const i=t.XpG();t.Y8G("authPermission",i.page+"_"+i.permissions.edit)}}let y=(()=>{class a{constructor(i,o){this.liquidPreparationService=i,this.notificationService=o,this.liquidPreparationData=[],this.page=m.Wt.liquidPreparation,this.permissions=m.eZ,this.searchData={}}ngOnInit(){this.getliquidPreparationData()}getliquidPreparationData(){this.loading=!0,this.liquidPreparationService.getliquidPreparationList().subscribe(i=>{this.liquidPreparationData=i,console.log("liquidPreparationData list",this.liquidPreparationData),this.loading=!1},i=>{this.error=i,this.loading=!1})}removeliquidPreparation(i){confirm("Are you sure, you want to delete this Liquid Preparation?")&&this.liquidPreparationService.DeleteLiquidPreparation(i).subscribe(()=>{this.getliquidPreparationData()},()=>{this.notificationService.error("Something went wrong.")})}updateSearch(i){this.searchData=Object.assign({},i),console.log("serach data",this.searchData)}isActiveRow(i){return{"text-danger":!i.isActive}}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(k),t.rXU(E.tw))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-list"]],decls:25,vars:16,consts:[[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end","leftSideHeader"],[1,"mb20","float-left"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end","rightSideHeader","mb10"],["mat-flat-button","","color","primary",1,"app-button",3,"routerLink"],[1,"icon-plus"],[1,"row"],[1,"col-12"],[3,"searchChanged"],[1,"material",3,"rows","columnMode","headerHeight","footerHeight","rowHeight","limit","loadingIndicator","scrollbarH","messages"],["name","StartDate","prop","startDateTime"],["ngx-datatable-cell-template",""],["name","End Date","prop","endDateTime"],["name","Shift","prop","shiftName"],["name","Actions",3,"sortable"],["class","button-padding","color","primary",3,"routerLink",4,"authPermission"],["type","button",2,"border","none","background-color","white","color","red",3,"click"],["color","primary",1,"button-padding",3,"routerLink"]],template:function(o,e){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t.EFF(6,"Liquid Preparation List"),t.k0s()(),t.j41(7,"div",6)(8,"a",7)(9,"span"),t.EFF(10,"Add New"),t.k0s(),t.nrm(11,"i",8),t.k0s()()(),t.j41(12,"div",9)(13,"div",10)(14,"liquid-preparation-search-panel",11),t.bIt("searchChanged",function(r){return e.updateSearch(r)}),t.k0s(),t.j41(15,"ngx-datatable",12),t.nI1(16,"searchtable"),t.j41(17,"ngx-datatable-column",13),t.DNE(18,$,3,4,"ng-template",14),t.k0s(),t.j41(19,"ngx-datatable-column",15),t.DNE(20,B,3,4,"ng-template",14),t.k0s(),t.j41(21,"ngx-datatable-column",16),t.DNE(22,Y,2,1,"ng-template",14),t.k0s(),t.j41(23,"ngx-datatable-column",17),t.DNE(24,w,4,1,"ng-template",14),t.k0s()()()()()()()),2&o&&(t.R7$(8),t.Y8G("routerLink",t.lJ4(14,R)),t.R7$(7),t.Y8G("rows",t.i5U(16,11,e.liquidPreparationData,e.searchData))("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight","auto")("limit",10)("loadingIndicator",e.loading)("scrollbarH",!0)("messages",t.lJ4(15,x)),t.R7$(8),t.Y8G("sortable",!1))},dependencies:[p.Wk,g.It,S.An,b.ge,b.ed,b.QI,D.B,T,h.vh,N.j]})}return a})();var d=l(89417),V=l(61528),_=l(32102),C=l(99631),Q=l(82798),P=l(86600),j=l(5951),I=l(96850),W=l(67133),f=l(48910);function O(a,s){if(1&a){const i=t.RV6();t.j41(0,"a",28),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.cancel())}),t.EFF(1," View List "),t.k0s()}}function X(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.poNumber," ")}}function U(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.productName," ")}}function H(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.shiftName," ")}}function J(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.tankName," ")}}function z(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.name," ")}}function K(a,s){if(1&a){const i=t.RV6();t.j41(0,"form",29,0)(2,"div",30)(3,"div",31)(4,"div",32)(5,"div",33)(6,"mat-form-field",34),t.nrm(7,"input",35),t.j41(8,"button",36),t.bIt("click",function(){t.eBV(i);const e=t.sdS(12);return t.Njj(e.open())}),t.j41(9,"mat-icon"),t.EFF(10,"calendar_today"),t.k0s()(),t.nrm(11,"ngx-mat-datetime-picker",37,1),t.k0s()(),t.j41(13,"div",33)(14,"mat-form-field",34)(15,"input",38),t.bIt("dateChange",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onEndDateChange())}),t.k0s(),t.j41(16,"button",36),t.bIt("click",function(){t.eBV(i);const e=t.sdS(20);return t.Njj(e.open())}),t.j41(17,"mat-icon"),t.EFF(18,"calendar_today"),t.k0s()(),t.nrm(19,"ngx-mat-datetime-picker",37,2),t.k0s()(),t.j41(21,"div",33)(22,"mat-form-field",39)(23,"mat-label"),t.EFF(24,"Production Order"),t.k0s(),t.j41(25,"mat-select",40),t.DNE(26,X,2,2,"mat-option",41),t.k0s(),t.nrm(27,"mat-validation-message",42),t.k0s()(),t.j41(28,"div",33)(29,"mat-form-field",39)(30,"mat-label"),t.EFF(31,"Product"),t.k0s(),t.j41(32,"mat-select",43),t.DNE(33,U,2,2,"mat-option",41),t.k0s(),t.nrm(34,"mat-validation-message",42),t.k0s()(),t.j41(35,"div",33)(36,"mat-form-field",39)(37,"mat-label"),t.EFF(38,"Shift"),t.k0s(),t.j41(39,"mat-select",44),t.DNE(40,H,2,2,"mat-option",41),t.k0s(),t.nrm(41,"mat-validation-message",42),t.k0s()(),t.j41(42,"div",33)(43,"mat-form-field",39)(44,"mat-label"),t.EFF(45,"Batch Lot Number"),t.k0s(),t.nrm(46,"input",45)(47,"mat-validation-message",42),t.k0s()(),t.j41(48,"div",33)(49,"mat-form-field",39)(50,"mat-label"),t.EFF(51,"Tank"),t.k0s(),t.j41(52,"mat-select",46),t.DNE(53,J,2,2,"mat-option",41),t.k0s(),t.nrm(54,"mat-validation-message",42),t.k0s()(),t.j41(55,"div",33)(56,"mat-form-field",39)(57,"mat-label"),t.EFF(58,"Compounder"),t.k0s(),t.j41(59,"mat-select",47),t.DNE(60,z,2,2,"mat-option",41),t.k0s(),t.nrm(61,"mat-validation-message",42),t.k0s()(),t.j41(62,"div",33)(63,"mat-form-field",39)(64,"mat-label"),t.EFF(65,"Standard Batch Weight"),t.k0s(),t.nrm(66,"input",48)(67,"mat-validation-message",42),t.k0s()()()()()()}if(2&a){const i=t.sdS(12),o=t.sdS(20),e=t.XpG();t.Y8G("formGroup",e.basicForm),t.R7$(7),t.Y8G("ngxMatDatetimePicker",i),t.R7$(8),t.Y8G("ngxMatDatetimePicker",o),t.R7$(10),t.Y8G("disabled",e.isEditMode),t.R7$(),t.Y8G("ngForOf",e.productionOrderList),t.R7$(),t.Y8G("control",e.basicForm.get("SAPProductionOrderId"))("message","Production Order")("formSubmitted",e.isBasicFormSubmitted),t.R7$(5),t.Y8G("disabled",e.isEditMode),t.R7$(),t.Y8G("ngForOf",e.productList),t.R7$(),t.Y8G("control",e.basicForm.controls.ProductId)("message","Product")("formSubmitted",e.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.shiftList),t.R7$(),t.Y8G("control",e.basicForm.controls.ShiftId)("message","Shift")("formSubmitted",e.isBasicFormSubmitted),t.R7$(6),t.Y8G("control",e.basicForm.controls.BatchLotNumber)("message","Batch Lot Number")("formSubmitted",e.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.tankList),t.R7$(),t.Y8G("control",e.basicForm.controls.TankId)("message","Tank")("formSubmitted",e.isBasicFormSubmitted),t.R7$(6),t.Y8G("ngForOf",e.usersList),t.R7$(),t.Y8G("control",e.basicForm.controls.CompounderUserId)("message","Compounder")("formSubmitted",e.isBasicFormSubmitted),t.R7$(6),t.Y8G("control",e.basicForm.controls.StandardBatchWeight)("message","Standard Batch Weight")("formSubmitted",e.isBasicFormSubmitted)}}function Z(a,s){1&a&&(t.j41(0,"mat-form-field",39)(1,"mat-label"),t.EFF(2,"Reason"),t.k0s(),t.nrm(3,"input",61),t.k0s())}function tt(a,s){if(1&a){const i=t.RV6();t.j41(0,"div",52)(1,"div",32)(2,"div",53)(3,"mat-label"),t.EFF(4),t.k0s()(),t.j41(5,"div",54)(6,"mat-radio-group",55),t.bIt("change",function(e){const n=t.eBV(i).index,r=t.XpG(2);return t.Njj(r.onAnswerChange(e,n))}),t.j41(7,"mat-radio-button",56),t.EFF(8,"Yes"),t.k0s(),t.j41(9,"mat-radio-button",57),t.EFF(10,"No"),t.k0s(),t.j41(11,"mat-radio-button",58),t.EFF(12,"NA"),t.k0s()()(),t.j41(13,"div",59),t.DNE(14,Z,4,0,"mat-form-field",60),t.k0s()()()}if(2&a){const i=s.$implicit;t.Y8G("formGroupName",s.index),t.R7$(4),t.JRh(i.get("question").value),t.R7$(10),t.Y8G("ngIf","NA"===i.get("answer").value)}}function it(a,s){if(1&a&&(t.j41(0,"form",29,0)(2,"div",30)(3,"div",31)(4,"div",32)(5,"div",50),t.DNE(6,tt,15,3,"div",51),t.k0s()()()()()),2&a){const i=t.XpG();t.Y8G("formGroup",i.StartCheckListForm),t.R7$(6),t.Y8G("ngForOf",i.questionsArray.controls)}}function et(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.instruction," ")}}function at(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.materialName," ")}}function ot(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.name," ")}}function nt(a,s){if(1&a){const i=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td"),t.EFF(14),t.nI1(15,"date"),t.k0s(),t.j41(16,"td")(17,"button",80),t.bIt("click",function(){const e=t.eBV(i),n=e.$implicit,r=e.index,u=t.XpG(2);return t.Njj(u.onEditDetail(n,r))}),t.nrm(18,"i",81),t.k0s(),t.j41(19,"button",82),t.bIt("click",function(){const e=t.eBV(i).index,n=t.XpG(2);return t.Njj(n.removeDetail(e))}),t.nrm(20,"i",83),t.k0s()()()}if(2&a){const i=s.$implicit;t.R7$(2),t.SpI(" ",i.InstructionName," "),t.R7$(2),t.SpI(" ",i.MaterialName," "),t.R7$(2),t.SpI(" ",i.LotNumber," "),t.R7$(2),t.SpI(" ",i.Weight," "),t.R7$(2),t.SpI(" ",i.WeightAdded," "),t.R7$(2),t.SpI(" ",i.DoneByNames," "),t.R7$(2),t.SpI(" ",t.i5U(15,7,i.AddedTime,"yyyy-MM-dd HH:mm:ss")," ")}}function st(a,s){if(1&a){const i=t.RV6();t.j41(0,"form",29,0)(2,"div",30)(3,"div",62)(4,"h5",11),t.EFF(5,"Instruction Details"),t.k0s()(),t.j41(6,"div",31)(7,"div",32)(8,"div",33)(9,"mat-form-field",39)(10,"mat-label"),t.EFF(11,"Instruction"),t.k0s(),t.j41(12,"mat-select",63),t.bIt("selectionChange",function(e){t.eBV(i);const n=t.XpG();return t.Njj(n.onInstructionChange(e))}),t.DNE(13,et,2,2,"mat-option",41),t.k0s(),t.nrm(14,"mat-validation-message",42),t.k0s()(),t.j41(15,"div",33)(16,"mat-form-field",39)(17,"mat-label"),t.EFF(18,"Material"),t.k0s(),t.j41(19,"mat-select",64),t.DNE(20,at,2,2,"mat-option",41),t.k0s(),t.nrm(21,"mat-validation-message",42),t.k0s()(),t.j41(22,"div",33)(23,"mat-form-field",39)(24,"mat-label"),t.EFF(25,"Lot Number"),t.k0s(),t.nrm(26,"input",65)(27,"mat-validation-message",42),t.k0s()(),t.j41(28,"div",33)(29,"mat-form-field",39)(30,"mat-label"),t.EFF(31,"Weight"),t.k0s(),t.nrm(32,"input",66)(33,"mat-validation-message",42),t.k0s()(),t.j41(34,"div",33)(35,"mat-form-field",39)(36,"mat-label"),t.EFF(37,"Weight Added"),t.k0s(),t.nrm(38,"input",67)(39,"mat-validation-message",42),t.k0s()(),t.j41(40,"div",33)(41,"mat-form-field",39)(42,"mat-label"),t.EFF(43,"Done By"),t.k0s(),t.j41(44,"mat-select",68),t.DNE(45,ot,2,2,"mat-option",41),t.k0s(),t.nrm(46,"mat-validation-message",42),t.k0s()(),t.j41(47,"div",33)(48,"mat-form-field",39)(49,"mat-label"),t.EFF(50,"Added Time"),t.k0s(),t.nrm(51,"input",69)(52,"mat-validation-message",42),t.k0s()(),t.j41(53,"div",70)(54,"button",71),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.addInstruction())}),t.j41(55,"mat-icon"),t.EFF(56,"add"),t.k0s()()()()()(),t.j41(57,"div",32)(58,"div",72)(59,"div",73)(60,"table",74)(61,"thead",75)(62,"tr")(63,"th",76),t.EFF(64,"Instruction"),t.k0s(),t.j41(65,"th"),t.EFF(66,"Material & Part Code"),t.k0s(),t.j41(67,"th"),t.EFF(68,"Lot Number "),t.k0s(),t.j41(69,"th"),t.EFF(70,"Weight (kg)"),t.k0s(),t.j41(71,"th"),t.EFF(72,"Weight Added (kg)"),t.k0s(),t.j41(73,"th"),t.EFF(74,"Done By"),t.k0s(),t.j41(75,"th"),t.EFF(76," Added Time "),t.k0s(),t.j41(77,"th"),t.EFF(78,"Action"),t.k0s()()(),t.j41(79,"tbody"),t.DNE(80,nt,21,10,"tr",77),t.j41(81,"tr")(82,"td",78)(83,"strong"),t.EFF(84,"Total"),t.k0s()(),t.j41(85,"td")(86,"strong"),t.EFF(87),t.k0s()(),t.j41(88,"td")(89,"strong"),t.EFF(90),t.k0s()(),t.nrm(91,"td",79),t.k0s()()()()()()()}if(2&a){const i=t.XpG();t.Y8G("formGroup",i.InstructionForm),t.R7$(13),t.Y8G("ngForOf",i.productInstructionDetailsList),t.R7$(),t.Y8G("control",i.InstructionForm.controls.InstructionId)("message","Instruction")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.materialMasterList),t.R7$(),t.Y8G("control",i.InstructionForm.controls.MaterialId)("message","Material")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",i.InstructionForm.controls.LotNumber)("message","Lot Number")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",i.InstructionForm.controls.Weight)("message","Weight")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(6),t.Y8G("control",i.InstructionForm.controls.WeightAdded)("message","Weight Added")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(6),t.Y8G("ngForOf",i.usersList),t.R7$(),t.Y8G("control",i.InstructionForm.controls.DoneByIds)("message","Done By")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(5),t.Y8G("disabled",!0),t.R7$(),t.Y8G("control",i.InstructionForm.controls.AddedTime)("message","Added Time")("formSubmitted",i.isInstructionFormSubmitted),t.R7$(28),t.Y8G("ngForOf",i.AddedInstructionList),t.R7$(7),t.JRh(i.totalWeight),t.R7$(3),t.JRh(i.totalWeightAdded)}}function rt(a,s){1&a&&(t.j41(0,"mat-form-field",39)(1,"mat-label"),t.EFF(2,"Reason"),t.k0s(),t.nrm(3,"input",61),t.k0s())}function dt(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.tankName," ")}}function lt(a,s){if(1&a&&(t.j41(0,"mat-form-field",39)(1,"mat-label"),t.EFF(2,"Tank"),t.k0s(),t.j41(3,"mat-select",84),t.DNE(4,dt,2,2,"mat-option",41),t.k0s()()),2&a){const i=t.XpG(3);t.R7$(4),t.Y8G("ngForOf",i.tankList)}}function ct(a,s){if(1&a){const i=t.RV6();t.j41(0,"div",52)(1,"div",32)(2,"div",53)(3,"mat-label"),t.EFF(4),t.k0s()(),t.j41(5,"div",54)(6,"mat-radio-group",55),t.bIt("change",function(e){const n=t.eBV(i).index,r=t.XpG(2);return t.Njj(r.onAnswerChange(e,n))}),t.j41(7,"mat-radio-button",56),t.EFF(8,"Yes"),t.k0s(),t.j41(9,"mat-radio-button",57),t.EFF(10,"No"),t.k0s(),t.j41(11,"mat-radio-button",58),t.EFF(12,"NA"),t.k0s()()(),t.j41(13,"div",59),t.DNE(14,rt,4,0,"mat-form-field",60)(15,lt,5,1,"mat-form-field",60),t.k0s()()()}if(2&a){const i=s.$implicit;t.Y8G("formGroupName",s.index),t.R7$(4),t.JRh(i.get("question").value),t.R7$(10),t.Y8G("ngIf","NA"===i.get("answer").value),t.R7$(),t.Y8G("ngIf",27==i.get("id").value&&"Yes"===i.get("answer").value)}}function mt(a,s){if(1&a&&(t.j41(0,"form",29,0)(2,"div",30)(3,"div",31)(4,"div",32)(5,"div",50),t.DNE(6,ct,16,4,"div",51),t.k0s()()()()()),2&a){const i=t.XpG();t.Y8G("formGroup",i.EndCheckListForm),t.R7$(6),t.Y8G("ngForOf",i.EndquestionsArray.controls)}}function ut(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.name," ")}}function pt(a,s){if(1&a&&(t.j41(0,"mat-option",49),t.EFF(1),t.k0s()),2&a){const i=s.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.specificationName," ")}}function ht(a,s){if(1&a){const i=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.nI1(10,"date"),t.k0s(),t.j41(11,"td"),t.EFF(12),t.nI1(13,"date"),t.k0s(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.j41(18,"td"),t.EFF(19),t.k0s(),t.j41(20,"td")(21,"button",80),t.bIt("click",function(){const e=t.eBV(i),n=e.$implicit,r=e.index,u=t.XpG(2);return t.Njj(u.onEditQualityDetail(n,r))}),t.nrm(22,"i",81),t.k0s(),t.j41(23,"button",82),t.bIt("click",function(){const e=t.eBV(i).index,n=t.XpG(2);return t.Njj(n.removeQualityDetail(e))}),t.nrm(24,"i",83),t.k0s()()()}if(2&a){const i=s.$implicit,o=s.index;t.R7$(2),t.SpI(" ",o+1," "),t.R7$(2),t.SpI(" ",t.i5U(5,8,i.TestingDateTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",i.DoneByNames," "),t.R7$(2),t.SpI(" ",t.i5U(10,11,i.SampleReceivedTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",t.i5U(13,14,i.SampleTestedTime,"yyyy-MM-dd HH:mm:ss")," "),t.R7$(3),t.SpI(" ",i.SpecificationLimitName," "),t.R7$(2),t.SpI(" ",i.Test1," "),t.R7$(2),t.SpI(" ",i.Test2," ")}}function ft(a,s){if(1&a){const i=t.RV6();t.j41(0,"form",29,0)(2,"div",30)(3,"div",62)(4,"h5",11),t.EFF(5,"Quality Details"),t.k0s()(),t.j41(6,"div",31)(7,"div",32)(8,"div",33)(9,"mat-form-field",34),t.nrm(10,"input",85),t.j41(11,"button",36),t.bIt("click",function(){t.eBV(i);const e=t.sdS(15);return t.Njj(e.open())}),t.j41(12,"mat-icon"),t.EFF(13,"calendar_today"),t.k0s()(),t.nrm(14,"ngx-mat-datetime-picker",37,3),t.k0s()(),t.j41(16,"div",33)(17,"mat-form-field",39)(18,"mat-label"),t.EFF(19,"Analysis Done By"),t.k0s(),t.j41(20,"mat-select",86),t.DNE(21,ut,2,2,"mat-option",41),t.k0s(),t.nrm(22,"mat-validation-message",42),t.k0s()(),t.j41(23,"div",33)(24,"mat-form-field",34),t.nrm(25,"input",87),t.j41(26,"button",36),t.bIt("click",function(){t.eBV(i);const e=t.sdS(30);return t.Njj(e.open())}),t.j41(27,"mat-icon"),t.EFF(28,"calendar_today"),t.k0s()(),t.nrm(29,"ngx-mat-datetime-picker",37,4),t.k0s()(),t.j41(31,"div",33)(32,"mat-form-field",34),t.nrm(33,"input",88),t.j41(34,"button",36),t.bIt("click",function(){t.eBV(i);const e=t.sdS(38);return t.Njj(e.open())}),t.j41(35,"mat-icon"),t.EFF(36,"calendar_today"),t.k0s()(),t.nrm(37,"ngx-mat-datetime-picker",37,5),t.k0s()(),t.j41(39,"div",33)(40,"mat-form-field",39)(41,"mat-label"),t.EFF(42,"Specification Limit"),t.k0s(),t.j41(43,"mat-select",89),t.DNE(44,pt,2,2,"mat-option",41),t.k0s(),t.nrm(45,"mat-validation-message",42),t.k0s()(),t.j41(46,"div",33)(47,"mat-form-field",39)(48,"mat-label"),t.EFF(49,"Result"),t.k0s(),t.nrm(50,"input",90),t.k0s()(),t.j41(51,"div",33)(52,"mat-form-field",39)(53,"mat-label"),t.EFF(54," Comments"),t.k0s(),t.nrm(55,"input",91),t.k0s()(),t.j41(56,"div",70)(57,"button",71),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.addQuality())}),t.j41(58,"mat-icon"),t.EFF(59,"add"),t.k0s()()()()()(),t.j41(60,"div",32)(61,"div",72)(62,"div",73)(63,"table",92)(64,"thead",75)(65,"tr")(66,"th"),t.EFF(67,"Id"),t.k0s(),t.j41(68,"th"),t.EFF(69,"Date Tested"),t.k0s(),t.j41(70,"th"),t.EFF(71,"Analysis Done By"),t.k0s(),t.j41(72,"th"),t.EFF(73,"Sample Received At"),t.k0s(),t.j41(74,"th"),t.EFF(75,"Sample Tested At"),t.k0s(),t.j41(76,"th"),t.EFF(77,"Specification Limit"),t.k0s(),t.j41(78,"th"),t.EFF(79,"Result"),t.k0s(),t.j41(80,"th"),t.EFF(81,"Comments"),t.k0s(),t.j41(82,"th"),t.EFF(83,"Action"),t.k0s()()(),t.j41(84,"tbody"),t.DNE(85,ht,25,17,"tr",77),t.k0s()()()()()()}if(2&a){const i=t.sdS(15),o=t.sdS(30),e=t.sdS(38),n=t.XpG();t.Y8G("formGroup",n.QualityForm),t.R7$(10),t.Y8G("ngxMatDatetimePicker",i),t.R7$(11),t.Y8G("ngForOf",n.usersList),t.R7$(),t.Y8G("control",n.QualityForm.controls.AnalysisDoneByIds)("message","Analysis Done By")("formSubmitted",n.isQualityFormSubmitted),t.R7$(3),t.Y8G("ngxMatDatetimePicker",o),t.R7$(8),t.Y8G("ngxMatDatetimePicker",e),t.R7$(11),t.Y8G("ngForOf",n.qCTSpecificationMasterList),t.R7$(),t.Y8G("control",n.QualityForm.controls.SpecificationLimitId)("message","Material")("formSubmitted",n.isQualityFormSubmitted),t.R7$(40),t.Y8G("ngForOf",n.AddedQualityList)}}function gt(a,s){if(1&a&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s()()),2&a){const i=s.$implicit;t.R7$(2),t.SpI(" ",i.MaterialName," "),t.R7$(2),t.SpI(" ",i.WeightAdded," "),t.R7$(2),t.SpI(" ",i.diffWeight," "),t.R7$(2),t.SpI(" ",i.Weight," ")}}function _t(a,s){if(1&a&&(t.j41(0,"div",30)(1,"div",62)(2,"h5",11),t.EFF(3,"Adjustment Details"),t.k0s()(),t.j41(4,"div",31)(5,"div",32)(6,"div",72)(7,"div",73)(8,"table",93)(9,"thead",75)(10,"tr",94)(11,"th",95),t.EFF(12,"Material & Part Code"),t.k0s(),t.j41(13,"th",95),t.EFF(14,"Weight "),t.k0s(),t.j41(15,"th",76),t.EFF(16,"Adjustment"),t.k0s(),t.j41(17,"th",95),t.EFF(18,"Total"),t.k0s()()(),t.j41(19,"tbody"),t.DNE(20,gt,9,4,"tr",77),t.k0s()()()()()()()),2&a){const i=t.XpG();t.R7$(20),t.Y8G("ngForOf",i.DiffWghInstructionList)}}function It(a,s){if(1&a){const i=t.RV6();t.j41(0,"button",96),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.goToNextTab())}),t.EFF(1,"Draft &Next"),t.k0s()}if(2&a){const i=t.XpG();t.Y8G("disabled",i.selectedIndex===i.tabCount-1)}}function kt(a,s){if(1&a){const i=t.RV6();t.j41(0,"button",97),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.Submit())}),t.EFF(1,"Submit"),t.k0s()}}let F=(()=>{class a{constructor(i,o,e,n,r,u,c){this.activatedRoute=i,this.router=o,this.formBuilder=e,this.liquidPreparationService=n,this.notificationService=r,this.weightCheckService=u,this.cdr=c,this.selectedIndex=0,this.tabCount=6,this.isstartChecklistDisable=!0,this.isInstructionsDisable=!0,this.isEndChecklistDisable=!0,this.isQualityDisable=!0,this.isAdjustmentDisable=!0,this.page=m.Wt.liquidPreparation,this.permissions=m.eZ,this.isEndDateOk=!0,this.StartCheckListQueList=[],this.AddedInstructionList=[],this.DiffWghInstructionList=[],this.EditInstructionId=-1,this.totalWeight=0,this.totalWeightAdded=0,this.EndCheckListQueList=[],this.AddedQualityList=[],this.EditQualityId=-1,this.shiftList=[],this.productionOrderList=[],this.productList=[],this.usersList=[],this.startEndBatchChecklist=[],this.materialMasterList=[],this.productInstructionDetailsList=[],this.qCTSpecificationMasterList=[],this.tankList=[],this.createForm()}ngOnInit(){this.loadDropdowns(),this.getRoute()}getRoute(){this.routerSub=this.activatedRoute.params.subscribe(i=>{this.isEditMode=!m.ov.isEmpty(i.id),this.createForm(),this.isEditMode&&(this.liquidPreparationId=i.id,this.getLiquidPreparationById())})}goToPreviousTab(){this.selectedIndex>0&&this.selectedIndex--}goToNextTab(){if(0===this.selectedIndex)this.isBasicFormSubmitted=!0,console.log("basic form value",this.basicForm.value),this.basicForm.valid&&this.isEndDateOk&&(this.draftBasicFormValue=this.basicForm.value,this.isstartChecklistDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++);else if(1===this.selectedIndex){this.isStartCheckListFormSubmitted=!0,console.log("start check form value",this.StartCheckListForm.value);let i=this.StartCheckListValidation();this.StartCheckListForm.valid&&i&&(this.draftStartCheckListFormValue=this.StartCheckListForm.value,this.isInstructionsDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++)}else if(2===this.selectedIndex){if(this.AddedInstructionList.length<=0)return void this.notificationService.error("select at least one instruction");this.DiffWghInstructionList=[],this.AddedInstructionList.forEach(i=>{(i.diffWeight>0||i.diffWeight<0)&&this.DiffWghInstructionList.push(i)}),this.isEndChecklistDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++}else if(3===this.selectedIndex){this.isEndCheckListFormSubmitted=!0,console.log("end check form value",this.EndCheckListForm.value);let i=this.EndCheckListValidation();this.EndCheckListForm.valid&&i&&(this.draftEndCheckListFormValue=this.EndCheckListForm.value,this.isQualityDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++)}else if(4===this.selectedIndex){if(this.AddedQualityList.length<=0)return void this.notificationService.error("select at least one Quality");this.isAdjustmentDisable=!1,this.selectedIndex<this.tabCount-1&&this.selectedIndex++}else 5===this.selectedIndex&&console.log("added adjustment",this.DiffWghInstructionList)}onEndDateChange(){const i=this.basicForm.get("EndDateTime")?.value,o=this.basicForm.get("StartDateTime")?.value;o||(this.notificationService.error("please select Start date"),this.isEndDateOk=!1),o&&i&&new Date(i)<=new Date(o)?(this.notificationService.error("End date should be greated than Start date"),this.isEndDateOk=!1):(this.basicForm.get("EndDateTime")?.updateValueAndValidity(),this.isEndDateOk=!0)}getLiquidPreparationById(){this.liquidPreparationService.getByIdLiquidPreparation(this.liquidPreparationId).subscribe(i=>{this.liquidPreparationData=i,this.setLiquidPreparationkData(),console.log("get by id data",i)},i=>{console.log(i)})}setLiquidPreparationkData(){this.basicForm.patchValue({StartDateTime:this.liquidPreparationData.startDateTime,EndDateTime:this.liquidPreparationData.endDateTime,SAPProductionOrderId:this.liquidPreparationData.sapProductionOrderId,ProductId:this.liquidPreparationData.productId,ShiftId:this.liquidPreparationData.shiftId,BatchLotNumber:parseInt(this.liquidPreparationData.batchLotNumber),TankId:this.liquidPreparationData.tankId,CompounderUserId:this.liquidPreparationData.compounderUserId,StandardBatchWeight:parseInt(this.liquidPreparationData.standardBatchWeight)}),this.basicForm.get("SAPProductionOrderId").disable(),this.basicForm.get("ProductId").disable(),setTimeout(()=>{let i=[],o=[];this.liquidPreparationData.liquidPreparationChecklistDetails.forEach(e=>{"1"===e.type?i.push(e):o.push(e)}),i.forEach(e=>{const n=this.StartCheckListForm.get("questions")?.value.find(r=>r.id===e.questionId);if(n){const r=this.StartCheckListForm.get("questions")?.value.indexOf(n);-1!==r&&this.StartCheckListForm.get("questions").at(r).patchValue({answer:e.answer,tankId:e.tankId?e.tankId:"",tankNo:e.tankNo?e.tankNo:"",reason:e.reason})}}),o.forEach(e=>{const n=this.EndCheckListForm.get("questions")?.value.find(r=>r.id===e.questionId);if(n){const r=this.EndCheckListForm.get("questions")?.value.indexOf(n);-1!==r&&this.EndCheckListForm.get("questions").at(r).patchValue({answer:e.answer,tankId:e.tankId?e.tankId:"",tankNo:e.tankNo?e.tankNo:"",reason:e.reason})}}),this.liquidPreparationData.liquidPreparationInstructionDetails.forEach(e=>{let n=e.weight-e.weightAdded,r=this.usersList.filter(c=>e.doneByIds?.includes(c.id)).map(c=>c.name).join(", "),u={InstructionId:e.instructionId,MaterialId:e.materialId,LotNumber:parseInt(e.lotNumber),Weight:e.weight,WeightAdded:e.weightAdded,DoneByIds:e.doneByIds.split(",").map(c=>parseInt(c,10)),AddedTime:e.addedTime,diffWeight:n||0,DoneByNames:r,InstructionName:this.productInstructionDetailsList.find(c=>c.id==e.instructionId)?.instruction,MaterialName:this.materialMasterList.find(c=>c.id==e.materialId)?.materialName};this.AddedInstructionList.push(u)}),this.liquidPreparationData.liquidPreparationSpecificationDetails.forEach(e=>{let r=this.usersList.filter(c=>e.analysisDoneByIds?.includes(c.id)).map(c=>c.name).join(", "),u={TestingDateTime:e.testingDateTime,AnalysisDoneByIds:e.analysisDoneByIds.split(",").map(c=>parseInt(c,10)),SampleReceivedTime:e.sampleReceivedTime,SampleTestedTime:e.sampleTestedTime,SpecificationLimitId:e.specificationLimitId,Test1:e.test1,Test2:e.test2,DoneByNames:r,SpecificationLimitName:this.qCTSpecificationMasterList.find(c=>c.id==e.specificationLimitId)?.specificationName};this.AddedQualityList.push(u)}),console.log("EditPrechecklistData",i)},1e3)}loadDropdowns(){this.weightCheckService.getProductionOrderList().subscribe(i=>{this.productionOrderList=i}),this.weightCheckService.getProductList().subscribe(i=>{this.productList=i}),this.weightCheckService.getUserList().subscribe(i=>{this.usersList=i}),this.weightCheckService.getShiftList().subscribe(i=>{this.shiftList=i}),this.liquidPreparationService.getTankMasterList().subscribe(i=>{this.tankList=i}),this.liquidPreparationService.getStartEndBatchCheckList().subscribe(i=>{this.startEndBatchChecklist=i,this.StartCheckListQueList=i.filter(o=>"1"===o.type),this.EndCheckListQueList=i.filter(o=>"2"===o.type),this.CreateStartChecklIstForm(),this.CreateEndChecklIstForm()}),this.liquidPreparationService.getMaterialMasterList().subscribe(i=>{this.materialMasterList=i}),this.liquidPreparationService.getQCTSpecificationMasterList().subscribe(i=>{this.qCTSpecificationMasterList=i}),this.liquidPreparationService.getProductInstructionDetailsList().subscribe(i=>{this.productInstructionDetailsList=i})}createForm(){this.basicForm=this.formBuilder.group({Id:[{value:"",disabled:!0}],Code:["",""],StartDateTime:["",[d.k0.required]],EndDateTime:["",[d.k0.required]],SAPProductionOrderId:["",[d.k0.required]],ProductId:["",[d.k0.required]],ShiftId:["",[d.k0.required]],BatchLotNumber:["",[d.k0.required]],TankId:["",[d.k0.required]],CompounderUserId:["",[d.k0.required]],StandardBatchWeight:["",[d.k0.required]]}),this.basicForm.controls.StartDateTime.setValue((new Date).toISOString().split("T")[0]),this.CreateInstructionForm(),this.CreateQualityForm()}CreateStartChecklIstForm(){this.StartCheckListForm=this.formBuilder.group({questions:this.formBuilder.array(this.createQuestionControls())})}CreateInstructionForm(){this.EditInstructionId=-1,this.InstructionForm=this.formBuilder.group({InstructionId:["",[d.k0.required]],MaterialId:["",[d.k0.required]],LotNumber:["",[d.k0.required]],Weight:["",[d.k0.required]],WeightAdded:["",[d.k0.required]],DoneByIds:["",[d.k0.required]],AddedTime:["",[d.k0.required]]})}CreateEndChecklIstForm(){this.EndCheckListForm=this.formBuilder.group({questions:this.formBuilder.array(this.createEndQuestionControls())})}CreateQualityForm(){this.EditQualityId=-1,this.QualityForm=this.formBuilder.group({TestingDateTime:["",[d.k0.required]],AnalysisDoneByIds:["",[d.k0.required]],SampleReceivedTime:["",[d.k0.required]],SampleTestedTime:["",[d.k0.required]],SpecificationLimitId:["",[d.k0.required]],Test1:[""],Test2:[""]})}createQuestionControls(){return this.StartCheckListQueList.map(i=>this.formBuilder.group({id:[i.id],question:[i.question],answer:["Yes",d.k0.required],tankNo:[""],tankId:[""],reason:[""]}))}get questionsArray(){return this.StartCheckListForm.get("questions")}onAnswerChange(i,o){if(console.log("ebent & i",i,o),"No"===i.value){this.notificationService.error("You can't select NO");const e=this.StartCheckListForm.get("questions");if(o>=0){const n=e?.at(o);console.log("questiongroup",n),n&&(n.controls.answer?.setValue("Yes",{emitEvent:!0}),this.cdr.detectChanges())}else console.error("Index out of bounds")}}StartCheckListValidation(){const i=this.StartCheckListForm.get("questions");if(!i)return this.notificationService.error("Form is not initialized correctly."),!1;let o=!0;return i.controls.forEach((e,n)=>{const r=e,u=r.get("answer")?.value,c=r.get("reason")?.value;"NA"===u&&(!c||0===c.trim().length)&&(this.notificationService.error("Reason is mandatory when answer is 'NA'."),o=!1)}),o}createEndQuestionControls(){return this.EndCheckListQueList.map(i=>this.formBuilder.group({id:[i.id],question:[i.question],answer:["Yes",d.k0.required],tankNo:[""],tankId:[""],reason:[""]}))}get EndquestionsArray(){return this.EndCheckListForm.get("questions")}onEndAnswerChange(i,o){if(console.log("ebent & i",i,o),"No"===i.value){this.notificationService.error("You can't select NO");const e=this.EndCheckListForm.get("questions");if(o>=0){const n=e?.at(o);console.log("questiongroup",n),n&&(n.controls.answer?.setValue("Yes",{emitEvent:!0}),this.cdr.detectChanges())}else console.error("Index out of bounds")}}EndCheckListValidation(){const i=this.EndCheckListForm.get("questions");if(!i)return this.notificationService.error("Form is not initialized correctly."),!1;let o=!0;return i.controls.forEach((e,n)=>{const r=e,u=r.get("answer")?.value,c=r.get("reason")?.value,yt=r.get("id")?.value,Ct=r.get("tankId")?.value;"NA"===u&&(!c||0===c.trim().length)&&(this.notificationService.error("Reason is mandatory when answer is 'NA'."),o=!1),"Yes"===u&&27==yt&&!Ct&&(this.notificationService.error("Tank is mandatory when Storage tank available 'Yes' ."),o=!1)}),o}onInstructionChange(i){console.log("inst change",i);let o=this.productInstructionDetailsList.find(r=>r.id==i.value).weight;this.InstructionForm.controls.Weight.setValue(o),(new Date).toISOString(),this.InstructionForm.get("AddedTime")?.setValue(new Date)}addInstruction(){if(this.isInstructionFormSubmitted=!0,this.InstructionForm.valid){let i=this.InstructionForm.value;i.diffWeight=i.Weight!=i.WeightAdded?i.Weight-i.WeightAdded:0;let o=this.usersList.filter(n=>i.DoneByIds.includes(n.id)).map(n=>n.name).join(", ");i.DoneByNames=o,i.InstructionName=this.productInstructionDetailsList.find(n=>n.id==i.InstructionId).instruction,i.MaterialName=this.materialMasterList.find(n=>n.id==i.MaterialId).materialName,i.AddedTime=(new Date).toISOString(),console.log("Instruction form value",i),this.EditInstructionId>=0?(this.AddedInstructionList[this.EditInstructionId]=i,this.calculateTotals(),this.InstructionForm.reset(),this.isInstructionFormSubmitted=!1,this.CreateInstructionForm()):(this.AddedInstructionList.push(i),this.calculateTotals(),this.InstructionForm.reset(),this.isInstructionFormSubmitted=!1,this.CreateInstructionForm())}console.log("AddedInstructionList",this.AddedInstructionList)}calculateTotals(){this.totalWeight=this.AddedInstructionList.reduce((i,o)=>i+(o.Weight||0),0),this.totalWeightAdded=this.AddedInstructionList.reduce((i,o)=>i+(o.WeightAdded||0),0)}onEditDetail(i,o){console.log("details selected for edit",this.AddedInstructionList[o]);let e=this.AddedInstructionList[o];this.InstructionForm.patchValue({InstructionId:e.InstructionId,MaterialId:e.MaterialId,LotNumber:e.LotNumber,Weight:e.Weight,WeightAdded:e.WeightAdded,DoneByIds:e.DoneByIds,AddedTime:(new Date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),this.EditInstructionId=o}removeDetail(i){this.AddedInstructionList.splice(i,1),console.log("AddedInstructionList",this.AddedInstructionList)}addQuality(){if(this.isQualityFormSubmitted=!0,this.QualityForm.valid){let i=this.QualityForm.value;console.log("quality formvalue",i);let o=this.usersList.filter(e=>i.AnalysisDoneByIds.includes(e.id)).map(e=>e.name).join(", ");i.DoneByNames=o,i.SpecificationLimitName=this.qCTSpecificationMasterList.find(e=>e.id==i.SpecificationLimitId).specificationName,this.EditQualityId>=0?(this.AddedQualityList[this.EditQualityId]=i,this.QualityForm.reset(),this.isQualityFormSubmitted=!1,this.CreateQualityForm()):(this.AddedQualityList.push(i),this.QualityForm.reset(),this.isQualityFormSubmitted=!1,this.CreateQualityForm())}console.log("AddedQualityList",this.AddedQualityList)}onEditQualityDetail(i,o){console.log("Quaitydetails selected for edit",this.AddedQualityList[o]);let e=this.AddedQualityList[o];this.QualityForm.patchValue({TestingDateTime:e.TestingDateTime,AnalysisDoneByIds:e.AnalysisDoneByIds,SampleReceivedTime:e.SampleReceivedTime,SampleTestedTime:e.SampleTestedTime,SpecificationLimitId:e.SpecificationLimitId,Test1:e.Test1,Test2:e.Test2}),this.EditQualityId=o}removeQualityDetail(i){this.AddedQualityList.splice(i,1),console.log("AddedQualityList",this.AddedQualityList)}getToday(){return(new Date).toISOString().split("T")[0]}createliquidPreparation(i){this.liquidPreparationService.addLiquidPreparation(i).subscribe(()=>{this.cancel(),this.notificationService.success("Liquid Preparation created successfully.")},o=>{this.error=o})}updateliquidPreparation(i){this.liquidPreparationService.updateLiquidPreparation(i).subscribe(()=>{this.cancel(),this.notificationService.success("Liquid Preparation updated successfully.")},o=>{this.error=o})}Submit(){console.log("draftBasicFormValue",this.draftBasicFormValue),console.log("draftStartCheckListFormValue",this.draftStartCheckListFormValue),console.log("AddedInstructionList",this.AddedInstructionList),console.log("draftEndCheckListFormValue",this.draftEndCheckListFormValue),console.log("AddedQualityList",this.AddedQualityList),console.log("DiffWghInstructionList",this.DiffWghInstructionList);let i=this.TransFormData();console.log("Playload",i),this.isEditMode?this.updateliquidPreparation(i):this.createliquidPreparation(i)}formatDateForSQL(i){return i&&i.isValid()?i.format("YYYY-MM-DDTHH:mm:ss"):null}TransFormData(){const i=[...this.draftStartCheckListFormValue.questions.map(e=>({...e,type:1})),...this.draftEndCheckListFormValue.questions.map(e=>({...e,type:2}))];return{Id:this.isEditMode?this.liquidPreparationId:0,Code:this.isEditMode?this.liquidPreparationData.code:"",StartDateTime:this.draftBasicFormValue.StartDateTime,EndDateTime:this.draftBasicFormValue.EndDateTime,SAPProductionOrderId:this.isEditMode?this.liquidPreparationData.sapProductionOrderId:this.draftBasicFormValue.SAPProductionOrderId,ProductId:this.isEditMode?this.liquidPreparationData.ProductId:this.draftBasicFormValue.ProductId,ShiftId:this.draftBasicFormValue.ShiftId,BatchLotNumber:this.draftBasicFormValue.BatchLotNumber.toString(),TankId:this.draftBasicFormValue.TankId,CompounderUserId:this.draftBasicFormValue.CompounderUserId,StandardBatchWeight:this.draftBasicFormValue.StandardBatchWeight.toString(),TestingDateTime:null,AnalysisDoneByIds:"",AnalysisDoneByList:null,SampleReceivedTime:null,SampleTestedTime:null,IsActive:!0,liquidPreparationAdjustmentDetails:this.DiffWghInstructionList.map(e=>({Id:0,LiquidPreparationId:0,MaterialId:e.MaterialId,LiquidPreparationInstructionId:e.InstructionId,Weight:e.WeightAdded,Adjustment:e.diffWeight,Total:e.Weight,IsActive:!0})),liquidPreparationChecklistDetails:i.map(e=>({Id:0,LiquidPreparationId:0,Type:e.type.toString(),QuestionId:e.id,Answer:e.answer,TankNo:e.tankNo||null,IsActive:!0,TankId:e.tankId||null,Reason:e.reason||""})),liquidPreparationInstructionDetails:this.AddedInstructionList.map(e=>({Id:0,LiquidPreparationId:0,InstructionId:e.InstructionId,MaterialId:e.MaterialId,LotNumber:e.LotNumber.toString(),Weight:e.Weight,WeightAdded:e.WeightAdded,DoneByList:e.DoneByIds.map(n=>`${n}`),AddedTime:e.AddedTime,IsActive:!0})),liquidPreparationSpecificationDetails:this.AddedQualityList.map(e=>({Id:0,LiquidPreparationId:0,SpecificationLimitId:e.SpecificationLimitId,Test1:e.Test1||"",Test2:e.Test2||"",TestingDateTime:e.TestingDateTime,AnalysisDoneByList:e.AnalysisDoneByIds.map(n=>`${n}`),SampleReceivedTime:e.SampleReceivedTime,SampleTestedTime:e.SampleTestedTime,IsActive:!0}))}}cancel(){this.router.navigate(this.isEditMode?["../..","list"]:["..","list"],{relativeTo:this.activatedRoute})}ngOnDestroy(){this.routerSub.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||a)(t.rXU(p.nX),t.rXU(p.Ix),t.rXU(d.ze),t.rXU(k),t.rXU(E.tw),t.rXU(V.Q),t.rXU(t.gRc))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-add-edit"]],decls:29,vars:10,consts:[["form","ngForm"],["pickerStartDate",""],["pickerEndDate",""],["pickerTestingDateTime",""],["pickerSampleReceivedTime",""],["pickerSampleTestedTime",""],[1,"row","justify-content-center"],[1,"col-xl-11","col-lg-12"],[1,"border","p30","rounded"],[1,"row","align-items-center","mb-4"],[1,"col-lg-7","col-sm-9","col-xs-10","d-flex","align-items-end"],[1,"mb-0"],[1,"icon-edit"],[1,"col-lg-5","col-sm-3","col-xs-2","d-flex","justify-content-end"],["mat-flat-button","","color","primary","class","app-button",3,"click",4,"authPermission"],[1,"tab-group-container"],[1,"tab-group-bordered",3,"selectedIndexChange","selectedIndex"],["label","Basic"],["matTabContent",""],["label","Start Checklist",3,"disabled"],["label","Instructions",3,"disabled"],["label","End Checklist",3,"disabled"],["label","Quality",3,"disabled"],["label","Adjustment",3,"disabled"],[1,"d-flex","justify-content-end",2,"margin-top","20px"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","primary","class","ms-4",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary","class","ms-4",3,"click",4,"ngIf"],["mat-flat-button","","color","primary",1,"app-button",3,"click"],["novalidate","",1,"app-form",3,"formGroup"],[1,"card","mb-4"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-3","mb-3"],["appearance","fill"],["matInput","","placeholder","Start Date","formControlName","StartDateTime","required","",3,"ngxMatDatetimePicker"],["type","button","mat-icon-button","","matSuffix","",3,"click"],["apperance","fill"],["matInput","","placeholder","End Date","formControlName","EndDateTime","required","",3,"dateChange","ngxMatDatetimePicker"],["appearance","fill",1,"full-width"],["formControlName","SAPProductionOrderId",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"control","message","formSubmitted"],["formControlName","ProductId",3,"disabled"],["formControlName","ShiftId"],["matInput","","formControlName","BatchLotNumber","type","number"],["formControlName","TankId"],["formControlName","CompounderUserId"],["matInput","","formControlName","StandardBatchWeight","type","number"],[3,"value"],["formArrayName","questions"],["class","mb-3",3,"formGroupName",4,"ngFor","ngForOf"],[1,"mb-3",3,"formGroupName"],[1,"col-12","col-sm-12","col-md-5","col-lg-5","mb-3"],[1,"col-12","col-sm-12","col-md-3","col-lg-3","mb-3"],["formControlName","answer",3,"change"],["value","Yes"],["value","No","disabled","true"],["value","NA"],[1,"col-12","col-sm-12","col-md-4","col-lg-4","mb-3"],["appearance","fill","class","full-width",4,"ngIf"],["matInput","","formControlName","reason"],[1,"card-header"],["formControlName","InstructionId",3,"selectionChange"],["formControlName","MaterialId"],["matInput","","formControlName","LotNumber"],["matInput","","formControlName","Weight","type","number"],["matInput","","formControlName","WeightAdded","type","number"],["formControlName","DoneByIds","multiple",""],["matInput","","formControlName","AddedTime",3,"disabled"],[1,"col-12","col-sm-12","col-md-1","col-lg-1","mb-3","p-1","d-flex","align-items-center"],["type","button","mat-icon-button","","color","warn",3,"click"],[1,"col-md-12"],[1,"table-responsive"],["id","gridNozzlewiseWeight",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner",2,"overflow","scroll","width","auto"],[1,"bg-primary","text-primary","text-center"],[2,"width","20%"],[4,"ngFor","ngForOf"],["colspan","3",1,"text-center"],["colspan","3"],["type","button",1,"btn","btn-primary","btn-sm","btnModifyRow",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-danger","btn-sm","btnRemoveRow",3,"click"],[1,"fa","fa-close"],["formControlName","tankId"],["matInput","","placeholder","Date Tested","formControlName","TestingDateTime","required","",3,"ngxMatDatetimePicker"],["formControlName","AnalysisDoneByIds","multiple",""],["matInput","","placeholder","Sample Received At","formControlName","SampleReceivedTime","required","",3,"ngxMatDatetimePicker"],["matInput","","placeholder","Sample Tested At","formControlName","SampleTestedTime","required","",3,"ngxMatDatetimePicker"],["formControlName","SpecificationLimitId"],["matInput","","formControlName","Test1"],["matInput","","formControlName","Test2"],["id","gridQualityList",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner",2,"overflow","scroll","width","auto"],["id","gridAdjustment",1,"table","table-hover","table-bordered","display","mb-30","fixed-table-scroll-inner",2,"overflow","scroll","width","auto"],[1,"full-width"],[2,"width","25%"],["mat-raised-button","","color","primary",1,"ms-4",3,"click","disabled"],["mat-raised-button","","color","primary",1,"ms-4",3,"click"]],template:function(o,e){1&o&&(t.j41(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"h4",11),t.nrm(6,"i",12),t.EFF(7," Add/Edit Liquid Preparation"),t.k0s()(),t.j41(8,"div",13),t.DNE(9,O,2,0,"a",14),t.k0s()(),t.j41(10,"div",15)(11,"mat-tab-group",16),t.mxI("selectedIndexChange",function(r){return t.DH7(e.selectedIndex,r)||(e.selectedIndex=r),r}),t.j41(12,"mat-tab",17),t.DNE(13,K,68,31,"ng-template",18),t.k0s(),t.j41(14,"mat-tab",19),t.DNE(15,it,7,2,"ng-template",18),t.k0s(),t.j41(16,"mat-tab",20),t.DNE(17,st,92,29,"ng-template",18),t.k0s(),t.j41(18,"mat-tab",21),t.DNE(19,mt,7,2,"ng-template",18),t.k0s(),t.j41(20,"mat-tab",22),t.DNE(21,ft,86,13,"ng-template",18),t.k0s(),t.j41(22,"mat-tab",23),t.DNE(23,_t,21,1,"ng-template",18),t.k0s()(),t.j41(24,"div",24)(25,"button",25),t.bIt("click",function(){return e.goToPreviousTab()}),t.EFF(26,"Previous"),t.k0s(),t.DNE(27,It,2,1,"button",26)(28,kt,2,0,"button",27),t.k0s()()()()()),2&o&&(t.R7$(9),t.Y8G("authPermission",e.page+"_"+e.permissions.list),t.R7$(2),t.R50("selectedIndex",e.selectedIndex),t.R7$(3),t.Y8G("disabled",e.isstartChecklistDisable),t.R7$(2),t.Y8G("disabled",e.isInstructionsDisable),t.R7$(2),t.Y8G("disabled",e.isEndChecklistDisable),t.R7$(2),t.Y8G("disabled",e.isQualityDisable),t.R7$(2),t.Y8G("disabled",e.isAdjustmentDisable),t.R7$(3),t.Y8G("disabled",0===e.selectedIndex),t.R7$(2),t.Y8G("ngIf",5!=e.selectedIndex),t.R7$(),t.Y8G("ngIf",5===e.selectedIndex))},dependencies:[h.Sq,h.bT,d.qT,d.me,d.Q0,d.BC,d.cb,d.YS,d.j4,d.JD,d.$R,d.v8,g.It,g.$z,g.iY,_.rl,_.nJ,_.yw,C.fg,S.An,Q.VO,P.wT,j.VT,j._g,I.$L,I.mq,I.T8,D.B,W.r,f.m7,f.yF,h.vh],styles:["mat-tab-group[_ngcontent-%COMP%]{margin:20px}.tab-group-bordered[_ngcontent-%COMP%]{border:2px solid var(--bs-border-color)!important;border-radius:8px;padding:10px;margin-bottom:20px}.card[_ngcontent-%COMP%]{margin-bottom:1.5rem;box-shadow:0 1px 3px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:.75rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.full-width[_ngcontent-%COMP%]{width:100%}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem}.readonly-input[_ngcontent-%COMP%]{color:#000;background-color:#f5f5f5;cursor:not-allowed;border:1px solid #dcdcdc}  .mat-calendar{background-color:#d3d3d3}  .time-container{background-color:#d3d3d3}"]})}return a})();const bt=[{path:"",component:v,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:y,canActivate:[m.LL],data:{page:m.Wt.liquidPreparation,title:"LiquidPreparation"}},{path:"add",canActivate:[m.LL],data:{page:m.Wt.liquidPreparation,title:"LiquidPreparation"},component:F},{path:"edit/:id",canActivate:[m.LL],data:{page:m.Wt.liquidPreparation,title:"LiquidPreparation"},component:F}]}];let Ft=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#i=this.\u0275mod=t.$C({type:a});static#e=this.\u0275inj=t.G2t({imports:[p.iI.forChild(bt),p.iI]})}return a})();var Lt=l(71774),vt=l(42356),Et=l(99830),St=l(40),Dt=l(75263);let Tt=(()=>{class a{static#t=this.\u0275fac=function(o){return new(o||a)};static#i=this.\u0275mod=t.$C({type:a});static#e=this.\u0275inj=t.G2t({providers:[k,(0,Et._c)()],imports:[h.MD,Ft,Lt.Gg,vt.c9,I.RI,f.Hw,f.Xg,f.T_,P.WX,Dt.ZG,St.Yr,_.RG,C.fS]})}return a})()}}]);